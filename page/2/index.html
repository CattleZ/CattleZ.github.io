<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>Gorge</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Gorge">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Gorge">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Gorge">
  
    <link rel="alternative" href="/atom.xml" title="Gorge" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
      <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
<script>AV.initialize("your app_id", "your app_key");</script>
<script src="/js/Counter.js"></script>
  
</head></html>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="../../photo/head.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">He Zhang</a></h1>
		</hgroup>

		
		<p class="header-subtitle">æ¬¢è¿å‘€</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>èœå•</li>
						<li>æ ‡ç­¾</li>
						
						<li>å‹æƒ…é“¾æ¥</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
				        
							<li><a href="https://me.csdn.net/qq_39536716">CSDN</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="zhihu" target="_blank" href="/1660047480" title="zhihu">zhihu</a>
					        
								<a class="mail" target="_blank" href="/1660047480@qq.com" title="mail">mail</a>
					        
								<a class="qq" target="_blank" href="/1660047480@qq.com" title="qq">qq</a>
					        
								<a class="weibo" target="_blank" href="/1660047480@qq.com" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">He Zhang</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="../../photo/head.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">He Zhang</h1>
			</hgroup>
			
			<p class="header-subtitle">æ¬¢è¿å‘€</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives">æ‰€æœ‰æ–‡ç« </a></li>
		        
					<li><a href="https://me.csdn.net/qq_39536716">CSDN</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="zhihu" target="_blank" href="/1660047480" title="zhihu">zhihu</a>
			        
						<a class="mail" target="_blank" href="/1660047480@qq.com" title="mail">mail</a>
			        
						<a class="qq" target="_blank" href="/1660047480@qq.com" title="qq">qq</a>
			        
						<a class="weibo" target="_blank" href="/1660047480@qq.com" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-emmm-sparkå•†ä¸šæ•°æ®åˆ†ææ¡ˆä¾‹è®²è§£" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/24/emmm-sparkå•†ä¸šæ•°æ®åˆ†ææ¡ˆä¾‹è®²è§£/" class="article-date">
  	<time datetime="2020-10-24T03:29:10.250Z" itemprop="datePublished">2020-10-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/24/emmm-sparkå•†ä¸šæ•°æ®åˆ†ææ¡ˆä¾‹è®²è§£/">
        emmm-sparkå•†ä¸šæ•°æ®åˆ†ææ¡ˆä¾‹è®²è§£
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="è®°å½•"><a href="#è®°å½•" class="headerlink" title="è®°å½•"></a>è®°å½•</h2><p>è¿™ç¯‡è®°å½•ä¸ºå•¥ä»¥emmmå¼€å¤´å‘¢ï¼Ÿå“ˆå“ˆï¼ˆï½ï½ï¼‰ï½å› ä¸ºæˆ‘çš„é˜¿é‡Œäº‘è¿˜æœ‰ä¸€ä¸ªæœˆå°±è¦åˆ°æœŸäº†ã€‚è¿™æ„å‘³ç€åˆæ˜¯ä¸€æ³¢æ”¾è¡€ï½ï½ä¸è¿‡å¯¹äºä¸€ä¸ªå¿ å®çš„é˜¿é‡Œç²‰æ¥è¯´ï¼Œè¿˜æ˜¯ç”¨äº†è‡ªå·±ä¸€ä¸ªæœˆçš„ç”Ÿæ´»è´¹ï¼Œåˆç»­ç§Ÿäº†ä¸€å¹´ã€‚ï¼ˆè¿™ä¸œè¥¿æœ‰ç‚¹ä¸Šç˜¾ï¼Œç”¨ä¸Šäº†å°±ä¸æƒ³æ”¾å¼ƒäº†ï½ï½å“ˆå“ˆï¼Œè¿™æ˜¯çœŸå¥½ç”¨ï¼Œæ‰€ä»¥ä¸èƒ½å¯¹ä¸èµ·è¿™ä¸€ä¸ªæœˆçš„ç”Ÿæ´»è´¹ä¸æ˜¯ï¼å½“ç„¶ï¼Œå¦‚æœä»¥åçœŸçš„æœ‰æœºä¼šè¿›äº†é˜¿é‡Œï¼Œé˜¿é‡Œçˆ¸çˆ¸ä¼šä¸ä¼šç»™æˆ‘å…è´¹æœåŠ¡çš„æœºä¼šå‘€ï¼ğŸ˜‚ï¼‰</p>
<h2 id="Jupyter-notebook-é˜¿é‡Œäº‘æ­å»º"><a href="#Jupyter-notebook-é˜¿é‡Œäº‘æ­å»º" class="headerlink" title="Jupyter notebook é˜¿é‡Œäº‘æ­å»º"></a>Jupyter notebook é˜¿é‡Œäº‘æ­å»º</h2><p>åˆšè¯´å®Œï¼Œè¦å……åˆ†åˆ©ç”¨ï¼Œé‚£å°±èµ¶å¿«åˆ©ç”¨èµ·æ¥å§ï¼ æœ¬æ¥æ˜¯æ­å»ºåœ¨æˆ‘MACä¸Šçš„ï¼Œç°åœ¨å°±æŠŠå®ƒè¿ç§»åˆ°é˜¿é‡Œäº‘ä¸Šå§ï¼ä¹Ÿèƒ½è®©æˆ‘éšæ—¶éšåœ°çš„è¿›è¡Œç¼–ç¨‹äº†ï½ï½</p>
<p>åç§° Jupyter æ˜¯ç”±Juliaã€Pythonå’ŒRä¸‰ä¸ªå•è¯ç»„åˆè€Œæˆçš„ã€‚Jupyter Notebookæ˜¯ä¸€ç§Webåº”ç”¨ï¼Œå®ƒèƒ½è®©ç”¨æˆ·å°†è¯´æ˜æ–‡æœ¬ã€æ•°å­¦æ–¹ç¨‹ã€ä»£ç å’Œå¯è§†åŒ–å†…å®¹å…¨éƒ¨ç»„åˆåˆ°ä¸€ä¸ªæ˜“äºå…±äº«çš„æ–‡æ¡£ä¸­ï¼Œéå¸¸æ–¹ä¾¿ç ”ç©¶å’Œæ•™å­¦ã€‚Jupyter Notebookç‰¹åˆ«é€‚åˆåšæ•°æ®å¤„ç†ï¼Œå…¶ç”¨é€”å¯ä»¥åŒ…æ‹¬æ•°æ®æ¸…ç†å’Œæ¢ç´¢ã€å¯è§†åŒ–ã€æœºå™¨å­¦ä¹ å’Œå¤§æ•°æ®åˆ†æã€‚</p>
<h2 id="æœåŠ¡åŸç†"><a href="#æœåŠ¡åŸç†" class="headerlink" title="æœåŠ¡åŸç†"></a>æœåŠ¡åŸç†</h2><p><img src="https://img-blog.csdnimg.cn/20201021112803503.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="Anaconda"><a href="#Anaconda" class="headerlink" title="Anaconda"></a>Anaconda</h2><p>Anacondaæ˜¯ä¸€ä¸ªå¼€æºçš„Pythonå‘è¡Œç‰ˆæœ¬ï¼Œå…¶åŒ…å«äº†condaã€Pythonç­‰180å¤šä¸ªç§‘å­¦åŒ…åŠå…¶ä¾èµ–é¡¹ã€‚Anacondaä¸­å·²ç»é›†æˆäº†Jupyter Notebookï¼Œå› æ­¤ï¼Œå¯ä»¥é¦–å…ˆå®‰è£…Anacondaï¼Œç„¶åå†é…ç½®Jupyter Notebookã€‚</p>
<p>Anacondaçš„å®‰è£…è¿‡ç¨‹ï¼Œè¿™é‡Œå°±ä¸åœ¨è®°å½•äº†ï¼</p>
<p>å®‰è£…å¥½Anacondaä¹‹åï¼Œæ£€æŸ¥é‡Œé¢æ˜¯å¦å·²ç»é›†æˆäº†jupyter Notebookã€‚ä¸€èˆ¬è¿™é‡Œé¢éƒ½æ˜¯é›†æˆäº†çš„ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£å°±åœ¨å®‰è£…ä¸€ä¸‹å§ï¼<br>å› ä¸ºæˆ‘æ­å»ºåœ¨äº†äº‘ä¸Šï¼Œè¿™é‡Œçš„å®‰å…¨æ€§è¿˜æ˜¯è¦ä¿æŠ¤ä¸€ä¸‹çš„ã€‚å› ä¸ºæˆ‘çš„ç›®çš„æ˜¯éšæ—¶éšåœ°ï¼Œéšæœºéƒ½å¯ä»¥è¿›è¡Œç¼–ç¨‹ï¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/hadoop/anaconda3/bin</span><br><span class="line">./python</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ¥ç”Ÿæˆä¸€ä¸‹å¯†ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="keyword">from</span> notebook.auth <span class="keyword">import</span> passwd</span><br><span class="line">&gt;&gt;&gt;passwd()</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªå¯†ç å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚sha1ï¼›è®°å¾—å°†è¿™ä¸ªå¯†ç ä¸²ä¿å­˜ä¸‹æ¥ï¼Œç”¨æ¥é…ç½®ä½ çš„å¯†ç ã€‚</p>
<p>é€€å‡ºpythonä¹‹åï¼Œæ‰¾åˆ°é…ç½®æ–‡ä»¶ã€‚<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.jupyter/jupyter_notebook_config.py</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c.NotebookApp.ip=<span class="string">'*'</span>                     <span class="comment"># å°±æ˜¯è®¾ç½®æ‰€æœ‰ipçš†å¯è®¿é—®  </span></span><br><span class="line">c.NotebookApp.password = <span class="string">'sha1:7c7990750e83:965c1466a4fab0849051ca5f3c5661110813795b'</span>     <span class="comment"># ä¸Šé¢å¤åˆ¶çš„é‚£ä¸ªshaå¯†æ–‡'  </span></span><br><span class="line">c.NotebookApp.open_browser = False       <span class="comment"># ç¦æ­¢è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨  </span></span><br><span class="line">c.NotebookApp.port =8888                 <span class="comment"># ç«¯å£</span></span><br><span class="line">c.NotebookApp.notebook_dir = <span class="string">'/home/hadoop/jupyternotebook'</span>  <span class="comment">#è®¾ç½®Notebookå¯åŠ¨è¿›å…¥çš„ç›®å½•</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®å®Œæˆä¹‹åï¼Œä½¿ç”¨jupyter notebookå¯åŠ¨å³å¯ï¼è¿™æ—¶å€™åœ¨æœ¬æœºè®¿é—®æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå¦‚æœæƒ³è¦é€šè¿‡å…¶ä»–ç”µè„‘è®¿é—®è¿˜éœ€è¦è¿›è¡Œä¸‹ä¸€æ­¥çš„ç­–ç•¥ï¼</p>
<h2 id="æ•™è®­"><a href="#æ•™è®­" class="headerlink" title="æ•™è®­"></a>æ•™è®­</h2><p>è¿˜è®°å¾—HDFSå®éªŒä¸­ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³å—ï¼Ÿå“ˆå“ˆå“ˆ å…¶å®æœ‰ç‚¹å‚»äº†ã€‚<br>åœ¨é…ç½®notebookçš„æ—¶å€™ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯8888ç«¯å£ï¼Œé˜¿é‡Œäº‘æ˜¯å¯¹è¿™äº›ç«¯å£è¿›è¡Œä¿æŠ¤äº†çš„ã€‚ä¸»è¦æœ‰ä¸¤å±‚ä¿æŠ¤ï¼šç¬¬ä¸€å±‚æ˜¯é˜¿é‡Œäº‘æœ¬èº«çš„é˜²ç«å¢™ï¼Œç¬¬äºŒå±‚æ˜¯æ§åˆ¶å°çš„å®‰å…¨ç»„è§„åˆ™ã€‚è¿™ä¸ªç»éªŒæœ¬æ¥æ˜¯åœ¨mysqlçš„é…ç½®çš„æ—¶å€™è§£å†³è¿‡çš„ï¼ä½†æ˜¯å¿˜è®°äº†ã€‚æ‰€ä»¥åœ¨æ‰§è¡ŒHDFSåˆ†å¸ƒå¼æ–‡ä»¶è¯»å–çš„æ—¶å€™ï¼Œä¸€ç›´æ²¡æœ‰æˆåŠŸï¼ä½†æ˜¯è¿™é‡Œé…ç½®çš„æ—¶å€™ï¼Œå¿½ç„¶æƒ³èµ·äº†è¿™ä¸ªäº‹æƒ…ï¼Œæ‰€ä»¥å°±æŠŠè¿™ä¸ªé—®é¢˜è§£å†³äº†ã€‚HDFS ä½¿ç”¨æœ¬æœºç”¨æˆ·åˆ†å¸ƒå¼è¯»å–ä¹Ÿæ²¡é—®é¢˜äº†ã€‚ä½†æ˜¯å†™æƒé™è¿˜æ˜¯ä¸å¤Ÿçš„ã€‚</p>
<h2 id="æ¡ˆä¾‹è®²è§£"><a href="#æ¡ˆä¾‹è®²è§£" class="headerlink" title="æ¡ˆä¾‹è®²è§£"></a>æ¡ˆä¾‹è®²è§£</h2><p>æ•°æ®æ¥æºï¼š<a href="https://www.kaggle.com/yelp-dataset/yelp-dataset" target="_blank" rel="noopener">YELPæ•°æ®é›†</a><strong>ä»…ç”¨æ¥å­¦ä¹ </strong> </p>
<h3 id="json-æ•°æ®é›†"><a href="#json-æ•°æ®é›†" class="headerlink" title="json æ•°æ®é›†"></a>json æ•°æ®é›†</h3><p>è¿™é‡Œçš„æ•°æ®é›†æ ¼å¼æ˜¯å±äºNoSQLçš„ä¸­çš„æ–‡æ¡£æ•°æ®é›†æ ¼å¼ä¹‹ä¸€çš„jsonæ•°æ®é›†æ ¼å¼ã€‚<br>å› ä¸ºï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡å¯¹è¿™ç±»æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œåšä¸€ä¸ªç®€å•çš„å­¦ä¹ è®°å½•ã€‚</p>
<ol>
<li><p>ç®€ä»‹<br>JSON:ä¸€ç§ä¸å¼€å‘è¯­è¨€æ— å…³çš„ã€è½»é‡çº§çš„æ•°æ®å­˜å‚¨æ ¼å¼ï¼Œå…¨ç§°JavaScript Object Notationï¼Œä¸€ç§æ•°æ®æ ¼å¼çš„æ ‡å‡†è§„èŒƒï¼Œèµ·åˆæ¥æºäºJavaScriptè¿™é—¨è¯­è¨€ï¼Œåæ¥éšç€ä½¿ç”¨çš„å¹¿æ³›ï¼Œå‡ ä¹æ¯é—¨å¼€å‘è¯­è¨€éƒ½æœ‰å¤„ç†JSONçš„APIã€‚<br><strong>ä¼˜ç‚¹ï¼šæ˜“äºäººçš„é˜…è¯»å’Œç¼–å†™ï¼Œæ˜“äºç¨‹åºè§£æä¸ç”Ÿäº§ã€‚</strong>ï¼ˆçœ‹äº†ä¸€ä¸‹çœŸçš„æ˜¯ä¾¿äºé˜…è¯»ä¸å¤„ç†ï¼‰</p>
<p>JSONæ ·ä¾‹ï¼šé¦–å…ˆä¸€ä¸ªèŠ±æ‹¬å·{}ï¼Œæ•´ä¸ªä»£è¡¨ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶é‡Œé¢æ˜¯ä¸€ç§Key-Valueçš„å­˜å‚¨å½¢å¼ï¼Œå®ƒè¿˜æœ‰ä¸åŒçš„æ•°æ®ç±»å‹æ¥åŒºåˆ†ã€‚</p>
</li>
<li><p>æ•°æ®ç±»å‹è¡¨ç¤º<br>æ•°æ®ç»“æ„ï¼šObjectã€Array<br>åŸºæœ¬ç±»å‹ï¼šstringï¼Œnumberï¼Œtrueï¼Œfalseï¼Œnull<br>ï¼ˆ1ï¼‰Object<br>{key:value,key:valueâ€¦}<br>keyï¼šstringç±»å‹<br>valueï¼šä»»ä½•åŸºæœ¬ç±»å‹æˆ–æ•°æ®ç»“æ„<br>ï¼ˆ2ï¼‰Array<br>[value,valueâ€¦]<br>valueï¼šä»»ä½•åŸºæœ¬ç±»å‹æˆ–æ•°æ®ç»“æ„ã€‚<br>æ¯”å¦‚ï¼š{â€œnameâ€:â€æå¹¿â€, â€œvaluesâ€:[1,2,45,â€ä½ å¥½â€] }</p>
</li>
<li><p>å®é™…jsonæ•°æ®æ ¼å¼<br>è¿™ä¸ªæ ¼å¼çš„æ–‡ä»¶å¯ä»¥é€šè¿‡t x tæˆ–è€…ç½‘é¡µç­‰æ–¹å¼æ‰“å¼€ï¼Œå½“ç„¶è¿˜æœ‰è®¸å¤šå·¥å…·ã€‚<br>æˆ‘è¿™é‡Œç”¨çš„æ˜¯Xcodeã€‚å¥½äº†è¿™å°±æ˜¯æˆ‘ä»¬è¦å¤„ç†çš„æ•°æ®äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/20201021204557992.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
</li>
<li><p>æ•°æ®é›†æå‰åˆ†æ<br>æˆ‘è¿™é‡Œå–å‡ºæ¥ä¸€æ¡ä¿¡æ¯ï¼Œå…ˆæ¥çœ‹çœ‹ä¿¡æ¯æ˜¯å•¥æ ·å­çš„ã€‚</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"business_id"</span>:<span class="string">"f9NumwFMBDn751xgFiRbNA"</span>,</span><br><span class="line">        <span class="string">"name"</span>:<span class="string">"The Range At Lake Norman"</span>,</span><br><span class="line">  <span class="string">"address"</span>:<span class="string">"10913 Bailey Rd"</span>,</span><br><span class="line"> <span class="string">"city"</span>:<span class="string">"Cornelius"</span>,</span><br><span class="line"> <span class="string">"state"</span>:<span class="string">"NC"</span>,</span><br><span class="line"> <span class="string">"postal_code"</span>:<span class="string">"28031"</span>,</span><br><span class="line"> <span class="string">"latitude"</span>:35.4627242,</span><br><span class="line"> <span class="string">"longitude"</span>:-80.8526119,</span><br><span class="line"> <span class="string">"stars"</span>:3.5,</span><br><span class="line"> <span class="string">"review_count"</span>:36,</span><br><span class="line"> <span class="string">"is_open"</span>:1,</span><br><span class="line"> <span class="string">"attributes"</span>:&#123;<span class="string">"BusinessAcceptsCreditCards"</span>:<span class="string">"True"</span>,<span class="string">"BikeParking"</span>:<span class="string">"True"</span>,<span class="string">"GoodForKids"</span>:<span class="string">"False"</span>,<span class="string">"BusinessParking"</span>:<span class="string">"&#123;'garage': False, 'street': False, 'validated': False, 'lot': True, 'valet': False&#125;"</span>,<span class="string">"ByAppointmentOnly"</span>:<span class="string">"False"</span>,<span class="string">"RestaurantsPriceRange2"</span>:<span class="string">"3"</span>&#125;,</span><br><span class="line"> <span class="string">"categories"</span>:<span class="string">"Active Life, Gun\/Rifle Ranges, Guns &amp; Ammo, Shopping"</span>,</span><br><span class="line"> <span class="string">"hours"</span>:&#123;<span class="string">"Monday"</span>:<span class="string">"10:0-18:0"</span>,</span><br><span class="line"> <span class="string">"Tuesday"</span>:<span class="string">"11:0-20:0"</span>,</span><br><span class="line"> <span class="string">"Wednesday"</span>:<span class="string">"10:0-18:0"</span>,</span><br><span class="line"> <span class="string">"Thursday"</span>:<span class="string">"11:0-20:0"</span>,</span><br><span class="line"> <span class="string">"Friday"</span>:<span class="string">"11:0-20:0"</span>,</span><br><span class="line"> <span class="string">"Saturday"</span>:<span class="string">"11:0-20:0"</span>,</span><br><span class="line"> <span class="string">"Sunday"</span>:<span class="string">"13:0-18:0"</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æè¿°çš„å°±æ˜¯è¿™ä¸ªæ–‡æ¡£ä¸­æ‰€æœ‰æ•°æ®é›†ä¸­å…¶ä¸­çš„ä¸€æ¡æ•°æ®ã€‚<br>å¯ä»¥å‘ç°jsonæ•°æ®æ ¼å¼æ˜¯æŒ‰ç…§é”®å€¼å¯¹çš„å½¢å¼è¿›è¡Œå­˜å‚¨çš„ã€‚</p>
<ul>
<li>business_id ï¼š å•†ä¸šåº—é“ºçš„id,ç”¨æ¥å”¯ä¸€çš„æ ‡è¯†è¿™ä¸€ä¸ªå•†é“º</li>
<li>name : å•†ä¸šåº—é“ºçš„åç§°</li>
<li>address : å•†é“ºçš„ä½ç½®</li>
<li>city : åŸé•‡</li>
<li>state : å·å¿</li>
<li>postal_code : é‚®æ”¿ç¼–ç </li>
<li>latitude :çº¬åº¦</li>
<li>longitude :ç»åº¦</li>
<li>starts : æ˜Ÿçº§è¯„åˆ†</li>
<li>review_countï¼šè¯„è®ºæ•°</li>
<li>is_openï¼š å•†å®¶æ˜¯å¦è¥ä¸š</li>
<li>attributes ï¼šå•†å®¶æ‰€è¿›è¡Œçš„ä¸šåŠ¡</li>
<li>categories: ç±»åˆ«</li>
<li>hours : å•†å®¶çš„è¥ä¸šæ—¶é—´</li>
</ul>
<h3 id="ä¸»è¦ä»»åŠ¡"><a href="#ä¸»è¦ä»»åŠ¡" class="headerlink" title="ä¸»è¦ä»»åŠ¡"></a>ä¸»è¦ä»»åŠ¡</h3><ol>
<li>ç»Ÿè®¡å‡ºæ‰€æœ‰çš„å•†ä¸šç±»åˆ«ï¼Œå¹¶ä¸”è¿›è¡Œè®¡ç®—å‡ºå•†ä¸šç±»åˆ«çš„Top 10(categories)ã€‚</li>
<li>æ¯ä¸ªåŸå¸‚å„ç§å•†ä¸šç±»å‹çš„å•†å®¶æ•°é‡,å¹¶ä¸”è®¡ç®—å‡ºå•†å®¶æ•°é‡æœ€å¤šçš„åä¸ªåŸå¸‚(city,categories)ã€‚</li>
<li>æ¶ˆè´¹è€…è¯„ä»·æœ€å¤šçš„10ç§å•†ä¸šç±»åˆ«(review_count,categories)ã€‚</li>
<li>æœ€å—æ¶ˆè´¹è€…æ¬¢è¿çš„10ç§å•†ä¸šç±»åˆ«(starts)ã€‚</li>
<li>å•†ä¸šé¢å¤–ä¸šåŠ¡çš„è¯„ä»·æƒ…å†µã€‚</li>
</ol>
<h3 id="ä¸»è¦çš„è§£å†³æ­¥éª¤"><a href="#ä¸»è¦çš„è§£å†³æ­¥éª¤" class="headerlink" title="ä¸»è¦çš„è§£å†³æ­¥éª¤"></a>ä¸»è¦çš„è§£å†³æ­¥éª¤</h3><ol>
<li>ç¬¬ä¸€æ­¥ å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œå‰”é™¤å¼‚å¸¸å€¼</li>
<li>ç¬¬äºŒæ­¥ è¿›è¡Œæ•°æ®é›†çš„åˆ†æ</li>
<li>ç¬¬ä¸‰æ­¥ å¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–åˆ†æ</li>
</ol>
<h2 id="ä»£ç è§£è¯»"><a href="#ä»£ç è§£è¯»" class="headerlink" title="ä»£ç è§£è¯»"></a>ä»£ç è§£è¯»</h2><h3 id="æ‰€éœ€è¦çš„åŒ…"><a href="#æ‰€éœ€è¦çš„åŒ…" class="headerlink" title="æ‰€éœ€è¦çš„åŒ…"></a>æ‰€éœ€è¦çš„åŒ…</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyspark <span class="keyword">import</span> SparkConf,SparkContext</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"><span class="keyword">import</span> pyspark.sql.functions <span class="keyword">as</span> f</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<ul>
<li><p>pyspark<br>PySpark æ˜¯ Spark ä¸º Python å¼€å‘è€…æä¾›çš„ API</p>
<ul>
<li>SparkContext<br>æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ï¼Œè´Ÿè´£è¿æ¥Sparké›†ç¾¤ã€‚é›†ç¾¤é€šè¿‡SparkContextè¿›è¡Œèµ„æºç®¡ç†å™¨çš„é€šä¿¡ä»¥åŠè¿›è¡Œèµ„æºçš„ç”³è¯·ã€ä»»åŠ¡çš„åˆ†é…å’Œç›‘æ§ï¼Œéœ€è¦ä»SparkSessionä¸­è·å¾—</li>
<li>SparkConf<br>åˆ›å»ºSparkContextå‰å¾—ä½¿ç”¨SparkConfè¿›è¡Œé…ç½®ï¼Œä»¥é”®å€¼å¯¹å½¢å¼è¿›è¡Œ</li>
</ul>
</li>
<li><p>pyspark.sql<br>ä¸€ç§è§£æä¼ ç»ŸSQLåˆ°å¤§æ•°æ®è¿ç®—æ¨¡å‹çš„å¼•æ“</p>
<ul>
<li>SparkSession<br>å…¶ä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„åˆ‡å…¥ç‚¹æ¥ä½¿ç”¨Sparkçš„å„é¡¹åŠŸèƒ½ï¼Œå¹¶ä¸”å…è®¸ç”¨æˆ·é€šè¿‡å®ƒè°ƒç”¨DataFrameå’ŒDatasetç›¸å…³APIæ¥ç¼–å†™Sparkç¨‹åº</li>
<li>DataFrameï¼ˆè¡¨ï¼‰æ˜¯Spark SQLå¯¹ç»“æ„åŒ–æ•°æ®çš„æŠ½è±¡ã€‚å¯ä»¥å°†DataFrameçœ‹åšRDD</li>
<li>Datasetæ˜¯æ•°æ®çš„åˆ†å¸ƒå¼é›†åˆ</li>
</ul>
</li>
<li>pyspark.sql.function<br>å¯ç”¨äºdataFramçš„å†…ç½®åŠŸèƒ½åˆ—è¡¨</li>
<li>os<br>ä¸»è¦æ˜¯é’ˆå¯¹æ“ä½œç³»ç»Ÿçš„åŒ…ï¼Œç”¨æ¥ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ï¼Œåˆ›å»ºæ–‡ä»¶ç­‰ã€‚</li>
<li>json<br>Pythoné‡Œçš„jsonæ¨¡å—ä¸»è¦ç”¨äºâ€œPythonæ•°æ®ä¸JSONæ ¼å¼çš„æ•°æ®é—´ç›¸äº’è½¬æ¢â€</li>
<li>pandas<br>pandasæ˜¯ä¸€ä¸ªå¼ºå¤§çš„åˆ†æç»“æ„åŒ–æ•°æ®çš„å·¥å…·é›†ï¼›å®ƒçš„ä½¿ç”¨åŸºç¡€æ˜¯Numpyï¼ˆæä¾›é«˜æ€§èƒ½çš„çŸ©é˜µè¿ç®—ï¼‰ï¼›ç”¨äºæ•°æ®æŒ–æ˜å’Œæ•°æ®åˆ†æï¼ŒåŒæ—¶ä¹Ÿæä¾›æ•°æ®æ¸…æ´—åŠŸèƒ½ã€‚</li>
<li>matplotlib.pyplot<br>æ˜¯matlibçš„pythonç‰ˆå®ç°ï¼Œç”¨äºç»˜å›¾æ“ä½œã€‚</li>
</ul>
<h3 id="è·å–sparkæ“ä½œå¯¹è±¡"><a href="#è·å–sparkæ“ä½œå¯¹è±¡" class="headerlink" title="è·å–sparkæ“ä½œå¯¹è±¡"></a>è·å–sparkæ“ä½œå¯¹è±¡</h3><p>å»ºç«‹ä¸€ä¸ªä¼šè¯å¯¹è±¡<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å»ºç«‹é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#builderç”¨æ¥åˆ›å»ºä¸€ä¸ªSparksessionå®ä¾‹</span></span><br><span class="line"><span class="comment">#config é…ç½®ç›¸å…³</span></span><br><span class="line"><span class="comment">#getOrCreate æœ‰å°±è·å–æ²¡æœ‰å°±åˆ›å»º</span></span><br><span class="line">spark = SparkSession.builder.config(conf=SparkConf()).getOrCreate()</span><br></pre></td></tr></table></figure></p>
<h3 id="æ•°æ®æ¸…æ´—"><a href="#æ•°æ®æ¸…æ´—" class="headerlink" title="æ•°æ®æ¸…æ´—"></a>æ•°æ®æ¸…æ´—</h3><p>ä¸‹é¢å¯¹æ•°æ®æ¸…æ´— è¿›è¡Œä¸€ä¸ªè¯¦ç»†çš„åˆ†æã€‚ä¸»è¦å°†æ•°æ®ä¸­å­˜åœ¨å€¼ç¼ºå¤±çš„æ•°æ®ï¼Œå•†å®¶ä½ç½®é”™è¯¯çš„æ•°æ®ï¼ˆè¿™é‡Œå¯ä»¥ç§°ä¸ºç¦»ç¾¤å€¼ï¼‰è¿›è¡Œç­›é€‰ã€‚ä»£ç çš„è¯¦è§£è§£è¯»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®æ¸…æ´—</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_process</span><span class="params">(raw_data_path)</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é€šè¿‡æ•°æ®è·¯å¾„ï¼Œè¯»å–æ•°æ®ï¼Œè¿™é‡Œæ˜¯jsonæ•°æ®</span></span><br><span class="line">    business = spark.read.json(raw_data_path)</span><br><span class="line">    <span class="comment">#split(str, pattern, limit=-1)</span></span><br><span class="line">    <span class="comment">#str â€“ æˆ‘ä»¬è¦åˆ†å‰²çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">#pattern åˆ†å‰²æ‰€ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">    split_col = f.split(business[<span class="string">'categories'</span>], <span class="string">','</span>)</span><br><span class="line">    <span class="comment">#withColumn(colName, col)</span></span><br><span class="line">    <span class="comment">#withColumn è´Ÿè´£åœ¨åŸæœ‰è¡¨çš„åŸºç¡€ä¸Šæ–°æ·»åŠ ä¸€åˆ— colNameæ˜¯æ·»åŠ ä¸€åˆ—åçš„æ–°çš„åˆ—åï¼Œcolæ˜¯æ–°åˆ—çš„å€¼ ï¼Ÿåˆ—åä¸€æ ·ä¼šæ€ä¹ˆæ ·å¤„ç†ï¼ˆè¿™é‡Œåº”è¯¥æ˜¯ä¼šç›´æ¥æ›¿ä»£åŸæ¥çš„ï¼Œæœ‰å¾…éªŒè¯ï¼‰</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#filter ä½¿ç”¨ç»™å®šçš„æ¡ä»¶ è¿‡æ»¤è¡Œ è¿™é‡Œæ˜¯åœ¨æ‰€æœ‰çš„categoriesä¸­è¿‡æ»¤æ‰åŸå¸‚</span></span><br><span class="line">    <span class="comment"># dropna è‡³å°‘åˆä¸€ä¸ªç©ºç¼ºå€¼çš„è¡Œéƒ½ä¼šè¢«åˆ é™¤</span></span><br><span class="line">    business = business.withColumn(<span class="string">"categories"</span>, split_col).filter(business[<span class="string">"city"</span>] != <span class="string">""</span>).dropna()</span><br><span class="line">    <span class="comment">#åˆ›å»ºä¸€ä¸ªæ•°æ®çš„ä¸´æ—¶è§†å›¾ï¼Œè¿™ä¸ªè§†å›¾çš„å‘¨æœŸä¸sparkSessionç›¸å…³è”</span></span><br><span class="line">    business.createOrReplaceTempView(<span class="string">"business"</span>)</span><br><span class="line">    <span class="comment">#è§£æä¼ ç»Ÿçš„sqlåˆ°å¤§æ•°æ®è¿ç®—æ¨¡å‹ ç­›é€‰å‡ºæ‰€éœ€è¦çš„å†…å®¹</span></span><br><span class="line">    <span class="comment">#cache æŒ‰ç…§é»˜è®¤çš„å­˜å‚¨çº§åˆ« æŒä¹…åŒ–dataFrame</span></span><br><span class="line">    b_etl = spark.sql(<span class="string">"SELECT business_id, name, city, state, latitude, longitude, stars, review_count, is_open, categories, attributes FROM business"</span>).cache()</span><br><span class="line">    <span class="comment">#å°†ç­›é€‰å®Œçš„æ•°æ® åœ¨è¿›è¡Œä¸€ä¸ªä¸´æ—¶è§†å›¾ æ–¹ä¾¿ä¸‹ä¸€æ­¥çš„sqlåˆ†æ</span></span><br><span class="line">    b_etl.createOrReplaceTempView(<span class="string">"b_etl"</span>)</span><br><span class="line">    <span class="comment">#è¿™é‡Œæ˜¯ç­›é€‰æ‰ ç¦»ç¾¤å€¼ ï¼ˆè·ç¦»æ´²å†…å•†å®¶å¹³å‡ä½ç½®çš„æ¬§å¼è·ç¦»ï¼‰</span></span><br><span class="line">    <span class="comment">#b1 ä½œä¸ºbusinessçš„åŸå§‹æ•°æ®è¡¨ b2æ˜¯åœ¨åŸå§‹æ•°æ®è¡¨çš„åŸºç¡€ä¸Šè®¡ç®—æ¯ä¸ªå·å¿çš„å¹³å‡ ç»çº¬åº¦ ç„¶åè®¡ç®—æ¯ä¸€ä¸ªå•†å®¶åœ¨è¿™ä¸ªå·å¿çš„æ¬§å¼è·ç¦» å¹¶æ ¹æ®è®¡ç®—ç»“æœé™åºæ’åˆ—</span></span><br><span class="line">    outlier = spark.sql(</span><br><span class="line">        <span class="string">"SELECT b1.business_id, SQRT(POWER(b1.latitude - b2.avg_lat, 2) + POWER(b1.longitude - b2.avg_long, 2)) \</span></span><br><span class="line"><span class="string">        as dist FROM b_etl b1 INNER JOIN (SELECT state, AVG(latitude) as avg_lat, AVG(longitude) as avg_long \</span></span><br><span class="line"><span class="string">        FROM b_etl GROUP BY state) b2 ON b1.state = b2.state ORDER BY dist DESC"</span>)</span><br><span class="line">    <span class="comment">#åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸´æ—¶è§†å›¾ outlier</span></span><br><span class="line">    outlier.createOrReplaceTempView(<span class="string">"outlier"</span>)</span><br><span class="line">    <span class="comment">#ä»b_et1ä¸­ ç­›é€‰å‡ºæ‰€æœ‰çš„è·ç¦»å°äº10 çš„å€¼ã€‚è¿™å¯¹åº”åˆ°ç»çº¬åº¦ä¸Šé¢ å·²ç»æ˜¯æ¯”è¾ƒå¤§çš„å€¼äº†</span></span><br><span class="line">    joined = spark.sql(<span class="string">"SELECT b.* FROM b_etl b INNER JOIN outlier o ON b.business_id = o.business_id WHERE o.dist&lt;10"</span>)</span><br><span class="line">    <span class="comment">#å°†ç­›é€‰åçš„æ•°æ®è¿›è¡Œå­˜å‚¨ å­˜å‚¨ä¸ºparquetçš„æ ¼å¼</span></span><br><span class="line">    joined.write.parquet(<span class="string">"file:///home/hadoop/yelp-etl/business_etl"</span>, mode=<span class="string">"overwrite"</span>)</span><br></pre></td></tr></table></figure></p>
<h4 id="å†…å®¹è¡¥å……"><a href="#å†…å®¹è¡¥å……" class="headerlink" title="å†…å®¹è¡¥å……"></a>å†…å®¹è¡¥å……</h4><ol>
<li>parquet æ–‡ä»¶æ ¼å¼<br>parqueté‡‡ç”¨ä¸åŒçš„å‹ç¼©æ¯”ï¼Œèƒ½è¾¾åˆ°æœ‰æ•ˆçš„å‹ç¼©æ¯”ã€‚å‡å°‘ç£ç›˜çš„ä½¿ç”¨ã€‚<br>parquetç»“åˆsparkï¼Œå¯ä»¥å®Œç¾çš„å®ç°æ”¯æŒåˆ†åŒºè¿‡æ»¤ã€‚å¦‚ï¼Œéœ€è¦æŸä¸ªäº§å“æŸæ®µæ—¶é—´çš„æ•°æ®ï¼Œåˆ™hdfsåªå–è¿™ä¸ªæ–‡ä»¶å¤¹ã€‚<br>åˆ—ä¿®å‰ªï¼šå…¶å®è¯´ç®€å•ç‚¹å°±æ˜¯æˆ‘ä»¬è¦å–å›çš„é‚£äº›åˆ—çš„æ•°æ®</li>
<li>ç¦»ç¾¤å€¼<br>ç¦»ç¾¤å€¼(outlier)ï¼Œä¹Ÿç§°é€¸å‡ºå€¼ï¼Œæ˜¯æŒ‡åœ¨æ•°æ®ä¸­æœ‰ä¸€ä¸ªæˆ–å‡ ä¸ªæ•°å€¼ä¸å…¶ä»–æ•°å€¼ç›¸æ¯”å·®å¼‚è¾ƒå¤§.</li>
<li>withColumn(colName, col)<br>  è¿™é‡Œè¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­é—ç•™çš„ä¸€ä¸ªé—®é¢˜ï¼ŒwithColumnå¾€æ•°æ®é‡Œé¢æ‰§è¡Œæ·»åŠ æ“ä½œçš„æ—¶å€™ï¼Œå½“colNameçš„åå­—ä¸åŸè¡¨ä¸­çš„åå­—ä¸€æ ·çš„æ—¶å€™ï¼Œæ·»åŠ æ“ä½œæ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚</li>
</ol>
<h3 id="æ•°æ®åˆ†æ"><a href="#æ•°æ®åˆ†æ" class="headerlink" title="æ•°æ®åˆ†æ"></a>æ•°æ®åˆ†æ</h3><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦å¯¹æ¸…ç†åçš„æ•°æ®è¿›è¡Œåˆ†æã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">analysis</span><span class="params">(data_path)</span>:</span></span><br><span class="line">    <span class="comment"># è¯»å–æ¸…ç†åçš„æ•°æ®è·¯å¾„ï¼Œå­˜å‚¨çš„parqueæ•°æ®ï¼Œå¹¶æŒä¹…åŒ–åˆ°ç£ç›˜ä¸­</span></span><br><span class="line">    business = spark.read.parquet(data_path).cache()</span><br><span class="line">    <span class="comment">#å°†æ–°çš„æ•°æ®å»ºç«‹ä¸€ä¸ªæ–°çš„è§†å›¾ business</span></span><br><span class="line">    business.createOrReplaceTempView(<span class="string">"business"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#ä»ä¸Šé¢å¤„ç†è¿‡çš„æ•°æ®ä¸­ï¼Œé€‰æ‹©å„ç§å•†ä¸šç±»åˆ«çš„æ´²å¿ã€åŸé•‡ã€æ˜Ÿçº§è¯„åˆ†ã€è¯„è®ºæ•°</span></span><br><span class="line">    <span class="comment">#explode åœ¨sqlè¯­å¥ä¸­ç”¨æ¥å¤„ç†arrayç±»å‹çš„æ•°æ®ã€‚</span></span><br><span class="line">    part_business = spark.sql(<span class="string">"SELECT state, city, stars,review_count, explode(categories) AS category FROM business"</span>).cache()</span><br><span class="line">    <span class="comment">#é»˜è®¤æ˜¾ç¤ºå‰ 20 è¡Œ å¹¶æç¤ºonly showing top 20 rows</span></span><br><span class="line">    part_business.show()</span><br></pre></td></tr></table></figure>
<p>Start analysis data!<br>+â€”â€“+â€”â€”â€”â€”â€”-+â€”â€“+â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€“+<br>|state|            city|stars|review_count|            category|<br>+â€”â€“+â€”â€”â€”â€”â€”-+â€”â€“+â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€“+<br>|   AZ|         Phoenix|  4.0|          41|            Notaries|<br>|   AZ|         Phoenix|  4.0|          41|     Mailbox Centers|<br>|   AZ|         Phoenix|  4.0|          41|   Printing Services|<br>|   AZ|         Phoenix|  4.0|          41|      Local Services|<br>|   AZ|         Phoenix|  4.0|          41|    Shipping Centers|<br>|   NV|       Las Vegas|  4.0|         681|         Restaurants|<br>|   NV|       Las Vegas|  4.0|         681|                Bars|<br>|   NV|       Las Vegas|  4.0|         681|           Nightlife|<br>|   NV|       Las Vegas|  4.0|         681|      American (New)|<br>|   NV|       Las Vegas|  4.0|         681|             Seafood|<br>|   QC|Vaudreuil-Dorion|  4.0|           7|                Food|<br>|   QC|Vaudreuil-Dorion|  4.0|           7|            Bakeries|<br>|   AZ|      Scottsdale|  3.5|           5|            Shopping|<br>|   AZ|      Scottsdale|  3.5|           5|       Home &amp; Garden|<br>|   AZ|      Scottsdale|  3.5|           5|          Mattresses|<br>|   NC|       Charlotte|  3.0|          64|                Gyms|<br>|   NC|       Charlotte|  3.0|          64|        Sports Clubs|<br>|   NC|       Charlotte|  3.0|          64|         Active Life|<br>|   NC|       Charlotte|  3.0|          64| Fitness &amp; Instruâ€¦|<br>|   ON|     Mississauga|  4.5|          12|         Restaurants|<br>+â€”â€“+â€”â€”â€”â€”â€”-+â€”â€“+â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€“+<br>only showing top 20 rows</p>
<p>ä¸Šè¿°å°±æ˜¯å¯¹å¤„ç†å®Œçš„æ•°æ®è¿›è¡Œä¸€ä¸ªæ˜¾ç¤ºä»¥åŠç­›é€‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å°†ç­›é€‰çš„å•†ä¸šç±»åˆ«çš„ç›¸å…³ä¿¡æ¯ åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾</span></span><br><span class="line">    part_business.createOrReplaceTempView(<span class="string">'part_business_1'</span>)</span><br><span class="line">    <span class="comment">#é€‰æ‹©æ´² åŸå¸‚ æ˜Ÿçº§è¯„å®šï¼Œè¯„è®ºæ•° </span></span><br><span class="line">    <span class="comment">#  REPLACE(category, ' ','')as new_category çš„å«ä¹‰æ˜¯å¯¹category è¿™ä¸€è¡Œè¿›è¡Œâ€˜â€™ æ›¿æ¢æˆâ€˜â€™ ç„¶ååˆ›å»ºä¸€ä¸ªæ–°çš„ä»£è¡¨å•†å®¶ç±»åˆ«çš„åˆ—ï¼ˆç›¸å½“äºå¯¹è¿™ä¸€åˆ—çš„æ•°æ®è¿›è¡Œäº†ä¸€ä¸ªå¤‡ä»½ï¼‰</span></span><br><span class="line">    part_business = spark.sql(<span class="string">"SELECT state, city, stars, review_count, REPLACE(category, ' ','')as new_category FROM part_business_1"</span>)</span><br><span class="line">    <span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾</span></span><br><span class="line">    part_business.createOrReplaceTempView(<span class="string">'part_business'</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ‰€æœ‰çš„ä¸åŒçš„å•†å®¶ç±»åˆ«</span></span><br><span class="line">    print(<span class="string">"## All distinct categories"</span>)</span><br><span class="line">    <span class="comment"># ç­›é€‰æ‰€æœ‰ç§ç±»çš„å•†å®¶ åˆ†åˆ«æ˜¯å•†å®¶çš„id ä»¥åŠ å•†å®¶çš„ç§ç±»</span></span><br><span class="line">    all_categories = spark.sql(<span class="string">"SELECT business_id, explode(categories) AS category FROM business"</span>)</span><br><span class="line">    <span class="comment">#å°†ç­›é€‰å‡ºçš„æ•°æ®é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾</span></span><br><span class="line">    all_categories.createOrReplaceTempView(<span class="string">'all_categories'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¥›é™¤é‡å¤çš„æ•°æ® å¹¶è®¡ç®—å‡ºæ‰€æœ‰ç§ç±»çš„ä¸ªæ•°</span></span><br><span class="line">    distinct = spark.sql(<span class="string">"SELECT COUNT(DISTINCT(new_category)) FROM part_business"</span>)</span><br><span class="line">    distinct.show()</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°è¿‡ç¨‹æ˜¯ç»Ÿè®¡å‡ºæ‰€æœ‰ç§ç±»çš„å•†å®¶ã€‚</p>
<p> All distinct categories<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+<br>|count(DISTINCT new_category)|<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+<br>|                        1318|<br>+â€”â€”â€”â€”â€”â€”â€”â€”â€”-+</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"## Top 10 business categories"</span>)</span><br><span class="line">    <span class="comment">#ç»Ÿè®¡å‡ºæ²¡ç§ç§ç±»çš„å•†å®¶çš„ä¸ªæ•° å¹¶ä¸”æŒ‰ç…§é™åºæ’åˆ—</span></span><br><span class="line">    top_cat = spark.sql(<span class="string">"SELECT new_category, COUNT(*) as freq FROM part_business GROUP BY new_category ORDER BY freq DESC"</span>)</span><br><span class="line">    <span class="comment">#æ˜¾ç¤ºå‡ºæ’åå‰10çš„å•†å®¶çš„ç§ç±»</span></span><br><span class="line">    top_cat.show(<span class="number">10</span>) </span><br><span class="line">    <span class="comment">#å°†ç»Ÿè®¡å‡ºçš„æ•°æ® å­˜å‚¨ä¸º jsonæ–‡ä»¶</span></span><br><span class="line">    top_cat.write.json(<span class="string">"file:///usr/local/spark/yelp/analysis/top_category"</span>, mode=<span class="string">'overwrite'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201023212023388.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨æ¯ä¸ªåŸå¸‚ä¸­å•†ä¸šç§ç±»çš„ä¸ªæ•° ä»…æŒ‰ç…§å•†ä¸šç§ç±»çš„ä¸ªæ•°æ˜¾ç¤º å‰20æ¡ </span></span><br><span class="line">   print(<span class="string">"## Top business categories - in every city"</span>)</span><br><span class="line">   top_cat_city = spark.sql(<span class="string">"SELECT city, new_category, COUNT(*) as freq FROM part_business GROUP BY city, new_category ORDER BY freq DESC"</span>)</span><br><span class="line">   top_cat_city.show()  </span><br><span class="line">   <span class="comment">#å°†æ•°æ®å­˜å‚¨åˆ°jsonä¸­</span></span><br><span class="line">   top_cat.write.json(<span class="string">"file:///usr/local/spark/yelp/analysis/top_category_city"</span>, mode=<span class="string">'overwrite'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å•†ä¸šæ•°é‡æœ€å¤šçš„åŸå¸‚</span></span><br><span class="line">    print(<span class="string">"## Cities with most businesses"</span>)</span><br><span class="line">    bus_city = spark.sql(<span class="string">"SELECT city, COUNT(business_id) as no_of_bus FROM business GROUP BY city ORDER BY no_of_bus DESC"</span>)</span><br><span class="line">    bus_city.show(<span class="number">10</span>)   </span><br><span class="line">    bus_city.write.json(<span class="string">"file:///usr/local/spark/yelp/analysis/top_business_city"</span>, mode=<span class="string">'overwrite'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201023212642926.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ¯ç§å•†ä¸šç§ç±»çš„ å¹³å‡è¯„è®ºæ•° </span></span><br><span class="line">    print(<span class="string">"## Average review count by category"</span>)</span><br><span class="line">    avg_city = spark.sql(</span><br><span class="line">        <span class="string">"SELECT new_category, AVG(review_count)as avg_review_count FROM part_business GROUP BY new_category ORDER BY avg_review_count DESC"</span>)</span><br><span class="line">    avg_city.show()  </span><br><span class="line">    avg_city.write.json(<span class="string">"file:///usr/local/spark/yelp/analysis/average_review_category"</span>, mode=<span class="string">'overwrite'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201023212832651.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™é‡Œå…¶å®ä¹Ÿæ˜¯æ˜¾ç¤ºäº†20è¡Œï¼Œå°±ä¸æˆªå›¾å¤ªå¤šäº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ¯ç§å•†ä¸šç±»åˆ«çš„ å¹³å‡æ˜Ÿçº§æ°´å¹³</span></span><br><span class="line">    print(<span class="string">"## Average stars by category"</span>)</span><br><span class="line">    avg_state = spark.sql(</span><br><span class="line">        <span class="string">"SELECT new_category, AVG(stars) as avg_stars FROM part_business GROUP BY new_category ORDER BY avg_stars DESC"</span>)</span><br><span class="line">    avg_state.show()   </span><br><span class="line">    avg_state.write.json(<span class="string">"file:///usr/local/spark/yelp/analysis/average_stars_category"</span>, mode=<span class="string">'overwrite'</span>)</span><br></pre></td></tr></table></figure>
<p>ç”±äºå­—æ®µ attribute ä¸­çš„RestaurantsTakeoutå¯èƒ½NULLçš„æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦åˆ©ç”¨dropna()å¤„ç†ç¼ºå¤±å€¼çš„é—®é¢˜ã€‚è¯¥é¡¹å¯¹å•†å®¶æ˜¯å¦æœ‰â€™Take outâ€™æœåŠ¡è¿›è¡Œåˆ†æï¼Œç»Ÿè®¡å‡ºä¸¤ç§ä¸åŒæƒ…å†µçš„å•†å®¶çš„å¹³å‡æ˜Ÿçº§è¯„åˆ†.å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å•†å®¶æ‰€è¿›è¡Œçš„ä¸šåŠ¡åˆ†æ</span></span><br><span class="line">    print(<span class="string">"## Data based on Attribute"</span>)</span><br><span class="line">    <span class="comment">#ä»…ç­›é€‰å‡º å•†å®¶æ‰€è¿›è¡Œçš„ä¸šåŠ¡ï¼Œæ˜Ÿçº§ï¼Œä»¥åŠåˆ’åˆ†åˆ°çš„å•†ä¸šç±»åˆ«</span></span><br><span class="line">    for_att = spark.sql(<span class="string">"SELECT attributes, stars, explode(categories) AS category FROM business"</span>)</span><br><span class="line">    <span class="comment">#å°†ç­›é€‰å‡ºçš„æ•°æ® åˆ›å»ºä¸€ä¸ªæ–°çš„è§†å›¾</span></span><br><span class="line">    for_att.createOrReplaceTempView(<span class="string">"for_att"</span>)</span><br><span class="line">    <span class="comment">#å¯¹ å•†å®¶æ˜¯å¦ æœ‰å¤–å–è¿™ä¸ª ä¸šåŠ¡è¿›è¡Œåˆ†æ</span></span><br><span class="line">    attribute = <span class="string">'RestaurantsTakeout'</span></span><br><span class="line">    attribute_score(attribute)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attribute_score</span><span class="params">(attribute)</span>:</span></span><br><span class="line">    <span class="comment"># è¿™é‡Œçš„format è¡¨ç¤ºç”¨attributeçš„å€¼ä»£æ›¿attrçš„å€¼</span></span><br><span class="line">    att = spark.sql(<span class="string">"SELECT attributes.&#123;attr&#125; as &#123;attr&#125;, category, stars FROM for_att"</span>.format(attr=attribute)).dropna()</span><br><span class="line">    att.createOrReplaceTempView(<span class="string">"att"</span>)</span><br><span class="line">    att_group = spark.sql(<span class="string">"SELECT &#123;attr&#125;, AVG(stars) AS stars FROM att GROUP BY &#123;attr&#125; ORDER BY stars"</span>.format(attr=attribute))</span><br><span class="line">    att_group.show()    </span><br><span class="line">    att_group.write.json(<span class="string">"file:///usr/local/spark/yelp/analysis/&#123;attr&#125;"</span>.format(attr=attribute), mode=<span class="string">'overwrite'</span>)</span><br></pre></td></tr></table></figure></p>
<p>åˆ°è¿™é‡Œæ‰€æœ‰çš„æ•°æ®åˆ†æçš„ä»£ç å°±è®²è§£å®Œäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå¯¹äºæˆ‘ä»¬ç»Ÿè®¡å‡ºæ¥çš„è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬é‚£å¦‚ä½•æ›´ç›´è§‚çš„æŸ¥çœ‹ã€‚ä¹Ÿå°±æ˜¯æ•°æ®çš„å¯è§†åŒ–</p>
<h3 id="æ•°æ®å¯è§†åŒ–"><a href="#æ•°æ®å¯è§†åŒ–" class="headerlink" title="æ•°æ®å¯è§†åŒ–"></a>æ•°æ®å¯è§†åŒ–</h3><p>è¿™é‡Œæˆ‘ä»¬è¿›è¡Œçš„æ•°æ®å¯è§†åŒ–æ˜¯é€šè¿‡ pythonä¸­çš„matlibåŒ…è¿›è¡Œç»˜å›¾è¡¨ç¤ºçš„ã€‚</p>
<h4 id="æ•°æ®çš„è¯»å–"><a href="#æ•°æ®çš„è¯»å–" class="headerlink" title="æ•°æ®çš„è¯»å–"></a>æ•°æ®çš„è¯»å–</h4><p>æˆ‘ä»¬å…ˆå°†ä¸Šé¢å·²ç»åˆ†æè¿‡çš„æ•°æ®å¹¶å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ•°æ®è·¯å¾„è‡ªå®šä¹‰ã€‚ï¼ˆè¿™ä¸€å—ç³»ç»Ÿå¯æ˜¯æ— æ³•è‡ªå·±æ‰¾åˆ°ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AVE_REVIEW_CATEGORY = <span class="string">'/usr/local/spark/yelp/analysis/average_review_category'</span></span><br><span class="line">TOP_CATEGORY_CITY = <span class="string">'/usr/local/spark/yelp/analysis/top_category_city'</span></span><br><span class="line">TOP_BUSINESS_CITY = <span class="string">'/usr/local/spark/yelp/analysis/top_business_city'</span></span><br><span class="line">TOP_CATEGORY = <span class="string">'/usr/local/spark/yelp/analysis/top_category'</span></span><br><span class="line">AVE_STARS_CATEGORY = <span class="string">'/usr/local/spark/yelp/analysis/average_stars_category'</span></span><br><span class="line">TAKEOUT = <span class="string">'/usr/local/spark/yelp/analysis/RestaurantsTakeout'</span></span><br></pre></td></tr></table></figure>
<h4 id="å®šä¹‰æ•°æ®è¯»å–çš„å‡½æ•°"><a href="#å®šä¹‰æ•°æ®è¯»å–çš„å‡½æ•°" class="headerlink" title="å®šä¹‰æ•°æ®è¯»å–çš„å‡½æ•°"></a>å®šä¹‰æ•°æ®è¯»å–çš„å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_json</span><span class="params">(file_path)</span>:</span></span><br><span class="line">    <span class="comment">#è¯»å–è¿™ä¸ªè·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„åç§°</span></span><br><span class="line">    json_path_names = os.listdir(file_path)</span><br><span class="line">    data = []</span><br><span class="line">    <span class="comment">#éå†æ‰€æœ‰çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> range(len(json_path_names)):</span><br><span class="line">        <span class="comment">#æ‹¼æ¥è·¯å¾„åç§°</span></span><br><span class="line">        json_path = file_path + <span class="string">'/'</span> + json_path_names[idx]</span><br><span class="line">        <span class="comment">#åˆ¤æ–­æ–‡ä»¶æ˜¯ä¸æ˜¯jsonæ–‡ä»¶ å¦‚æœæ˜¯çš„è¯ å°±æ‰“å¼€è¯»å–</span></span><br><span class="line">        <span class="keyword">if</span> json_path.endswith(<span class="string">'.json'</span>):</span><br><span class="line">            <span class="keyword">with</span> open(json_path) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="comment">#å°†è¯»å–çš„æ•°æ®æ‹¼æ¥åˆ°dataä¸­ è¿”å›è¯»å–åˆ°çš„æ•°æ®</span></span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                    data.append(json.loads(line))</span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>
<p>è·å¾—è¯»å–çš„æ‰€æœ‰çš„æ•°æ® </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ave_review_category_list = read_json(AVE_REVIEW_CATEGORY)</span><br><span class="line">open_close_list = read_json(OPEN_CLOSE)</span><br><span class="line">top_category_city_list = read_json(TOP_CATEGORY_CITY)</span><br><span class="line">top_business_city_list = read_json(TOP_BUSINESS_CITY)</span><br><span class="line">top_category_list = read_json(TOP_CATEGORY)</span><br><span class="line">ave_stars_category_list = read_json(AVE_STARS_CATEGORY)</span><br><span class="line">takeout_list = read_json(TAKEOUT)</span><br></pre></td></tr></table></figure>
<h4 id="ä¸‹é¢æ˜¯æ•°æ®çš„å›¾å½¢åŒ–å±•ç¤º"><a href="#ä¸‹é¢æ˜¯æ•°æ®çš„å›¾å½¢åŒ–å±•ç¤º" class="headerlink" title="ä¸‹é¢æ˜¯æ•°æ®çš„å›¾å½¢åŒ–å±•ç¤º"></a>ä¸‹é¢æ˜¯æ•°æ®çš„å›¾å½¢åŒ–å±•ç¤º</h4><p>å¯¹äºè¿™ä¸€éƒ¨åˆ†ï¼Œå¯¹ä¸€éƒ¨åˆ†è¿›è¡Œè®²è§£ï¼Œå› ä¸ºå…¶ä½™çš„å›¾å½¢çš„ç»˜ç”» çš„æ€è·¯æ˜¯ä¸€æ ·çš„ã€‚ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œåœ¨äºç”»å›¾çš„è¯­æ³•ä¸ä¸€æ ·ã€‚ï¼ˆè¿™é‡Œå¯ä»¥è‡ªè¡Œå­¦ä¹ ï¼‰<br><a href="https://matplotlib.org/gallery/index.html" target="_blank" rel="noopener">å­¦ä¹ é“¾æ¥ï¼ˆmarplotlibç”»å›¾ï¼‰</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åœ¨æ¯ä¸ªåŸå¸‚ä¸­å•†ä¸šç§ç±»çš„ä¸ªæ•° ä»…æŒ‰ç…§å•†ä¸šç§ç±»çš„ä¸ªæ•°æ˜¾ç¤º å‰10æ¡ æ ¹æ®å•†ä¸šç§ç±»å‡ºç°çš„æ¬¡æ•°è¿›è¡Œ æ’å ä»å°åˆ°å¤§</span></span><br><span class="line">    top_category_list.sort(key=<span class="keyword">lambda</span> x: x[<span class="string">'freq'</span>], reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment">#å•†ä¸šç§ç±»çš„åç§°</span></span><br><span class="line">    top_category_key = []</span><br><span class="line">    <span class="comment">#å•†ä¸šç§ç±»çš„ç»Ÿè®¡ä¸ªæ•°</span></span><br><span class="line">    top_category_value = []</span><br><span class="line">    <span class="comment">#æ•°æ®å¡«å……</span></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        one = top_category_list[idx]</span><br><span class="line">        top_category_key.append(one[<span class="string">'new_category'</span>])</span><br><span class="line">        top_category_value.append(one[<span class="string">'freq'</span>])</span><br><span class="line">    <span class="comment">#ç»˜åˆ¶æ¡å½¢å›¾ æˆªå–å‰10å</span></span><br><span class="line">    plt.barh(top_category_key[:<span class="number">10</span>], top_category_value[:<span class="number">10</span>], tick_label=top_category_key[:<span class="number">10</span>])</span><br><span class="line">    <span class="comment">#æ ‡é¢˜</span></span><br><span class="line">    plt.title(<span class="string">'Top 10 Categories'</span>, size = <span class="number">16</span>)</span><br><span class="line">    <span class="comment">#x çš„labelä¸ºFrequency æ¡å½¢å›¾çš„å®½åº¦ä¸º 8 é¢œè‰² black</span></span><br><span class="line">    plt.xlabel(<span class="string">'Frequency'</span>,size =<span class="number">8</span>, color = <span class="string">'Black'</span>)</span><br><span class="line">    plt.ylabel(<span class="string">'Category'</span>,size = <span class="number">8</span>, color = <span class="string">'Black'</span>)</span><br><span class="line">    <span class="comment"># ä¼šè‡ªåŠ¨å¡«å……å­å›¾å‚æ•° è®©å­å›¾èƒ½å¤Ÿå¡«å……æ•´ä¸ªå›¾åƒåŒºåŸŸã€‚ï¼ˆä»…ä»…æ£€æŸ¥ åæ ‡è½´çš„æ ‡ç­¾ï¼Œåˆ»åº¦æ ‡ç­¾ä»¥åŠæ ‡é¢˜çš„éƒ¨åˆ†ï¼‰</span></span><br><span class="line">    plt.tight_layout()</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201024111407659.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><img src="https://img-blog.csdnimg.cn/20201024112306697.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™æ ·æ˜¯ä¸æ˜¯çœ‹èµ·æ¥å°±æ›´åŠ ç›´è§‚äº†å‘¢ï¼</p>
<p>æ˜¾ç¤ºçš„å›¾ç‰‡ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œæˆ–è€…æ ‡é¢˜çš„å­—ä½“æ ¼å¼ç­‰ä¹Ÿæ˜¯å¯ä»¥è°ƒçš„ï¼Œè¿™é‡Œå°±ä¸åœ¨è¯¦ç»†çš„ä»‹ç»äº†ã€‚</p>
<p>æºç å°±å­˜åœ¨æˆ‘çš„jupyterä¸Šäº†ï¼ˆä¸è¿‡éœ€è¦æˆ‘å¼€å¯æœåŠ¡å™¨æ‰å¯ä»¥è®¿é—®ï¼‰<a href="http://www.itgorge.ltd:8888/notebooks/PYSparkTest.ipynb" target="_blank" rel="noopener">æºç </a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/10/24/emmm-sparkå•†ä¸šæ•°æ®åˆ†ææ¡ˆä¾‹è®²è§£/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="emmm-sparkå•†ä¸šæ•°æ®åˆ†ææ¡ˆä¾‹è®²è§£">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-å¤§æ•°æ®åˆ†æä¹‹é˜¿é‡Œäº‘å®‰è£…Spark" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/16/å¤§æ•°æ®åˆ†æä¹‹é˜¿é‡Œäº‘å®‰è£…Spark/" class="article-date">
  	<time datetime="2020-10-16T14:31:12.930Z" itemprop="datePublished">2020-10-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/16/å¤§æ•°æ®åˆ†æä¹‹é˜¿é‡Œäº‘å®‰è£…Spark/">
        å¤§æ•°æ®åˆ†æä¹‹é˜¿é‡Œäº‘å®‰è£…Spark
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>åœ¨æˆ‘ä»¬å·²ç»å®‰è£…å¥½Hadoopçš„é˜¿é‡Œäº‘ä¸Šï¼Œè¿›è¡Œå¦‚ä¸‹æ“ä½œ</p>
<h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p><a href="https://www.apache.org/dyn/closer.lua/spark/spark-3.0.1/spark-3.0.1-bin-hadoop2.7.tgz" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a><br>ä½¿ç”¨wgetåœ¨linuxä¸Šè¿›è¡Œä¸‹è½½å³å¯</p>
<h2 id="è§£å‹"><a href="#è§£å‹" class="headerlink" title="è§£å‹"></a>è§£å‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf spark-3.0.1-bin-hadoop2.7.tgz -C /usr/<span class="built_in">local</span></span><br></pre></td></tr></table></figure>
<h2 id="æ”¹å-ä¿®æ”¹æ–‡ä»¶æƒé™"><a href="#æ”¹å-ä¿®æ”¹æ–‡ä»¶æƒé™" class="headerlink" title="æ”¹å+ä¿®æ”¹æ–‡ä»¶æƒé™"></a>æ”¹å+ä¿®æ”¹æ–‡ä»¶æƒé™</h2><p>å› ä¸ºæˆ‘åœ¨æ­å»ºhadoopçš„æ—¶å€™ï¼Œåœ¨rootç”¨æˆ·ä¸Šæ–°åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç”¨æˆ·ï¼Œå› æ­¤ï¼Œè¦æŠŠæƒé™ç»™hadoopç”¨æˆ·</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mv ./spark-3.0.1-bin-hadoop2.7 ./spark</span><br><span class="line">sudo chown -R hadoop ./spark</span><br></pre></td></tr></table></figure>
<h2 id="æ›´æ”¹ä¸ºå¯æ‰§è¡Œæ–‡ä»¶"><a href="#æ›´æ”¹ä¸ºå¯æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="æ›´æ”¹ä¸ºå¯æ‰§è¡Œæ–‡ä»¶"></a>æ›´æ”¹ä¸ºå¯æ‰§è¡Œæ–‡ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp ./conf/spark-env.sh.template ./conf/spark-env.sh</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘spark-env.shæ–‡ä»¶(vim ./conf/spark-env.sh)ï¼Œåœ¨ç¬¬ä¸€è¡Œæ·»åŠ ä»¥ä¸‹é…ç½®ä¿¡æ¯:</p>
<p>export SPARK_DIST_CLASSPATH=$(/usr/local/hadoop/bin/hadoop classpath)</p>
<p>æœ‰äº†ä¸Šé¢çš„é…ç½®ä¿¡æ¯ä»¥åï¼ŒSparkå°±å¯ä»¥æŠŠæ•°æ®å­˜å‚¨åˆ°Hadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸHDFSä¸­ï¼Œä¹Ÿå¯ä»¥ä»HDFSä¸­è¯»å–æ•°æ®ã€‚å¦‚æœæ²¡æœ‰é…ç½®ä¸Šé¢ä¿¡æ¯ï¼ŒSparkå°±åªèƒ½è¯»å†™æœ¬åœ°æ•°æ®ï¼Œæ— æ³•è¯»å†™HDFSæ•°æ®ã€‚<br>é…ç½®å®Œæˆåå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦åƒHadoopè¿è¡Œå¯åŠ¨å‘½ä»¤ã€‚<br>é€šè¿‡è¿è¡ŒSparkè‡ªå¸¦çš„ç¤ºä¾‹ï¼ŒéªŒè¯Sparkæ˜¯å¦å®‰è£…æˆåŠŸã€‚</p>
<h2 id="å¯åŠ¨è¿›å…¥spark-shelläº¤äº’å¼æ‰§è¡Œç¯å¢ƒ"><a href="#å¯åŠ¨è¿›å…¥spark-shelläº¤äº’å¼æ‰§è¡Œç¯å¢ƒ" class="headerlink" title="å¯åŠ¨è¿›å…¥spark-shelläº¤äº’å¼æ‰§è¡Œç¯å¢ƒ"></a>å¯åŠ¨è¿›å…¥spark-shelläº¤äº’å¼æ‰§è¡Œç¯å¢ƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/spark</span><br><span class="line">./bin/spark-shell</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°Sparkçš„ä¿¡æ¯ï¼Œè¿™æ ·sparkå°±å®‰è£…æˆåŠŸäº†<br>å¦‚æœæƒ³è¦é€€å‡ºsparkçš„è¯ï¼Œæ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; :quit</span><br></pre></td></tr></table></figure>
<h2 id="æµ‹è¯•Sparkæ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®Ubuntuç³»ç»Ÿä¸­çš„æœ¬åœ°æ–‡ä»¶"><a href="#æµ‹è¯•Sparkæ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®Ubuntuç³»ç»Ÿä¸­çš„æœ¬åœ°æ–‡ä»¶" class="headerlink" title="æµ‹è¯•Sparkæ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®Ubuntuç³»ç»Ÿä¸­çš„æœ¬åœ°æ–‡ä»¶"></a>æµ‹è¯•Sparkæ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®Ubuntuç³»ç»Ÿä¸­çš„æœ¬åœ°æ–‡ä»¶</h2><p>åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œé‡Œé¢è¾“å…¥hello word</p>
<p>å¼€å¯spark ,å†™å…¥æµ‹è¯•æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cala&gt; val line=sc.textFile(<span class="string">"file:///home/hadoop/a.txt"</span>)</span><br><span class="line">line: org.apache.spark.rdd.RDD[String] = file:///home/hadoop/a.txt MapPartitionsRDD[1] at textFile at &lt;console&gt;:24</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="built_in">print</span>(line.count())</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h2 id="æµ‹è¯•Sparkæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è®¿é—®Hadoopä¸­çš„HDFS"><a href="#æµ‹è¯•Sparkæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è®¿é—®Hadoopä¸­çš„HDFS" class="headerlink" title="æµ‹è¯•Sparkæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è®¿é—®Hadoopä¸­çš„HDFS"></a>æµ‹è¯•Sparkæ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è®¿é—®Hadoopä¸­çš„HDFS</h2><p>é¦–å…ˆæ‰§è¡Œä¸€ä¸‹jpsæ£€æŸ¥ä¸€ä¸‹ï¼Œhadoopæ˜¯å¦å·²ç»æ­£å¸¸å¯åŠ¨ã€‚<br>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨HDFSä¸­å·²ç»å‡†å¤‡å¥½çš„æµ‹è¯•æ–‡ä»¶ï¼Œæ¥æŸ¥çœ‹ä¸€ä¸‹ä¸»è¦çš„æ–‡ä»¶ä¿¡æ¯<br>ï¼Œè¿™é‡Œå‡è®¾å¤§å®¶éƒ½å·²ç»æŒæ¡äº†Hadoopçš„åŸºæœ¬çŸ¥è¯†ã€‚ è¿™æ˜¯åœ¨æˆ‘çš„ä¸»æ–‡ä»¶ä¸‹ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -cat /user/hadoop/text.txt</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å†æ¥æ‰§è¡Œä¸€ä¸‹<br>val line=sc.textFile(â€œ/user/hadoop/text.txtâ€)<br> println(line.count())<br> æ¥æ£€æŸ¥ä¸€ä¸‹ã€‚<br> <em>æ³¨æ„ï¼šåœ¨spark-shelläº¤äº’å¼ç¯å¢ƒä¸­ï¼Œè¦è®¿é—®HDFSä¸­çš„æ–‡ä»¶æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ sc.textFile(â€œ/user/linziyu/word.txtâ€)å’Œsc.textFile(â€œword.txtâ€)è¿™ä¸¤ç§è·¯å¾„æ ¼å¼</em><br> è¿™æ ·æˆ‘ä»¬çš„Sparkå°±æ­å»ºå®Œäº†ã€‚</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/10/16/å¤§æ•°æ®åˆ†æä¹‹é˜¿é‡Œäº‘å®‰è£…Spark/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="å¤§æ•°æ®åˆ†æä¹‹é˜¿é‡Œäº‘å®‰è£…Spark">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-å¤§æ•°æ®-HBaseå®éªŒä»¥åŠè®²è§£" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/15/å¤§æ•°æ®-HBaseå®éªŒä»¥åŠè®²è§£/" class="article-date">
  	<time datetime="2020-10-15T12:13:54.270Z" itemprop="datePublished">2020-10-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/15/å¤§æ•°æ®-HBaseå®éªŒä»¥åŠè®²è§£/">
        å¤§æ•°æ®-Hbaseå®éªŒä»¥åŠè®²è§£
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>HBaseæ˜¯ä¸€ä¸ªé¢å‘åˆ—çš„é«˜å¯é ã€é«˜æ€§èƒ½ã€å¯ä¼¸ç¼©çš„åˆ†å¸ƒå¼æ•°æ®åº“ã€‚æ˜¯Googleå…¬å¸çš„BigTableçš„å¼€æºå®ç°ï¼Œä¸»è¦ç”¨æ¥å­˜å‚¨<a href="https://baike.baidu.com/item/%E9%9D%9E%E7%BB%93%E6%9E%84%E5%8C%96%E6%95%B0%E6%8D%AE/309808?fr=aladdin" target="_blank" rel="noopener">éç»“æ„åŒ–æ•°æ®</a>å’Œ<a href="https://baike.baidu.com/item/%E5%8D%8A%E7%BB%93%E6%9E%84%E5%8C%96%E6%95%B0%E6%8D%AE/3193001?fr=aladdin" target="_blank" rel="noopener">åŠç»“æ„åŒ–æ•°æ®</a>çš„æ¾æ•£æ•°æ®ï¼Œæ”¯æŒå¤§è§„æ¨¡æµ·é‡æ•°æ®çš„ã€åˆ†å¸ƒå¼å¹¶å‘æ•°æ®å¤„ç†æ•ˆç‡æé«˜ï¼›é€‚ç”¨äºå»‰ä»·è®¾å¤‡ï¼Œé€‚åˆè¯»æ“ä½œï¼Œä¸é€‚åˆå†™æ“ä½œã€‚HBaseå¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè€Œä¸ç”¨HDFSä½œä¸ºåº•å±‚æ•°æ®å­˜å‚¨æ–¹å¼ã€‚ä¸ºäº†æé«˜æ•°æ®å¯é æ€§å’Œç³»ç»Ÿçš„å¥å£®æ€§ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨HDFSä½œä¸ºåº•å±‚æ•°æ®å­˜å‚¨æ–¹å¼ã€‚</p>
<h2 id="HBaseä¸ä¼ ç»Ÿæ•°æ®åº“çš„å¯¹æ¯”"><a href="#HBaseä¸ä¼ ç»Ÿæ•°æ®åº“çš„å¯¹æ¯”" class="headerlink" title="HBaseä¸ä¼ ç»Ÿæ•°æ®åº“çš„å¯¹æ¯”"></a>HBaseä¸ä¼ ç»Ÿæ•°æ®åº“çš„å¯¹æ¯”</h2><table>
<thead>
<tr>
<th>å¯¹æ¯”é¡¹ç›®</th>
<th>ä¼ ç»Ÿæ•°æ®åº“</th>
<th>HBase</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ•°æ®ç±»å‹</td>
<td>å…³ç³»å‹æ¨¡å‹</td>
<td>æœªç»è§£é‡Šçš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>æ•°æ®æ“ä½œ</td>
<td>æ’å…¥ã€åˆ é™¤ã€æ›´æ–°ã€æŸ¥è¯¢ç­‰å·²ç»å¤šè¡¨è¿æ¥ç­‰</td>
<td>åªæœ‰ç®€å•çš„æ’å…¥ã€æŸ¥è¯¢ã€åˆ é™¤ã€æ¸…ç©ºç­‰ã€‚é¿å…äº†å¤æ‚çš„è¡¨æ ¼ä¹‹é—´çš„å…³ç³»ï¼Œåªé‡‡ç”¨å•è¡¨çš„ä¸»é”®æŸ¥è¯¢ï¼Œæ— æ³•å®ç°è¡¨çš„è¿æ¥æ“ä½œ</td>
</tr>
<tr>
<td>å­˜å‚¨æ¨¡å¼</td>
<td>åŸºäºè¡Œå­˜å‚¨ï¼Œå…ƒç»„æˆ–è€…è¡Œä¼šè¿ç»­çš„å­˜å‚¨åœ¨ç£ç›˜é¡µ</td>
<td>åŸºäºåˆ—å­˜å‚¨çš„ï¼Œæ¯ä¸ªåˆ—æ—éƒ½ç”±å‡ ä¸ªæ–‡ä»¶ä¿å­˜ï¼Œä¸åŒåˆ—æ—çš„æ–‡ä»¶æ˜¯åˆ†ç¦»çš„</td>
</tr>
<tr>
<td>æ•°æ®ç´¢å¼•</td>
<td>é€šå¸¸å¯ä»¥é’ˆå¯¹ä¸åŒçš„åˆ—æ„å»ºå¤æ‚çš„å¤šä¸ªç´¢å¼•</td>
<td>åªæœ‰ä¸€ä¸ªç´¢å¼•-è¡Œé”®</td>
</tr>
<tr>
<td>æ•°æ®ç»´æŠ¤</td>
<td>æ›´æ–°æ“ä½œçš„æ—¶å€™ï¼Œæ–°çš„å€¼ä¼šè¦†ç›–æ—§çš„å€¼</td>
<td>ä¸ä¼šåˆ é™¤æ—§ç‰ˆçš„æ•°æ®ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„ç‰ˆæœ¬</td>
</tr>
<tr>
<td>å¯ä¼¸ç¼©æ€§</td>
<td>å¾ˆéš¾å®ç°æ¨ªå‘æ‰©å±•ï¼Œçºµå‘æ‰©å±•æœ‰é™</td>
<td>å¾ˆå¥½çš„å®ç°æ°´å¹³æ‰©å±•</td>
</tr>
</tbody>
</table>
<h2 id="æ•°æ®æ¨¡å‹çš„æ–°çš„æ¦‚å¿µ"><a href="#æ•°æ®æ¨¡å‹çš„æ–°çš„æ¦‚å¿µ" class="headerlink" title="æ•°æ®æ¨¡å‹çš„æ–°çš„æ¦‚å¿µ"></a>æ•°æ®æ¨¡å‹çš„æ–°çš„æ¦‚å¿µ</h2><ul>
<li><p>åˆ—æ—<br>ä¸€ä¸ªè¡¨è¢«åˆ†æˆè®¸å¤šä¸ªåˆ—æ—çš„ç»„åˆã€‚åˆ—æ—éœ€è¦åœ¨è¡¨åˆ›å»ºçš„æ—¶å€™å°±åˆ›å»ºå¥½ï¼Œæ•°é‡ä¸èƒ½å¤ªå¤šï¼ˆHBa seçš„ä¸€äº›ç¼ºé™·å¯¼è‡´çš„ï¼‰,å­˜å‚¨åœ¨åŒä¸€ä¸ªåˆ—æ—å½“ä¸­çš„æ•°æ®ï¼Œé€šå¸¸éƒ½æ˜¯å±äºåŒä¸€ç§æ•°æ®ç±»å‹çš„ã€‚åœ¨å­˜å‚¨çš„æ—¶å€™ï¼Œåˆ—æ˜éƒ½ä»¥åˆ—æ—ä½œä¸ºå‰ç¼€çš„ã€‚æ¯”å¦‚ï¼Œcourse:historyå’Œ course:mathè¿™ä¸¤ä¸ªåˆ—éƒ½å±äºcoursesè¿™ä¸ªåˆ—æ—</p>
</li>
<li><p>åˆ—é™å®šç¬¦</p>
</li>
</ul>
<p>åˆ—æ—é‡Œé¢çš„æ•°æ®é€šè¿‡åˆ—é™å®šç¬¦æ¥å®šä½ã€‚åˆ—é™å®šç¬¦ä¸ç”¨äº‹å…ˆå®šä¹‰ï¼Œä¹Ÿä¸éœ€è¦åœ¨ä¸åŒè¡Œä¹‹é—´ä¿æŒä¸€è‡´ã€‚</p>
<ul>
<li><p>æ—¶é—´æˆ³<br>æ¯ä¸ªå•å…ƒæ ¼éƒ½ä¿å­˜ç€åŒä¸€ä»½æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ï¼Œè¿™äº›ç‰ˆæœ¬é‡‡ç”¨æ—¶é—´æˆ³è¿›è¡Œç´¢å¼•ã€‚æ¯æ¬¡å¯¹ä¸€ä¸ªå•å…ƒæ ¼æ‰§è¡Œæ“ä½œçš„æ—¶å€™ï¼ŒHBa seéƒ½ä¼šéšå¼çš„è‡ªåŠ¨ç”Ÿæˆå¹¶å­˜å‚¨ä¸€ä¸ªæ—¶é—´æˆ³ã€‚</p>
</li>
<li><p>æ•°æ®åæ ‡</p>
<p>ä¼ ç»Ÿçš„æ•°æ®åº“æˆ‘ä»¬éƒ½æ˜¯é€šè¿‡äºŒç»´åæ ‡è¿›è¡Œå–å€¼çš„ï¼Œä½†æ˜¯å¯¹äºHBaseæ¥è®²ï¼Œéœ€è¦æ ¹æ®[è¡Œé”®ã€åˆ—æ—ã€åˆ—é™å®šç¬¦ã€æ—¶é—´æˆ³]æ¥ç¡®å®šä¸€ä¸ªå•å…ƒæ ¼ã€‚</p>
<h2 id="ç‰©ç†è§†å›¾"><a href="#ç‰©ç†è§†å›¾" class="headerlink" title="ç‰©ç†è§†å›¾"></a>ç‰©ç†è§†å›¾</h2></li>
</ul>
<p>å¯¹äºæ•°æ®è¡¨çš„è§‚å¯Ÿï¼Œä¾¿äºæˆ‘ä»¬è§‚å¯Ÿçš„æ˜¯æ¦‚å¿µè§†å›¾ï¼Œä½†æ˜¯åœ¨HBa seä¸­å®é™…å­˜å‚¨çš„æ˜¯æŒ‰ç…§æ•°æ®çš„ç‰©ç†è§†å›¾è¿›è¡Œå­˜å‚¨çš„ã€‚ç‰©ç†è§†å›¾æ˜¯é‡‡ç”¨äº†åŸºäºåˆ—çš„å­˜å‚¨æ–¹å¼ï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿçš„æ–¹å¼é‚£æ ·åŸºäºè¡Œçš„å­˜å‚¨æ–¹å¼ã€‚<br><img src="https://img-blog.csdnimg.cn/20201014150445658.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯¹äºåœ¨æ¦‚å¿µè§†å›¾ä¸­ï¼Œç©ºçš„åˆ—ä¸ä¼šå­˜å‚¨æˆnull,è€Œæ˜¯æ ¹æœ¬å°±ä¸ä¼šå­˜å‚¨ã€‚</p>
<p>åˆ—å¼æ•°æ®åº“ä¸»è¦é€‚åˆäºæ‰¹é‡æ•°æ®å¤„ç†å’Œå³å¸­æŸ¥è¯¢ ã€‚<br>ä»–çš„ä¼˜ç‚¹æ˜¯ï¼š<em>å¯ä»¥é™ä½I/Oå¼€é”€ï¼Œæ”¯æŒå¤§å¹¶å‘ç”¨æˆ·æŸ¥è¯¢ï¼Œå¤„ç†é€Ÿåº¦æ¯”ä¼ ç»Ÿæ–¹æ³•å¿«100å€ã€‚</em><br>ä»–çš„ç¼ºç‚¹æ˜¯ï¼šæ‰§è¡Œè¿æ¥æ“ä½œæ—¶éœ€è¦æ˜‚è´µçš„å…ƒç»„é‡æ„ä»£ä»·ï¼Œå› ä¸ºä¸€ä¸ªå…ƒç»„çš„ä¸åŒå±æ€§è¢«åˆ†æ•£åˆ°ä¸åŒçš„ç£ç›˜é¡µä¸­å­˜å‚¨ï¼Œå½“éœ€è¦ä¸€ä¸ªå®Œæ•´çš„å…ƒç»„çš„æ—¶å€™ï¼Œå°±è¦ä»å¤šä¸ªç£ç›˜é¡µä¸­è¯»å–ç›¸åº”å­—æ®µçš„å€¼æ¥é‡æ–°ç»„åˆå¾—åˆ°åŸæ¥çš„ä¸€ä¸ªå…ƒç»„ã€‚</p>
<h2 id="è¿è¡Œæœºåˆ¶"><a href="#è¿è¡Œæœºåˆ¶" class="headerlink" title="è¿è¡Œæœºåˆ¶"></a>è¿è¡Œæœºåˆ¶</h2><p>ä¸»è¦ç†è§£HBa seæ¶æ„ä¸ªéƒ¨åˆ†çš„ä½œç”¨ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯</li>
<li>ZookperæœåŠ¡å™¨</li>
<li>Master</li>
<li><p>RegionæœåŠ¡å™¨</p>
<ul>
<li>Store</li>
<li>HLogæ–‡ä»¶<h2 id="HBase-å¸¸ç”¨çš„She-l-lå‘½ä»¤"><a href="#HBase-å¸¸ç”¨çš„She-l-lå‘½ä»¤" class="headerlink" title="HBase å¸¸ç”¨çš„She l lå‘½ä»¤"></a>HBase å¸¸ç”¨çš„She l lå‘½ä»¤</h2>è‡ªè¡Œå­¦ä¹ ï¼Œç½‘ä¸Šèµ„æ–™å¾ˆå¤š<h2 id="HBase-å¸¸ç”¨çš„Java-API-åŠåº”ç”¨å®ä¾‹"><a href="#HBase-å¸¸ç”¨çš„Java-API-åŠåº”ç”¨å®ä¾‹" class="headerlink" title="HBase å¸¸ç”¨çš„Java API åŠåº”ç”¨å®ä¾‹"></a>HBase å¸¸ç”¨çš„Java API åŠåº”ç”¨å®ä¾‹</h2>è‡ªè¡Œå­¦ä¹ ï¼Œç½‘ä¸Šèµ„æ–™å¾ˆå¤š<br>ä¸»è¦åŒ…æ‹¬ï¼šHBaseConfigurationã€HTableDescriptorã€HcolumnDescriptorã€Putã€Getã€ResultScannerã€Resulã€Scanã€‚<h2 id="HBaseçš„å®‰è£…"><a href="#HBaseçš„å®‰è£…" class="headerlink" title="HBaseçš„å®‰è£…"></a>HBaseçš„å®‰è£…</h2></li>
</ul>
</li>
<li><p>å¯ä»¥ä½¿ç”¨wgetå‘½ä»¤åœ¨<a href="http://archive.apache.org/dist/hbase/" target="_blank" rel="noopener">HBaseçš„å®˜ç½‘</a>ä¸‹è½½æƒ³è¦ä½¿ç”¨çš„ç‰ˆæœ¬</p>
</li>
<li>è§£å‹</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">sudo tar -zxf ~/ä¸‹è½½/hbase-2.2.2-bin.tar.gz -C /usr/<span class="built_in">local</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ›´æ”¹åç§°</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span></span><br><span class="line">sudo mv ./hbase-2.2.2 ./hbase</span><br></pre></td></tr></table></figure>
<ul>
<li>æ›´æ”¹æƒé™</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span></span><br><span class="line">sudo chown -R hadoop ./hbase</span><br></pre></td></tr></table></figure>
<ul>
<li>é…ç½®ç¯å¢ƒå˜é‡</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br><span class="line">//å¦‚æœæ²¡æœ‰å¼•å…¥è¿‡PATH ç›´æ¥æ·»åŠ ä¸‹é¢çš„ä»£ç ï¼Œå¦‚æœå¼•å…¥è¿‡ï¼Œå°±å°†è·¯å¾„æ·»åŠ åˆ°pathè·¯å¾„çš„åé¢å³å¯</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/hbase/bin</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œå‘½ä»¤ï¼Œè®©é…ç½®ç”Ÿæ•ˆ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<ul>
<li>æ·»åŠ HBaseçš„æƒé™</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span></span><br><span class="line">sudo chown -R hadoop ./hbase       <span class="comment">#å°†hbaseä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰è€…æ”¹ä¸ºhadoopï¼Œhadoopæ˜¯å½“å‰ç”¨æˆ·çš„ç”¨æˆ·åã€‚</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹ç‰ˆæœ¬ï¼Œç¡®ä¿å®‰è£…æˆåŠŸ</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/hbase/bin/hbase version</span><br></pre></td></tr></table></figure>
<h2 id="ä¼ªåˆ†å¸ƒå¼é…ç½®"><a href="#ä¼ªåˆ†å¸ƒå¼é…ç½®" class="headerlink" title="ä¼ªåˆ†å¸ƒå¼é…ç½®"></a>ä¼ªåˆ†å¸ƒå¼é…ç½®</h2><ul>
<li>é…ç½®/usr/local/hbase/conf/hbase-env.shã€‚å‘½ä»¤å¦‚ä¸‹</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/hbase/conf/hbase-env.sh</span><br></pre></td></tr></table></figure>
<p>é…ç½®JAVA_HOMEï¼ŒHBASE_CLASSPATHï¼ŒHBASE_MANAGES_ZK.<br>HBASE_CLASSPATHè®¾ç½®ä¸ºæœ¬æœºHBaseå®‰è£…ç›®å½•ä¸‹çš„confç›®å½•ï¼ˆå³/usr/local/hbase/confï¼‰</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/lib/jvm/jdk1.<span class="number">8.0</span>_162</span><br><span class="line">export HBASE_CLASSPATH=/usr/local/hbase/conf </span><br><span class="line">export HBASE_MANAGES_ZK=true</span><br></pre></td></tr></table></figure>
<ul>
<li>é…ç½®/usr/local/hbase/conf/hbase-site.xml<br>ç”¨å‘½ä»¤viæ‰“å¼€å¹¶ç¼–è¾‘hbase-site.xmlï¼Œå‘½ä»¤å¦‚ä¸‹</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/hbase/conf/hbase-site.xml</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹hbase.rootdirï¼ŒæŒ‡å®šHBaseæ•°æ®åœ¨HDFSä¸Šçš„å­˜å‚¨è·¯å¾„ï¼›å°†å±æ€§hbase.cluter.distributedè®¾ç½®ä¸ºtrueã€‚å‡è®¾å½“å‰Hadoopé›†ç¾¤è¿è¡Œåœ¨ä¼ªåˆ†å¸ƒå¼æ¨¡å¼ä¸‹ï¼Œåœ¨æœ¬æœºä¸Šè¿è¡Œï¼Œä¸”NameNodeè¿è¡Œåœ¨9000ç«¯å£</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">        &lt;property&gt;</span><br><span class="line">                &lt;name&gt;hbase.rootdir&lt;/name&gt;</span><br><span class="line">                &lt;value&gt;hdfs://localhost:<span class="number">9000</span>/hbase&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">        &lt;property&gt;</span><br><span class="line">                &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;</span><br><span class="line">                &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">        &lt;/property&gt;</span><br><span class="line">        &lt;property&gt;</span><br><span class="line">        &lt;name&gt;hbase.unsafe.stream.capability.enforce&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;false&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¥ä¸‹æ¥æµ‹è¯•è¿è¡ŒHBase<br>å¯åŠ¨hbaseçš„æ—¶å€™ä¸€å®šè¦ç¡®ä¿hadoopå·²ç»æˆåŠŸå¯åŠ¨</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hbase</span><br><span class="line">bin/start-hbase.sh</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸå®‰è£…é…ç½®å¥½ä¹‹åï¼Œä¸‹é¢å°±å¼€å§‹æˆ‘ä»¬åŸºæœ¬çš„å®éªŒå§</p>
<h2 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h2><h3 id="ç°æœ‰ä»¥ä¸‹å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨å’Œæ•°æ®ï¼Œè¦æ±‚å°†å…¶è½¬æ¢ä¸ºé€‚åˆäºHBaseå­˜å‚¨çš„è¡¨å¹¶æ’å…¥æ•°æ®ï¼š"><a href="#ç°æœ‰ä»¥ä¸‹å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨å’Œæ•°æ®ï¼Œè¦æ±‚å°†å…¶è½¬æ¢ä¸ºé€‚åˆäºHBaseå­˜å‚¨çš„è¡¨å¹¶æ’å…¥æ•°æ®ï¼š" class="headerlink" title="ç°æœ‰ä»¥ä¸‹å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨å’Œæ•°æ®ï¼Œè¦æ±‚å°†å…¶è½¬æ¢ä¸ºé€‚åˆäºHBaseå­˜å‚¨çš„è¡¨å¹¶æ’å…¥æ•°æ®ï¼š"></a>ç°æœ‰ä»¥ä¸‹å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨å’Œæ•°æ®ï¼Œè¦æ±‚å°†å…¶è½¬æ¢ä¸ºé€‚åˆäºHBaseå­˜å‚¨çš„è¡¨å¹¶æ’å…¥æ•°æ®ï¼š</h3><p>å­¦ç”Ÿè¡¨ï¼ˆStudentï¼‰<br>å­¦å·ï¼ˆS_Noï¼‰     | å§“åï¼ˆS_Name) |æ€§åˆ«ï¼ˆS_Sex)|å¹´é¾„ï¼ˆS_Ageï¼‰<br>â€”â€”â€“ | â€”â€“|â€”-|â€”-<br>2015001  | Zhangsan|male|23<br>2015002  | Mary|female|22<br>2015003  | Lisi |male|24<br>ä¸‹é¢å…ˆæ’å…¥s003 å­¦ç”Ÿçš„ä¿¡æ¯<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> hbase(main):<span class="number">008</span>:<span class="number">0</span>&gt;create <span class="string">'Student'</span>,<span class="string">'S_No'</span>,<span class="string">'S_Name'</span>,<span class="string">'S_Sex'</span>,<span class="string">'S_Age'</span></span><br><span class="line">hbase(main):<span class="number">029</span>:<span class="number">0</span>&gt; put <span class="string">'Student'</span>,<span class="string">'s003'</span>,<span class="string">'S_No'</span>,<span class="string">'2015003'</span></span><br><span class="line">Took <span class="number">0.0138</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">030</span>:<span class="number">0</span>&gt; put <span class="string">'Student'</span>,<span class="string">'s003'</span>,<span class="string">'S_Name'</span>,<span class="string">'Lisi'</span></span><br><span class="line">Took <span class="number">0.0118</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">031</span>:<span class="number">0</span>&gt; put <span class="string">'Student'</span>,<span class="string">'s003'</span>,<span class="string">'S_Sex'</span>,<span class="string">'male'</span></span><br><span class="line">Took <span class="number">0.0090</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">032</span>:<span class="number">0</span>&gt; put <span class="string">'Student'</span>,<span class="string">'s003'</span>,<span class="string">'S_Age'</span>,<span class="string">'24'</span></span><br></pre></td></tr></table></figure></p>
<p>è¯¾ç¨‹è¡¨ï¼ˆCourseï¼‰<br>è¯¾ç¨‹å·ï¼ˆC_Noï¼‰    | è¯¾ç¨‹åï¼ˆC_Nameï¼‰ |å­¦åˆ†ï¼ˆC_Creditï¼‰<br>â€”â€”â€“ | â€”â€“|â€”-|â€”-<br>123001  | Math|2.0<br>123002 | Computer Science|5.0<br>123003  |English|3.0</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):<span class="number">041</span>:<span class="number">0</span>&gt; create <span class="string">'Course'</span>,<span class="string">'C_No'</span>,<span class="string">'C_Name'</span>,<span class="string">'C_Credit'</span></span><br><span class="line">Created table Course</span><br><span class="line">Took <span class="number">1.3558</span> seconds                                                                                                                                                                                         </span><br><span class="line">=&gt; Hbase::Table - Course</span><br><span class="line">hbase(main):<span class="number">042</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'C001'</span>,<span class="string">'C_No'</span>,<span class="string">'2015001'</span></span><br><span class="line">Took <span class="number">0.0373</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">043</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'C001'</span>,<span class="string">'C_Name'</span>,<span class="string">'Math'</span></span><br><span class="line">Took <span class="number">0.0097</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">044</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'C001'</span>,<span class="string">'C_No'</span>,<span class="string">'123001'</span></span><br><span class="line">Took <span class="number">0.0060</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">045</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'C001'</span>,<span class="string">'C_Credit'</span>,<span class="string">'2.0'</span></span><br><span class="line">Took <span class="number">0.0093</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">046</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'c002'</span>,<span class="string">'C_No'</span>,<span class="string">'123002'</span></span><br><span class="line">Took <span class="number">0.0049</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">047</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'c002'</span>,<span class="string">'C_Name'</span>,<span class="string">'Computer'</span></span><br><span class="line">Took <span class="number">0.1125</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">048</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'c002'</span>,<span class="string">'C_Credit'</span>,<span class="string">'5.0'</span></span><br><span class="line">Took <span class="number">0.0107</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">049</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'c003'</span>,<span class="string">'C_No'</span>,<span class="string">'123003'</span></span><br><span class="line">Took <span class="number">0.0097</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">050</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'c003'</span>,<span class="string">'C_Name'</span>,<span class="string">'English'</span></span><br><span class="line">Took <span class="number">0.0060</span> seconds                                                                                                                                                                                         </span><br><span class="line">hbase(main):<span class="number">051</span>:<span class="number">0</span>&gt; put <span class="string">'Course'</span>,<span class="string">'c003'</span>,<span class="string">'C_Credit'</span>,<span class="string">'3.0'</span></span><br><span class="line">Took <span class="number">0.0089</span> seconds</span><br></pre></td></tr></table></figure>
<p>é€‰è¯¾è¡¨ï¼ˆSCï¼‰<br>å­¦å·ï¼ˆSC_Snoï¼‰    | è¯¾ç¨‹å·ï¼ˆSC_Cnoï¼‰ï¼‰|æˆç»©ï¼ˆSC_Scoreï¼‰<br>â€”â€”â€“ | â€”â€“|â€”-|â€”-<br>2015001  | 123001|86<br>2015001 | 123003|69<br>2015002  |123002|77<br>2015002  | 123003|99<br>2015003 | 123001|98<br>2015003  |123002|95</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create <span class="string">'SC'</span>,<span class="string">'SC_Sno'</span>,<span class="string">'SC_Cno'</span>,<span class="string">'SC_Score'</span></span><br><span class="line">Created table SC</span><br><span class="line">Took <span class="number">1.2786</span> seconds                                                                                                                                                                                         </span><br><span class="line">=&gt; Hbase::Table - SC</span><br><span class="line">hbase(main):<span class="number">053</span>:<span class="number">0</span>&gt; put <span class="string">'SC'</span>,<span class="string">'sc001'</span>,<span class="string">'SC_Sno'</span>,<span class="string">'2015001'</span></span><br><span class="line">NoMethodError: undefined method `ut<span class="string">' for main:Object</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">hbase(main):054:0&gt; put '</span>SC<span class="string">','</span>sc001<span class="string">','</span>SC_Sno<span class="string">','</span><span class="number">2015001</span><span class="string">'</span></span><br><span class="line"><span class="string">Took 0.0210 seconds                                                                                                                                                                                         </span></span><br><span class="line"><span class="string">hbase(main):055:0&gt; put '</span>SC<span class="string">','</span>sc001<span class="string">','</span>SC_Cno<span class="string">','</span><span class="number">123001</span><span class="string">'</span></span><br><span class="line"><span class="string">Took 0.0201 seconds                                                                                                                                                                                         </span></span><br><span class="line"><span class="string">hbase(main):056:0&gt; put '</span>SC<span class="string">','</span>sc001<span class="string">','</span>SC_Score<span class="string">','</span><span class="number">86</span><span class="string">'</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬çš„è¡¨è¿˜æœ‰æ•°æ®å°±å¡«å……å®Œäº†ï¼Œä¸Šé¢å› ä¸ºä¸€äº›æ•°æ®çš„å¡«å……çš„è¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤å°±å†™äº†ä¸€ä¸ªå®ä¾‹æ¥æ¼”ç¤ºä¸€ä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯<em>è¡¨æ ¼ä¸­æ¯ä¸€ä¸ªè¡Œçš„æ•°æ®ï¼Œéƒ½éœ€è¦ä¸ºä»–å¢åŠ ä¸€ä¸ªä¸»é”®ï¼Œä¹Ÿå°±æ˜¯è¯­å¥ä¸­çš„sc001çš„éƒ¨åˆ†ï¼Œå› ä¸ºhba seæ˜¯åˆ—å­˜å‚¨çš„ï¼Œè¿™ä¸ªç”¨æ¥è¡¨ç¤ºæ¯ä¸€è¡Œï¼Œå› æ­¤ï¼Œå¯¹åº”æ¯ä¸€è¡Œçš„æ—¶å€™ï¼Œè¿™ä¸ªå€¼è¦æœ‰æ‰€åŒºåˆ†</em></p>
<h3 id="ç¼–ç¨‹å®ç°ä»¥ä¸‹æŒ‡å®šåŠŸèƒ½ï¼Œå¹¶ç”¨Hadoopæä¾›çš„HBase-Shellå‘½ä»¤å®Œæˆç›¸åŒä»»åŠ¡ï¼š"><a href="#ç¼–ç¨‹å®ç°ä»¥ä¸‹æŒ‡å®šåŠŸèƒ½ï¼Œå¹¶ç”¨Hadoopæä¾›çš„HBase-Shellå‘½ä»¤å®Œæˆç›¸åŒä»»åŠ¡ï¼š" class="headerlink" title="ç¼–ç¨‹å®ç°ä»¥ä¸‹æŒ‡å®šåŠŸèƒ½ï¼Œå¹¶ç”¨Hadoopæä¾›çš„HBase Shellå‘½ä»¤å®Œæˆç›¸åŒä»»åŠ¡ï¼š"></a>ç¼–ç¨‹å®ç°ä»¥ä¸‹æŒ‡å®šåŠŸèƒ½ï¼Œå¹¶ç”¨Hadoopæä¾›çš„HBase Shellå‘½ä»¤å®Œæˆç›¸åŒä»»åŠ¡ï¼š</h3><ul>
<li>å…ˆæ˜¯shellå‘½ä»¤</li>
</ul>
<p>ï¼ˆ1ï¼‰åˆ—å‡ºHBaseæ‰€æœ‰çš„è¡¨çš„ç›¸å…³ä¿¡æ¯ï¼Œä¾‹å¦‚è¡¨åï¼›</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):<span class="number">073</span>:<span class="number">0</span>&gt; list</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰åœ¨ç»ˆç«¯æ‰“å°å‡ºæŒ‡å®šçš„è¡¨çš„æ‰€æœ‰è®°å½•æ•°æ®ï¼›</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan <span class="string">'Student'</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰å‘å·²ç»åˆ›å»ºå¥½çš„è¡¨æ·»åŠ å’Œåˆ é™¤æŒ‡å®šçš„åˆ—æ—æˆ–åˆ—ï¼›</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create <span class="string">'s1'</span>,<span class="string">'score'</span></span><br><span class="line">put <span class="string">'s1'</span>,<span class="string">'zhangsan'</span>,<span class="string">'score:math'</span>,<span class="string">'69'</span></span><br><span class="line">delete <span class="string">'s1'</span>,<span class="string">'zhangsan'</span>,<span class="string">'score:math'</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ4ï¼‰æ¸…ç©ºæŒ‡å®šçš„è¡¨çš„æ‰€æœ‰è®°å½•æ•°æ®ï¼›</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):<span class="number">078</span>:<span class="number">0</span>&gt; truncate <span class="string">'s1'</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ5ï¼‰ç»Ÿè®¡è¡¨çš„è¡Œæ•°ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hbase&gt; count <span class="string">'s1'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Javaå‘½ä»¤</li>
</ul>
<p>ä½¿ç”¨HBase Java APIè¿›è¡Œç¼–ç¨‹æ§åˆ¶<br>åœ¨è¿›è¡Œç¼–ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¿›è¡Œä¸€äº›å‰æœŸçš„å‡†å¤‡å·¥ä½œï¼Œå‡†å¤‡å¥½ç¼–ç¨‹éœ€è¦çš„ç¯å¢ƒã€‚<br>å½“æˆ‘ä»¬å»ºç«‹å¥½æ™®é€šçš„javaé¡¹ç›®ä¹‹åï¼Œé¦–å…ˆè¦è¿›è¡Œä¸€ä¸ªå¯¼åŒ…çš„æ“ä½œã€‚<br>(å¯¼åŒ…æ“ä½œä»¥åŠå»ºç«‹é¡¹ç›®çš„è¿‡ç¨‹ï¼Œä¸ä¼šçš„è‡ªè¡Œç™¾åº¦å­¦ä¹ )<br>æ‰€éœ€è¦çš„åŒ…ä½äº</p>
<p><1> è¿›å…¥åˆ°â€œ/usr/local/hbase/libâ€ç›®å½•ï¼Œé€‰ä¸­è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰jaræ–‡ä»¶ï¼ˆæ³¨æ„ï¼Œä¸è¦é€‰ä¸­client-facing-thirdpartyã€rubyã€shaded-clientså’Œzkcliè¿™å››ä¸ªç›®å½•ï¼‰</1></p>
<p><2>åœ¨â€œclient-facing-thirdpartyâ€ç›®å½•ä¸‹ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œé€‰ä¸­æ‰€æœ‰jaræ–‡ä»¶<br>ä¸Šé¢å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„å…¨éƒ¨çš„åŒ…äº†ã€‚</2></p>
<p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸‹ï¼Œå»ºç«‹ä¸€ä¸ªç±»å°±å¯ä»¥è¿›è¡Œç¼–ç¨‹äº†ã€‚<br>ä¸‹é¢æ˜¯ä¸Šé¢äº”ä¸ªå°å®éªŒçš„è¯¦ç»†ä»£ç  è®²è§£ï¼Œéœ€è¦æ‰§è¡Œå“ªä¸€ä¸ªè¿‡ç¨‹ï¼Œåœ¨mainå‡½æ•°ä¸­ï¼Œè°ƒç”¨å³å¯ã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test1;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleForHBase</span> </span>&#123;</span><br><span class="line">	<span class="comment">//é¦–å…ˆå®šä¹‰ä¸€ä¸ª ä¸æ•°æ®åº“è¿æ¥æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªè¿æ¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªæ“ä½œæ•°æ®åº“çš„å¯¹è±¡ã€‚ç®¡ç†å‘˜å¯ç”¨äºåˆ›å»ºï¼Œåˆ é™¤ï¼Œåˆ—å‡ºï¼Œå¯ç”¨å’Œç¦ç”¨ä»¥åŠä»¥å…¶ä»–æ–¹å¼ä¿®æ”¹è¡¨ä»¥åŠæ‰§è¡Œå…¶ä»–ç®¡ç†æ“ä½œã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        createTable(<span class="string">"student"</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"score"</span>&#125;);</span><br><span class="line">        insertData(<span class="string">"student"</span>,<span class="string">"zhangsan"</span>,<span class="string">"score"</span>,<span class="string">"English"</span>,<span class="string">"69"</span>);</span><br><span class="line">        insertData(<span class="string">"student"</span>,<span class="string">"zhangsan"</span>,<span class="string">"score"</span>,<span class="string">"Math"</span>,<span class="string">"86"</span>);</span><br><span class="line">        insertData(<span class="string">"student"</span>,<span class="string">"zhangsan"</span>,<span class="string">"score"</span>,<span class="string">"Computer"</span>,<span class="string">"77"</span>);</span><br><span class="line">        getData(<span class="string">"student"</span>, <span class="string">"zhangsan"</span>, <span class="string">"score"</span>,<span class="string">"English"</span>);</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//åˆå§‹åŒ– è¿æ¥æ•°æ®åº“æ‰€éœ€è¦çš„ é…ç½®æ–‡ä»¶ï¼Œè¿æ¥å¯¹è±¡ï¼Œä»¥åŠç®¡ç†å‘˜</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        configuration  = HBaseConfiguration.create();</span><br><span class="line">        configuration.set(<span class="string">"hbase.rootdir"</span>,<span class="string">"hdfs://0.0.0.0:8020/hbase"</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line">            admin = connection.getAdmin();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> <span class="comment">//è®¾ç½®æ•°æ®åº“è¿æ¥å®Œæˆä¹‹åçš„å…³é—­æ“ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(admin != <span class="keyword">null</span>)&#123;</span><br><span class="line">            	<span class="comment">//ç®¡ç†å‘˜æƒé™å…³é—­</span></span><br><span class="line">                admin.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> != connection)&#123;</span><br><span class="line">            	<span class="comment">//è¿æ¥å…³é—­</span></span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªé¢˜ åˆ—å‡ºHBaseæ‰€æœ‰çš„è¡¨çš„ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listTables</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        init();<span class="comment">//å»ºç«‹è¿æ¥</span></span><br><span class="line">        List&lt;TableDescriptor&gt; tableDescriptors = admin.listTableDescriptors();</span><br><span class="line">        <span class="keyword">for</span>(TableDescriptor tableDescriptor : tableDescriptors)&#123;</span><br><span class="line">            TableName tableName = tableDescriptor.getTableName();</span><br><span class="line">            System.out.println(<span class="string">"Table:"</span> + tableName);</span><br><span class="line">        &#125;</span><br><span class="line">        close();<span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¬¬äºŒé¢˜ åœ¨ç»ˆç«¯æ‰“å°å‡ºæŒ‡å®šçš„è¡¨çš„æ‰€æœ‰è®°å½•æ•°æ®</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment">//åœ¨ç»ˆç«¯æ‰“å°å‡ºæŒ‡å®šçš„è¡¨çš„æ‰€æœ‰è®°å½•æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getData</span><span class="params">(String tableName)</span><span class="keyword">throws</span>  IOException</span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        <span class="comment">//æ ¹æ®è¡¨å è·å¾—ä¸€ä¸ªè¡¨å¯¹è±¡</span></span><br><span class="line">        Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        <span class="comment">// è·å¾—ä¸€ä¸ªæŸ¥è¯¢è¡¨çš„æŸ¥è¯¢å¯¹è±¡</span></span><br><span class="line">        Scan scan = <span class="keyword">new</span> Scan();</span><br><span class="line">        <span class="comment">//ä½¿ç”¨æŸ¥è¯¢å¯¹è±¡ï¼Œè·å¾—æŸ¥è¯¢åˆ°çš„ç»“æœï¼ˆResultï¼‰é›†åˆ  ResultScanner</span></span><br><span class="line">        ResultScanner scanner = table.getScanner(scan);<span class="comment">//è·å–è¡Œçš„éå†å™¨</span></span><br><span class="line">        <span class="keyword">for</span> (Result result:scanner)&#123;</span><br><span class="line">        	<span class="comment">//å°†æ¯ä¸€æ¡Resultçš„ç»“æœ æ‰“å°è¾“å‡º</span></span><br><span class="line">            printRecoder(result);</span><br><span class="line">        &#125;</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ‰“å°ä¸€æ¡è®°å½•çš„è¯¦æƒ…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printRecoder</span><span class="params">(Result result)</span><span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">    	<span class="comment">//æ¯ä¸€ä¸ªåˆ—åˆåŒ…å«å¤šæ¡ä¿¡æ¯ ï¼Œå› æ­¤ éœ€è¦è¿­ä»£æ‰“å°è¾“å‡º </span></span><br><span class="line">        <span class="keyword">for</span>(Cell cell:result.rawCells())&#123;</span><br><span class="line">            System.out.print(<span class="string">"è¡Œå¥: "</span>+<span class="keyword">new</span> String(Bytes.toString(cell.getRowArray(),cell.getRowOffset(), cell.getRowLength())));</span><br><span class="line">            System.out.print(<span class="string">"åˆ—ç°‡: "</span>+<span class="keyword">new</span> String( Bytes.toString(cell.getFamilyArray(),cell.getFamilyOffset(), cell.getFamilyLength()) ));</span><br><span class="line">            System.out.print(<span class="string">" åˆ—: "</span>+<span class="keyword">new</span> String(Bytes.toString(cell.getQualifierArray(),cell.getQualifierOffset(), cell.getQualifierLength())));</span><br><span class="line">            System.out.print(<span class="string">" å€¼: "</span>+<span class="keyword">new</span> String(Bytes.toString(cell.getValueArray(),cell.getValueOffset(), cell.getValueLength())));</span><br><span class="line">            System.out.println(<span class="string">"æ—¶é—´æˆ³: "</span>+cell.getTimestamp());            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line"> <span class="comment">//ç¬¬ä¸‰é¢˜ å‘è¡¨ä¸­ æ·»åŠ æ•°æ® æ‰€éœ€è¦çš„å…³é”®å­— ä¸ shellçš„putè¯­å¥ æ˜¯å¯¹åº”çš„</span></span><br><span class="line">    <span class="comment">//colFamilyä»£è¡¨çš„æ˜¯åˆ—ç°‡ å¦‚æœåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆåº”è®¾ç½®colçš„å€¼ä¸ºâ€œâ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertData</span><span class="params">(String tableName,String rowKey,String colFamily,String col,String val)</span> <span class="keyword">throws</span> IOException </span>&#123; </span><br><span class="line">      init();</span><br><span class="line">      <span class="comment">//å»ºç«‹è¿æ¥ è·å–è¡¨</span></span><br><span class="line">    	Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">    	<span class="comment">//è¯­å¥æ‰§è¡Œ æ·»åŠ </span></span><br><span class="line">        Put put = <span class="keyword">new</span> Put(rowKey.getBytes());</span><br><span class="line">        put.addColumn(colFamily.getBytes(),col.getBytes(), val.getBytes());</span><br><span class="line">        table.put(put);</span><br><span class="line">        table.close(); </span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//åˆ é™¤æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleRow</span><span class="params">(String tableName,String rowKey,String colFamily,String col)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        Delete delete = <span class="keyword">new</span> Delete(rowKey.getBytes());</span><br><span class="line">        <span class="comment">//åˆ é™¤æŒ‡å®šåˆ—æ—</span></span><br><span class="line">        delete.addFamily(Bytes.toBytes(colFamily));</span><br><span class="line">        <span class="comment">//åˆ é™¤æŒ‡å®šåˆ—</span></span><br><span class="line">        delete.addColumn(Bytes.toBytes(colFamily),Bytes.toBytes(col));</span><br><span class="line">        table.delete(delete);</span><br><span class="line">        table.close();</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"> <span class="comment">//ç¬¬å››é¢˜ æ¸…ç©ºæŒ‡å®šçš„è¡¨çš„æ‰€æœ‰è®°å½•æ•°æ®ï¼›</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">clearRows</span><span class="params">(String tableName)</span><span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        TableName tablename = TableName.valueOf(tableName);</span><br><span class="line">        admin.disableTable(tablename);</span><br><span class="line">        admin.deleteTable(tablename);</span><br><span class="line">        TableDescriptorBuilder tableDescriptor = TableDescriptorBuilder.newBuilder(tablename);</span><br><span class="line">        admin.createTable(tableDescriptor.build());        </span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ç¬¬äº”é¢˜ ç»Ÿè®¡è¡¨çš„è¡Œæ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">countRows</span><span class="params">(String tableName)</span><span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        Scan scan = <span class="keyword">new</span> Scan();</span><br><span class="line">        ResultScanner scanner = table.getScanner(scan);</span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Result result = scanner.next();result!=<span class="keyword">null</span>;result=scanner.next())&#123;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"è¡Œæ•°:"</span>+ num);</span><br><span class="line">        scanner.close();</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åˆ›å»ºè¡¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createTable</span><span class="params">(String myTableName,String[] colFamily)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        TableName tableName = TableName.valueOf(myTableName);</span><br><span class="line">        <span class="keyword">if</span>(admin.tableExists(tableName))&#123;</span><br><span class="line">            System.out.println(<span class="string">"talbe is exists!"</span>);</span><br><span class="line">            <span class="comment">//åˆ é™¤åŸæ¥çš„è¡¨</span></span><br><span class="line">            admin.disableTable(tablename);</span><br><span class="line">            admin.deleteTable(tablename);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºæ–°çš„è¡¨</span></span><br><span class="line">            TableDescriptorBuilder tableDescriptor = TableDescriptorBuilder.newBuilder(tableName);</span><br><span class="line">            <span class="keyword">for</span>(String str:colFamily)&#123;</span><br><span class="line">                ColumnFamilyDescriptor family = </span><br><span class="line">ColumnFamilyDescriptorBuilder.newBuilder(Bytes.toBytes(str)).build();</span><br><span class="line">                tableDescriptor.setColumnFamily(family);</span><br><span class="line">            &#125;</span><br><span class="line">            admin.createTable(tableDescriptor.build());</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–è¡¨ä¸­çš„æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getData</span><span class="params">(String tableName,String rowKey,String colFamily, String col)</span><span class="keyword">throws</span>  IOException</span>&#123; </span><br><span class="line">        Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        Get get = <span class="keyword">new</span> Get(rowKey.getBytes());</span><br><span class="line">        get.addColumn(colFamily.getBytes(),col.getBytes());</span><br><span class="line">        Result result = table.get(get);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(result.getValue(colFamily.getBytes(),col==<span class="keyword">null</span>?<span class="keyword">null</span>:col.getBytes())));</span><br><span class="line">        table.close(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åŒæ—¶å®Œæˆï¼š<br>(1)createTable(String tableName, String[] fields)<br>åˆ›å»ºè¡¨ï¼Œå‚æ•°tableNameä¸ºè¡¨çš„åç§°ï¼Œå­—ç¬¦ä¸²æ•°ç»„fieldsä¸ºå­˜å‚¨è®°å½•å„ä¸ªåŸŸåç§°çš„æ•°ç»„ã€‚è¦æ±‚å½“HBaseå·²ç»å­˜åœ¨åä¸ºtableNameçš„è¡¨çš„æ—¶å€™ï¼Œå…ˆåˆ é™¤åŸæœ‰çš„è¡¨ï¼Œç„¶åå†åˆ›å»ºæ–°çš„è¡¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createTable</span><span class="params">(String myTableName,String[] colFamily)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        TableName tableName = TableName.valueOf(myTableName);</span><br><span class="line">        <span class="keyword">if</span>(admin.tableExists(tableName))&#123;</span><br><span class="line">            System.out.println(<span class="string">"talbe is exists!"</span>);</span><br><span class="line">            <span class="comment">//åˆ é™¤åŸæ¥çš„è¡¨</span></span><br><span class="line">            admin.disableTable(tablename);</span><br><span class="line">            admin.deleteTable(tablename);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºæ–°çš„è¡¨</span></span><br><span class="line">            TableDescriptorBuilder tableDescriptor = TableDescriptorBuilder.newBuilder(tableName);</span><br><span class="line">            <span class="keyword">for</span>(String str:colFamily)&#123;</span><br><span class="line">                ColumnFamilyDescriptor family = </span><br><span class="line">ColumnFamilyDescriptorBuilder.newBuilder(Bytes.toBytes(str)).build();</span><br><span class="line">                tableDescriptor.setColumnFamily(family);</span><br><span class="line">            &#125;</span><br><span class="line">            admin.createTable(tableDescriptor.build());</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>(2)addRecord(String tableName, String row, String[] fields, String[] values)<br>å‘è¡¨tableNameã€è¡Œrowï¼ˆç”¨S_Nameè¡¨ç¤ºï¼‰å’Œå­—ç¬¦ä¸²æ•°ç»„filesæŒ‡å®šçš„å•å…ƒæ ¼ä¸­æ·»åŠ å¯¹åº”çš„æ•°æ®valuesã€‚å…¶ä¸­fieldsä¸­æ¯ä¸ªå…ƒç´ å¦‚æœå¯¹åº”çš„åˆ—æ—ä¸‹è¿˜æœ‰ç›¸åº”çš„åˆ—é™å®šç¬¦çš„è¯ï¼Œç”¨â€œcolumnFamily:columnâ€è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼ŒåŒæ—¶å‘â€œMathâ€ã€â€œComputer Scienceâ€ã€â€œEnglishâ€ä¸‰åˆ—æ·»åŠ æˆç»©æ—¶ï¼Œå­—ç¬¦ä¸²æ•°ç»„fieldsä¸º{â€œScore:Mathâ€,â€Scoreï¼›Computer Scienceâ€,â€Score:Englishâ€}ï¼Œæ•°ç»„valueså­˜å‚¨è¿™ä¸‰é—¨è¯¾çš„æˆç»©ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addRecord</span><span class="params">(String tableName,String row,String[] fields,String[] values)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i != fields.length;i++)&#123;</span><br><span class="line">            Put put = <span class="keyword">new</span> Put(row.getBytes());</span><br><span class="line">            String[] cols = fields[i].split(<span class="string">":"</span>);</span><br><span class="line">            put.addColumn(cols[<span class="number">0</span>].getBytes(), cols[<span class="number">1</span>].getBytes(), values[i].getBytes());</span><br><span class="line">            table.put(put);</span><br><span class="line">        &#125;</span><br><span class="line">        table.close();</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>(3)scanColumn(String tableName, String column)<br>æµè§ˆè¡¨tableNameæŸä¸€åˆ—çš„æ•°æ®ï¼Œå¦‚æœæŸä¸€è¡Œè®°å½•ä¸­è¯¥åˆ—æ•°æ®ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›nullã€‚è¦æ±‚å½“å‚æ•°columnä¸ºæŸä¸€åˆ—æ—åç§°æ—¶ï¼Œå¦‚æœåº•ä¸‹æœ‰è‹¥å¹²ä¸ªåˆ—é™å®šç¬¦ï¼Œåˆ™è¦åˆ—å‡ºæ¯ä¸ªåˆ—é™å®šç¬¦ä»£è¡¨çš„åˆ—çš„æ•°æ®ï¼›å½“å‚æ•°columnä¸ºæŸä¸€åˆ—å…·ä½“åç§°ï¼ˆä¾‹å¦‚â€œScore:Mathâ€ï¼‰æ—¶ï¼Œåªéœ€è¦åˆ—å‡ºè¯¥åˆ—çš„æ•°æ®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">scanColumn</span><span class="params">(String tableName,String column)</span><span class="keyword">throws</span>  IOException</span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        Scan scan = <span class="keyword">new</span> Scan();</span><br><span class="line">        scan.addFamily(Bytes.toBytes(column));</span><br><span class="line">        ResultScanner scanner = table.getScanner(scan);</span><br><span class="line">        <span class="keyword">for</span> (Result result = scanner.next(); result != <span class="keyword">null</span>; result = scanner.next())&#123;</span><br><span class="line">            showCell(result);</span><br><span class="line">        &#125;</span><br><span class="line">        table.close();</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">showCell</span><span class="params">(Result result)</span></span>&#123;</span><br><span class="line">        Cell[] cells = result.rawCells();</span><br><span class="line">        <span class="keyword">for</span>(Cell cell:cells)&#123;</span><br><span class="line">            System.out.println(<span class="string">"RowName:"</span>+<span class="keyword">new</span> String(Bytes.toString(cell.getRowArray(),cell.getRowOffset(), cell.getRowLength()))+<span class="string">" "</span>);</span><br><span class="line">            System.out.println(<span class="string">"Timetamp:"</span>+cell.getTimestamp()+<span class="string">" "</span>);</span><br><span class="line">            System.out.println(<span class="string">"column Family:"</span>+<span class="keyword">new</span> String(Bytes.toString(cell.getFamilyArray(),cell.getFamilyOffset(), cell.getFamilyLength()))+<span class="string">" "</span>);</span><br><span class="line">            System.out.println(<span class="string">"row Name:"</span>+<span class="keyword">new</span> String(Bytes.toString(cell.getQualifierArray(),cell.getQualifierOffset(), cell.getQualifierLength()))+<span class="string">" "</span>);</span><br><span class="line">            System.out.println(<span class="string">"value:"</span>+<span class="keyword">new</span> String(Bytes.toString(cell.getValueArray(),cell.getValueOffset(), cell.getValueLength()))+<span class="string">" "</span>);           </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>(4)modifyData(String tableName, String row, String column)<br>ä¿®æ”¹è¡¨tableNameï¼Œè¡Œrowï¼ˆå¯ä»¥ç”¨å­¦ç”Ÿå§“åS_Nameè¡¨ç¤ºï¼‰ï¼Œåˆ—columnæŒ‡å®šçš„å•å…ƒæ ¼çš„æ•°æ®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">modifyData</span><span class="params">(String tableName,String row,String column,String val)</span><span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">    Put put = <span class="keyword">new</span> Put(row.getBytes());</span><br><span class="line">    put.addColumn(column.getBytes(),<span class="keyword">null</span>,val.getBytes());</span><br><span class="line">    table.put(put);</span><br><span class="line">    table.close();</span><br><span class="line">    close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>(5)deleteRow(String tableName, String row)<br>åˆ é™¤è¡¨tableNameä¸­rowæŒ‡å®šçš„è¡Œçš„è®°å½•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteRow</span><span class="params">(String tableName,String row)</span><span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        init();</span><br><span class="line">        Table table = connection.getTable(TableName.valueOf(tableName));</span><br><span class="line">        Delete delete = <span class="keyword">new</span> Delete(row.getBytes());        </span><br><span class="line">        table.delete(delete);</span><br><span class="line">        table.close();</span><br><span class="line">        close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/10/15/å¤§æ•°æ®-HBaseå®éªŒä»¥åŠè®²è§£/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="å¤§æ•°æ®-Hbaseå®éªŒä»¥åŠè®²è§£">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-æ—å­é›¨å¤§æ•°æ®-hdfså¸¸ç”¨çš„æ“ä½œï¼ˆå®éªŒæ“ä½œè¯¦ç»†è®°å½•ä¸è®²è§£ï¼‰" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/11/æ—å­é›¨å¤§æ•°æ®-hdfså¸¸ç”¨çš„æ“ä½œï¼ˆå®éªŒæ“ä½œè¯¦ç»†è®°å½•ä¸è®²è§£ï¼‰/" class="article-date">
  	<time datetime="2020-10-11T03:16:21.790Z" itemprop="datePublished">2020-10-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/11/æ—å­é›¨å¤§æ•°æ®-hdfså¸¸ç”¨çš„æ“ä½œï¼ˆå®éªŒæ“ä½œè¯¦ç»†è®°å½•ä¸è®²è§£ï¼‰/">
        æ—å­é›¨å¤§æ•°æ®-hdfså¸¸ç”¨çš„æ“ä½œï¼ˆå®éªŒæ“ä½œè¯¦ç»†è®°å½•ä¸è®²è§£ï¼‰
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ä¸€ã€å‘HDFSä¸­ä¸Šä¼ ä»»æ„æ–‡æœ¬æ–‡ä»¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶åœ¨HDFSä¸­å·²ç»å­˜åœ¨ï¼Œç”±ç”¨æˆ·æŒ‡å®šæ˜¯è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶æœ«å°¾è¿˜æ˜¯è¦†ç›–åŸæœ‰çš„æ–‡ä»¶ï¼›-ç”¨JAVAç¼–ç¨‹å®ç°ç›¸åŒåŠŸèƒ½"><a href="#ä¸€ã€å‘HDFSä¸­ä¸Šä¼ ä»»æ„æ–‡æœ¬æ–‡ä»¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶åœ¨HDFSä¸­å·²ç»å­˜åœ¨ï¼Œç”±ç”¨æˆ·æŒ‡å®šæ˜¯è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶æœ«å°¾è¿˜æ˜¯è¦†ç›–åŸæœ‰çš„æ–‡ä»¶ï¼›-ç”¨JAVAç¼–ç¨‹å®ç°ç›¸åŒåŠŸèƒ½" class="headerlink" title="ä¸€ã€å‘HDFSä¸­ä¸Šä¼ ä»»æ„æ–‡æœ¬æ–‡ä»¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶åœ¨HDFSä¸­å·²ç»å­˜åœ¨ï¼Œç”±ç”¨æˆ·æŒ‡å®šæ˜¯è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶æœ«å°¾è¿˜æ˜¯è¦†ç›–åŸæœ‰çš„æ–‡ä»¶ï¼›(ç”¨JAVAç¼–ç¨‹å®ç°ç›¸åŒåŠŸèƒ½)"></a>ä¸€ã€å‘HDFSä¸­ä¸Šä¼ ä»»æ„æ–‡æœ¬æ–‡ä»¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶åœ¨HDFSä¸­å·²ç»å­˜åœ¨ï¼Œç”±ç”¨æˆ·æŒ‡å®šæ˜¯è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶æœ«å°¾è¿˜æ˜¯è¦†ç›–åŸæœ‰çš„æ–‡ä»¶ï¼›(ç”¨JAVAç¼–ç¨‹å®ç°ç›¸åŒåŠŸèƒ½)</h2><ul>
<li>shellå‘½ä»¤<br>1.é¦–å…ˆï¼Œåœ¨æˆ‘æœ¬åœ°ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæœ¬åœ°æ–‡ä»¶local.txt<br>æˆ‘çš„æ–‡ä»¶è·¯å¾„æ˜¯ <em>/usr/local/hadoop/input$</em> </li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim local.txt</span><br></pre></td></tr></table></figure>
<p>2.æ£€æŸ¥è¦è¿½åŠ çš„åŸæœ‰æ–‡ä»¶æ˜¯å¦å·²ç»å­˜åœ¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//æ£€æŸ¥æ“ä½œ</span><br><span class="line">$./bin/hdfs dfs -<span class="built_in">test</span> -e text.txt</span><br><span class="line">//è¾“å‡ºæ£€æŸ¥åçš„ç»“æœ 1 è¡¨ç¤ºä¸å­˜åœ¨ 0 è¡¨ç¤ºå­˜åœ¨</span><br><span class="line"><span class="built_in">echo</span> $?</span><br></pre></td></tr></table></figure>
<p>3.æŒ‡å®šæ˜¯è¿›è¡Œè¿½åŠ è¿˜æ˜¯è¦†ç›–æ“ä½œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¸å­˜åœ¨æˆ‘ä»¬å°±æ‰§è¡Œå¤åˆ¶æ“ä½œ</span><br><span class="line">./bin/hdfs dfs -copyFromLocal -f ./input/local.txt test.txt</span><br><span class="line">å­˜åœ¨æˆ‘ä»¬å°±æ‰§è¡Œè¿½åŠ æ“ä½œ</span><br><span class="line">./bin/hdfs dfs -appendToFile ./input/local.txt text.txt</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬æŠŠä¸Šé¢çš„è¯­å¥æ•´åˆä¸€ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> $(./bin/hdfs dfs -<span class="built_in">test</span> -e test.txt);</span><br><span class="line">&gt; <span class="keyword">then</span> $(./bin/hdfs dfs -copyFromLocal -f ./input/local.txt test.txt);</span><br><span class="line">&gt; <span class="keyword">else</span> $(./bin/hdfs dfs -appendToFile ./input/local.txt test.txt);</span><br><span class="line">&gt; <span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<ul>
<li>javaç¼–ç¨‹</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test1;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyFromLocalHost</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(Configuration conf, String path)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        <span class="keyword">return</span> fs.exists(<span class="keyword">new</span> Path(path));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šè·¯å¾„</span></span><br><span class="line"><span class="comment">     * è‹¥è·¯å¾„å·²å­˜åœ¨ï¼Œåˆ™è¿›è¡Œè¦†ç›–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyFromLocalFile</span><span class="params">(Configuration conf, String localFilePath, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path localPath = <span class="keyword">new</span> Path(localFilePath);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        <span class="comment">/* fs.copyFromLocalFile ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦åˆ é™¤æºæ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦è¦†ç›– */</span></span><br><span class="line">        fs.copyFromLocalFile(<span class="keyword">false</span>, <span class="keyword">true</span>, localPath, remotePath);</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿½åŠ æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">appendToFile</span><span class="params">(Configuration conf, String localFilePath, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        <span class="comment">/* åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¯»å…¥æµ */</span></span><br><span class="line">        FileInputStream in = <span class="keyword">new</span> FileInputStream(localFilePath);</span><br><span class="line">        <span class="comment">/* åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¾“å‡ºæµï¼Œè¾“å‡ºçš„å†…å®¹å°†è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ */</span></span><br><span class="line">        FSDataOutputStream out = fs.append(remotePath);</span><br><span class="line">        <span class="comment">/* è¯»å†™æ–‡ä»¶å†…å®¹ */</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> read = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ( (read = in.read(data)) &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">            out.write(data, <span class="number">0</span>, read);</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        in.close();</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        <span class="comment">//åœ¨è¿™é‡Œè¾“å…¥åœ¨hdfsé…ç½®æ–‡ä»¶ä¸­é…ç½®çš„åœ°å€å³å¯ã€‚</span></span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String localFilePath = <span class="string">"/usr/local/hadoop/input/local.txt"</span>;    <span class="comment">// æœ¬åœ°è·¯å¾„</span></span><br><span class="line">        <span class="comment">//è¿™é‡Œçš„è·¯å¾„æ˜¯æˆ‘ä»¬ä¹‹å‰é…ç½®çš„hadoopçš„ç”¨æˆ·ç›®å½•</span></span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSè·¯å¾„</span></span><br><span class="line">        <span class="comment">//è¿™é‡Œé€‰æ‹©æ–‡ä»¶æ˜¯å¦è¦†ç›–è¿˜æ˜¯è¿½åŠ </span></span><br><span class="line">        String choice = <span class="string">"append"</span>;    <span class="comment">// è‹¥æ–‡ä»¶å­˜åœ¨åˆ™è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾</span></span><br><span class="line"><span class="comment">//      String choice = "overwrite";    // è‹¥æ–‡ä»¶å­˜åœ¨åˆ™è¦†ç›–</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ */</span></span><br><span class="line">            Boolean fileExists = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (CopyFromLocalHost.test(conf, remoteFilePath)) &#123;</span><br><span class="line">                fileExists = <span class="keyword">true</span>;</span><br><span class="line">                System.out.println(remoteFilePath + <span class="string">" å·²å­˜åœ¨."</span>);</span><br><span class="line">               <span class="comment">// choice = "overwrite";</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(remoteFilePath + <span class="string">" ä¸å­˜åœ¨."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* è¿›è¡Œå¤„ç† */</span></span><br><span class="line">            <span class="keyword">if</span> ( !fileExists) &#123; <span class="comment">// æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¸Šä¼ </span></span><br><span class="line">                CopyFromLocalHost.copyFromLocalFile(conf, localFilePath, remoteFilePath);</span><br><span class="line">                System.out.println(localFilePath + <span class="string">" å·²ä¸Šä¼ è‡³ "</span> + remoteFilePath);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( choice.equals(<span class="string">"overwrite"</span>) ) &#123;    <span class="comment">// é€‰æ‹©è¦†ç›–</span></span><br><span class="line">                CopyFromLocalHost.copyFromLocalFile(conf, localFilePath, remoteFilePath);</span><br><span class="line">                System.out.println(localFilePath + <span class="string">" å·²è¦†ç›– "</span> + remoteFilePath);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( choice.equals(<span class="string">"append"</span>) ) &#123;   <span class="comment">// é€‰æ‹©è¿½åŠ </span></span><br><span class="line">                CopyFromLocalHost.appendToFile(conf, localFilePath, remoteFilePath);</span><br><span class="line">                System.out.println(localFilePath + <span class="string">" å·²è¿½åŠ è‡³ "</span> + remoteFilePath);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘çš„hd f sæ˜¯æ­å»ºåœ¨é˜¿é‡Œäº‘ä¸Šçš„ï¼Œåœ¨äº‘ä¸Šæ²¡æœ‰å®‰è£…æˆåŠŸEclipse.æ‰€ä»¥å°±åœ¨æœ¬åœ°ç¼–å†™äº†ä»£ç ï¼Œä¸Šä¼ åˆ°äº‘ä¸Šæ‰§è¡Œçš„ï¼Œä¸‹é¢çš„æ‰§è¡Œäº†åŒæ ·çš„è¿‡ç¨‹ã€‚<br>æ›´æ–¹ä¾¿çš„æ“ä½œï¼Œç­‰æˆ‘å®Œå…¨ææ‡‚äº†ï¼Œå¦‚ä½•åœ¨æœ¬åœ°æ‰§è¡Œåˆ†å¸ƒå¼æˆ–è€…åœ¨äº‘ä¸Šå®‰è£…å¥½eclipseï¼Œåœ¨åšè®°å½•ã€‚<br>æ“ä½œæˆåŠŸåä¼šæ˜¾ç¤ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2020-10-10 16:33:06,050 INFO Configuration.deprecation: fs.default.name is deprecated. Instead, use fs.defaultFS</span><br><span class="line">/user/hadoop/text.txt ä¸å­˜åœ¨.</span><br><span class="line">2020-10-10 16:33:08,706 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">/usr/<span class="built_in">local</span>/hadoop/local.txt å·²ä¸Šä¼ è‡³ /user/hadoop/text.txt</span><br></pre></td></tr></table></figure>
<h2 id="äºŒã€-ä»HDFSä¸­ä¸‹è½½æŒ‡å®šæ–‡ä»¶ï¼Œå¦‚æœæœ¬åœ°æ–‡ä»¶ä¸è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ç›¸åŒï¼Œåˆ™è‡ªåŠ¨å¯¹ä¸‹è½½çš„æ–‡ä»¶é‡å‘½å"><a href="#äºŒã€-ä»HDFSä¸­ä¸‹è½½æŒ‡å®šæ–‡ä»¶ï¼Œå¦‚æœæœ¬åœ°æ–‡ä»¶ä¸è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ç›¸åŒï¼Œåˆ™è‡ªåŠ¨å¯¹ä¸‹è½½çš„æ–‡ä»¶é‡å‘½å" class="headerlink" title="äºŒã€ ä»HDFSä¸­ä¸‹è½½æŒ‡å®šæ–‡ä»¶ï¼Œå¦‚æœæœ¬åœ°æ–‡ä»¶ä¸è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ç›¸åŒï¼Œåˆ™è‡ªåŠ¨å¯¹ä¸‹è½½çš„æ–‡ä»¶é‡å‘½å"></a>äºŒã€ ä»HDFSä¸­ä¸‹è½½æŒ‡å®šæ–‡ä»¶ï¼Œå¦‚æœæœ¬åœ°æ–‡ä»¶ä¸è¦ä¸‹è½½çš„æ–‡ä»¶åç§°ç›¸åŒï¼Œåˆ™è‡ªåŠ¨å¯¹ä¸‹è½½çš„æ–‡ä»¶é‡å‘½å</h2><p>æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ä¸Šé¢ç”¨è¿‡çš„local.txt ä»¥åŠåœ¨h d f sä¸­çš„test.txtæ–‡ä»¶ã€‚</p>
<ul>
<li>Shellç¼–ç¨‹</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> $(./bin/hdfs dfs -<span class="built_in">test</span> -e file:/usr/<span class="built_in">local</span>/hadoop/input/text.txt); </span><br><span class="line"><span class="keyword">then</span> $(./bin/hdfs dfs -copyToLocal text.txt ./input/text2.txt); </span><br><span class="line"><span class="keyword">else</span> $(./bin/hdfs dfs -copyToLocal text.txt ./input/text.txt );</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<ul>
<li>javaç¼–ç¨‹</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyFromLocalHost</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­æœ¬åœ°è·¯å¾„æ˜¯å¦å·²å­˜åœ¨ï¼Œè‹¥å·²å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨è¿›è¡Œé‡å‘½å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copyToLocal</span><span class="params">(Configuration conf, String remoteFilePath, String localFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        File f = <span class="keyword">new</span> File(localFilePath);</span><br><span class="line">        <span class="comment">/* å¦‚æœæ–‡ä»¶åå­˜åœ¨ï¼Œè‡ªåŠ¨é‡å‘½å(åœ¨æ–‡ä»¶ååé¢åŠ ä¸Š _0, _1 ...) */</span></span><br><span class="line">        <span class="keyword">if</span> (f.exists()) &#123;</span><br><span class="line">            System.out.println(localFilePath + <span class="string">" å·²å­˜åœ¨."</span>);</span><br><span class="line">            Integer i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                f = <span class="keyword">new</span> File(localFilePath + <span class="string">"_"</span> + i.toString());</span><br><span class="line">                <span class="keyword">if</span> (!f.exists()) &#123;</span><br><span class="line">                    localFilePath = localFilePath + <span class="string">"_"</span> + i.toString();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">"å°†é‡æ–°å‘½åä¸º: "</span> + localFilePath);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°</span></span><br><span class="line">       Path localPath = <span class="keyword">new</span> Path(localFilePath);</span><br><span class="line">       fs.copyToLocalFile(remotePath, localPath);</span><br><span class="line">       fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String localFilePath = <span class="string">"/usr/local/hadoop/input/text.txt"</span>;    <span class="comment">// æœ¬åœ°è·¯å¾„</span></span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSè·¯å¾„</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            CopyFromLocalHost.copyToLocal(conf, remoteFilePath, localFilePath);</span><br><span class="line">            System.out.println(<span class="string">"ä¸‹è½½å®Œæˆ"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸæ‰§è¡Œåä¼šæ˜¾ç¤ºï¼ˆå› ä¸ºæˆ‘ä¸Šé¢å·²ç»æ‰§è¡Œè¿‡shellç¨‹åºäº†ï¼Œæ‰€ä»¥åœ¨æˆ‘æ“ä½œçš„æ–‡ä»¶å¤¹ä¸Šï¼Œå†…å®¹æ˜¯å·²ç»å­˜åœ¨äº†çš„ï¼Œå› æ­¤è¿›è¡Œé‡å‘½åæ“ä½œï¼‰</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2020</span>-<span class="number">10</span>-<span class="number">10</span> <span class="number">18</span>:<span class="number">46</span>:<span class="number">17</span>,<span class="number">802</span> INFO Configuration.deprecation: fs.default.name is deprecated. Instead, use fs.defaultFS</span><br><span class="line">/usr/local/hadoop/input/text.txt å·²å­˜åœ¨.</span><br><span class="line">å°†é‡æ–°å‘½åä¸º: /usr/local/hadoop/input/text.txt_0</span><br><span class="line"><span class="number">2020</span>-<span class="number">10</span>-<span class="number">10</span> <span class="number">18</span>:<span class="number">46</span>:<span class="number">21</span>,<span class="number">666</span> INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false</span><br><span class="line">ä¸‹è½½å®Œæˆ</span><br></pre></td></tr></table></figure>
<h2 id="ä¸‰ã€å°†HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„å†…å®¹è¾“å‡ºåˆ°ç»ˆç«¯ä¸­"><a href="#ä¸‰ã€å°†HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„å†…å®¹è¾“å‡ºåˆ°ç»ˆç«¯ä¸­" class="headerlink" title="ä¸‰ã€å°†HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„å†…å®¹è¾“å‡ºåˆ°ç»ˆç«¯ä¸­"></a>ä¸‰ã€å°†HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„å†…å®¹è¾“å‡ºåˆ°ç»ˆç«¯ä¸­</h2><p>æœ¬è´¨å°±æ˜¯æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p>
<ul>
<li><p>Shell</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -cat text.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>java</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyFromLocalHost</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cat</span><span class="params">(Configuration conf, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        FSDataInputStream in = fs.open(remotePath);</span><br><span class="line">        BufferedReader d = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line">        String line = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ( (line = d.readLine()) != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            System.out.println(line);</span><br><span class="line">        &#125;</span><br><span class="line">       d.close();</span><br><span class="line">       in.close();</span><br><span class="line">       fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSè·¯å¾„</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"è¯»å–æ–‡ä»¶: "</span> + remoteFilePath);</span><br><span class="line">            CopyFromLocalHost.cat(conf, remoteFilePath);</span><br><span class="line">            System.out.println(<span class="string">"\nè¯»å–å®Œæˆ"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯»å–æˆåŠŸåæ˜¾ç¤º</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2020</span>-<span class="number">10</span>-<span class="number">10</span> <span class="number">19</span>:<span class="number">14</span>:<span class="number">58</span>,<span class="number">684</span> INFO Configuration.deprecation: fs.default.name is deprecated. Instead, use fs.defaultFS</span><br><span class="line">è¯»å–æ–‡ä»¶: /user/hadoop/text.txt</span><br><span class="line"><span class="number">2020</span>-<span class="number">10</span>-<span class="number">10</span> <span class="number">19</span>:<span class="number">15</span>:<span class="number">01</span>,<span class="number">401</span> INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = false, remoteHostTrusted = false</span><br><span class="line">this  ssss</span><br><span class="line"></span><br><span class="line">è¯»å–å®Œæˆ</span><br></pre></td></tr></table></figure>
<h2 id="å››ã€æ˜¾ç¤ºHDFSä¸­æŒ‡å®šçš„æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯"><a href="#å››ã€æ˜¾ç¤ºHDFSä¸­æŒ‡å®šçš„æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯" class="headerlink" title="å››ã€æ˜¾ç¤ºHDFSä¸­æŒ‡å®šçš„æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯"></a>å››ã€æ˜¾ç¤ºHDFSä¸­æŒ‡å®šçš„æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯</h2><ul>
<li>shell</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -ls -h text.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyFromLocalHost</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ls</span><span class="params">(Configuration conf, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        FileStatus[] fileStatuses = fs.listStatus(remotePath);</span><br><span class="line">        <span class="keyword">for</span> (FileStatus s : fileStatuses) &#123;</span><br><span class="line">            System.out.println(<span class="string">"è·¯å¾„: "</span> + s.getPath().toString());</span><br><span class="line">            System.out.println(<span class="string">"æƒé™: "</span> + s.getPermission().toString());</span><br><span class="line">            System.out.println(<span class="string">"å¤§å°: "</span> + s.getLen());</span><br><span class="line">            <span class="comment">/* è¿”å›çš„æ˜¯æ—¶é—´æˆ³,è½¬åŒ–ä¸ºæ—¶é—´æ—¥æœŸæ ¼å¼ */</span></span><br><span class="line">            Long timeStamp = s.getModificationTime();</span><br><span class="line">            SimpleDateFormat format =  <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">            String date = format.format(timeStamp);  </span><br><span class="line">            System.out.println(<span class="string">"æ—¶é—´: "</span> + date);</span><br><span class="line">        &#125;</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSè·¯å¾„</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"è¯»å–æ–‡ä»¶ä¿¡æ¯: "</span> + remoteFilePath);</span><br><span class="line">            CopyFromLocalHost.ls(conf, remoteFilePath);</span><br><span class="line">            System.out.println(<span class="string">"\nè¯»å–å®Œæˆ"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“æœæ˜¾ç¤º</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¯»å–æ–‡ä»¶ä¿¡æ¯: /user/hadoop/text.txt</span><br><span class="line">è·¯å¾„: hdfs://0.0.0.0:8020/user/hadoop/text.txt</span><br><span class="line">æƒé™: rw-r--r--</span><br><span class="line">å¤§å°: 11</span><br><span class="line">æ—¶é—´: 2020-10-10 16:33:08</span><br><span class="line"></span><br><span class="line">è¯»å–å®Œæˆ</span><br></pre></td></tr></table></figure>
<h2 id="äº”ã€ç»™å®šHDFSä¸­æŸä¸€ä¸ªç›®å½•ï¼Œè¾“å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯ï¼Œå¦‚æœè¯¥æ–‡ä»¶æ˜¯ç›®å½•ï¼Œåˆ™é€’å½’è¾“å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ç›¸å…³ä¿¡æ¯"><a href="#äº”ã€ç»™å®šHDFSä¸­æŸä¸€ä¸ªç›®å½•ï¼Œè¾“å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯ï¼Œå¦‚æœè¯¥æ–‡ä»¶æ˜¯ç›®å½•ï¼Œåˆ™é€’å½’è¾“å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ç›¸å…³ä¿¡æ¯" class="headerlink" title="äº”ã€ç»™å®šHDFSä¸­æŸä¸€ä¸ªç›®å½•ï¼Œè¾“å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯ï¼Œå¦‚æœè¯¥æ–‡ä»¶æ˜¯ç›®å½•ï¼Œåˆ™é€’å½’è¾“å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ç›¸å…³ä¿¡æ¯"></a>äº”ã€ç»™å®šHDFSä¸­æŸä¸€ä¸ªç›®å½•ï¼Œè¾“å‡ºè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„è¯»å†™æƒé™ã€å¤§å°ã€åˆ›å»ºæ—¶é—´ã€è·¯å¾„ç­‰ä¿¡æ¯ï¼Œå¦‚æœè¯¥æ–‡ä»¶æ˜¯ç›®å½•ï¼Œåˆ™é€’å½’è¾“å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ç›¸å…³ä¿¡æ¯</h2><ul>
<li>shell</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/hdfs dfs -ls -R -h</span><br></pre></td></tr></table></figure>
<ul>
<li>java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyFromLocalHost</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶çš„ä¿¡æ¯ï¼ˆé€’å½’ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">lsDir</span><span class="params">(Configuration conf, String remoteDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path dirPath = <span class="keyword">new</span> Path(remoteDir);</span><br><span class="line">        <span class="comment">/* é€’å½’è·å–ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ */</span></span><br><span class="line">        RemoteIterator&lt;LocatedFileStatus&gt; remoteIterator = fs.listFiles(dirPath, <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">/* è¾“å‡ºæ¯ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ */</span></span><br><span class="line">        <span class="keyword">while</span> (remoteIterator.hasNext()) &#123;</span><br><span class="line">            FileStatus s = remoteIterator.next();</span><br><span class="line">            System.out.println(<span class="string">"è·¯å¾„: "</span> + s.getPath().toString());</span><br><span class="line">            System.out.println(<span class="string">"æƒé™: "</span> + s.getPermission().toString());</span><br><span class="line">            System.out.println(<span class="string">"å¤§å°: "</span> + s.getLen());</span><br><span class="line">            <span class="comment">/* è¿”å›çš„æ˜¯æ—¶é—´æˆ³,è½¬åŒ–ä¸ºæ—¶é—´æ—¥æœŸæ ¼å¼ */</span></span><br><span class="line">            Long timeStamp = s.getModificationTime();</span><br><span class="line">            SimpleDateFormat format =  <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">            String date = format.format(timeStamp);  </span><br><span class="line">            System.out.println(<span class="string">"æ—¶é—´: "</span> + date);</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;    </span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteDir = <span class="string">"/user/hadoop"</span>;    <span class="comment">// HDFSè·¯å¾„</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"(é€’å½’)è¯»å–ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„ä¿¡æ¯: "</span> + remoteDir);</span><br><span class="line">            CopyFromLocalHost.lsDir(conf, remoteDir);</span><br><span class="line">            System.out.println(<span class="string">"è¯»å–å®Œæˆ"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å…­ã€æä¾›ä¸€ä¸ªHDFSå†…çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯¹è¯¥æ–‡ä»¶è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚å¦‚æœæ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºç›®å½•"><a href="#å…­ã€æä¾›ä¸€ä¸ªHDFSå†…çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯¹è¯¥æ–‡ä»¶è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚å¦‚æœæ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºç›®å½•" class="headerlink" title="å…­ã€æä¾›ä¸€ä¸ªHDFSå†…çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯¹è¯¥æ–‡ä»¶è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚å¦‚æœæ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºç›®å½•"></a>å…­ã€æä¾›ä¸€ä¸ªHDFSå†…çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œå¯¹è¯¥æ–‡ä»¶è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚å¦‚æœæ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºç›®å½•</h2><ul>
<li>shell</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> $(hdfs dfs -test -d dir1/dir2);</span><br><span class="line">then $(hdfs dfs -touchz dir1/dir2/filename); </span><br><span class="line"><span class="keyword">else</span> $(hdfs dfs -mkdir -p dir1/dir2 &amp;&amp; hdfs dfs -touchz dir1/dir2/filename); </span><br><span class="line">fi</span><br><span class="line">hdfs dfs -rm dir1/dir2/filename   <span class="comment">#åˆ é™¤æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>
<ul>
<li>java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HDFSApi</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(Configuration conf, String path)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        <span class="keyword">return</span> fs.exists(<span class="keyword">new</span> Path(path));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">mkdir</span><span class="params">(Configuration conf, String remoteDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path dirPath = <span class="keyword">new</span> Path(remoteDir);</span><br><span class="line">        <span class="keyword">boolean</span> result = fs.mkdirs(dirPath);</span><br><span class="line">        fs.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">touchz</span><span class="params">(Configuration conf, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        FSDataOutputStream outputStream = fs.create(remotePath);</span><br><span class="line">        outputStream.close();</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">rm</span><span class="params">(Configuration conf, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        <span class="keyword">boolean</span> result = fs.delete(remotePath, <span class="keyword">false</span>);</span><br><span class="line">        fs.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/input/text.txt"</span>;    <span class="comment">// HDFSè·¯å¾„</span></span><br><span class="line">        String remoteDir = <span class="string">"/user/hadoop/input"</span>;    <span class="comment">// HDFSè·¯å¾„å¯¹åº”çš„ç›®å½•</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™åˆ é™¤ï¼Œå¦åˆ™è¿›è¡Œåˆ›å»º */</span></span><br><span class="line">            <span class="keyword">if</span> ( HDFSApi.test(conf, remoteFilePath) ) &#123;</span><br><span class="line">                HDFSApi.rm(conf, remoteFilePath); <span class="comment">// åˆ é™¤</span></span><br><span class="line">                System.out.println(<span class="string">"åˆ é™¤è·¯å¾„: "</span> + remoteFilePath);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> ( !HDFSApi.test(conf, remoteDir) ) &#123; <span class="comment">// è‹¥ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™è¿›è¡Œåˆ›å»º</span></span><br><span class="line">                    HDFSApi.mkdir(conf, remoteDir);</span><br><span class="line">                    System.out.println(<span class="string">"åˆ›å»ºæ–‡ä»¶å¤¹: "</span> + remoteDir);</span><br><span class="line">                &#125;</span><br><span class="line">                HDFSApi.touchz(conf, remoteFilePath);</span><br><span class="line">                System.out.println(<span class="string">"åˆ›å»ºè·¯å¾„: "</span> + remoteFilePath);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ƒã€æä¾›ä¸€ä¸ªHDFSçš„ç›®å½•çš„è·¯å¾„ï¼Œå¯¹è¯¥ç›®å½•è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚åˆ›å»ºç›®å½•æ—¶ï¼Œå¦‚æœç›®å½•æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºç›¸åº”ç›®å½•ï¼›åˆ é™¤ç›®å½•æ—¶ï¼Œç”±ç”¨æˆ·æŒ‡å®šå½“è¯¥ç›®å½•ä¸ä¸ºç©ºæ—¶æ˜¯å¦è¿˜åˆ é™¤è¯¥ç›®å½•"><a href="#ä¸ƒã€æä¾›ä¸€ä¸ªHDFSçš„ç›®å½•çš„è·¯å¾„ï¼Œå¯¹è¯¥ç›®å½•è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚åˆ›å»ºç›®å½•æ—¶ï¼Œå¦‚æœç›®å½•æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºç›¸åº”ç›®å½•ï¼›åˆ é™¤ç›®å½•æ—¶ï¼Œç”±ç”¨æˆ·æŒ‡å®šå½“è¯¥ç›®å½•ä¸ä¸ºç©ºæ—¶æ˜¯å¦è¿˜åˆ é™¤è¯¥ç›®å½•" class="headerlink" title="ä¸ƒã€æä¾›ä¸€ä¸ªHDFSçš„ç›®å½•çš„è·¯å¾„ï¼Œå¯¹è¯¥ç›®å½•è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚åˆ›å»ºç›®å½•æ—¶ï¼Œå¦‚æœç›®å½•æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºç›¸åº”ç›®å½•ï¼›åˆ é™¤ç›®å½•æ—¶ï¼Œç”±ç”¨æˆ·æŒ‡å®šå½“è¯¥ç›®å½•ä¸ä¸ºç©ºæ—¶æ˜¯å¦è¿˜åˆ é™¤è¯¥ç›®å½•"></a>ä¸ƒã€æä¾›ä¸€ä¸ªHDFSçš„ç›®å½•çš„è·¯å¾„ï¼Œå¯¹è¯¥ç›®å½•è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚åˆ›å»ºç›®å½•æ—¶ï¼Œå¦‚æœç›®å½•æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºç›¸åº”ç›®å½•ï¼›åˆ é™¤ç›®å½•æ—¶ï¼Œç”±ç”¨æˆ·æŒ‡å®šå½“è¯¥ç›®å½•ä¸ä¸ºç©ºæ—¶æ˜¯å¦è¿˜åˆ é™¤è¯¥ç›®å½•</h2><ul>
<li>Shell</li>
</ul>
<p>åˆ›å»ºç›®å½•çš„æ“ä½œ<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir -p dir1/dir2</span><br></pre></td></tr></table></figure></p>
<p>åˆ é™¤ç›®å½•çš„æ“ä½œ</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -rmdir dir1/dir2</span><br></pre></td></tr></table></figure>
<p>ç›®å½•ä¸ä¸ºç©ºæ—¶å€™çš„åˆ é™¤æ“ä½œ</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -rm -R dir1/dir2</span><br></pre></td></tr></table></figure>
<ul>
<li>javaå®ç°</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HDFSApi</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(Configuration conf, String path)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        <span class="keyword">return</span> fs.exists(<span class="keyword">new</span> Path(path));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­ç›®å½•æ˜¯å¦ä¸ºç©º</span></span><br><span class="line"><span class="comment">     * true: ç©ºï¼Œfalse: éç©º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isDirEmpty</span><span class="params">(Configuration conf, String remoteDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path dirPath = <span class="keyword">new</span> Path(remoteDir);</span><br><span class="line">        RemoteIterator&lt;LocatedFileStatus&gt; remoteIterator = fs.listFiles(dirPath, <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> !remoteIterator.hasNext();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">mkdir</span><span class="params">(Configuration conf, String remoteDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path dirPath = <span class="keyword">new</span> Path(remoteDir);</span><br><span class="line">        <span class="keyword">boolean</span> result = fs.mkdirs(dirPath);</span><br><span class="line">        fs.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ç›®å½•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">rmDir</span><span class="params">(Configuration conf, String remoteDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path dirPath = <span class="keyword">new</span> Path(remoteDir);</span><br><span class="line">        <span class="comment">/* ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦é€’å½’åˆ é™¤æ‰€æœ‰æ–‡ä»¶ */</span></span><br><span class="line">        <span class="keyword">boolean</span> result = fs.delete(dirPath, <span class="keyword">true</span>);</span><br><span class="line">        fs.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteDir = <span class="string">"/user/hadoop/input"</span>;    <span class="comment">// HDFSç›®å½•</span></span><br><span class="line">        Boolean forceDelete = <span class="keyword">false</span>;  <span class="comment">// æ˜¯å¦å¼ºåˆ¶åˆ é™¤</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™åˆ é™¤ */</span></span><br><span class="line">            <span class="keyword">if</span> ( !HDFSApi.test(conf, remoteDir) ) &#123;</span><br><span class="line">                HDFSApi.mkdir(conf, remoteDir); <span class="comment">// åˆ›å»ºç›®å½•</span></span><br><span class="line">                System.out.println(<span class="string">"åˆ›å»ºç›®å½•: "</span> + remoteDir);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> ( HDFSApi.isDirEmpty(conf, remoteDir) || forceDelete ) &#123; <span class="comment">// ç›®å½•ä¸ºç©ºæˆ–å¼ºåˆ¶åˆ é™¤</span></span><br><span class="line">                    HDFSApi.rmDir(conf, remoteDir);</span><br><span class="line">                    System.out.println(<span class="string">"åˆ é™¤ç›®å½•: "</span> + remoteDir);</span><br><span class="line">                &#125; <span class="keyword">else</span>  &#123; <span class="comment">// ç›®å½•ä¸ä¸ºç©º</span></span><br><span class="line">                    System.out.println(<span class="string">"ç›®å½•ä¸ä¸ºç©ºï¼Œä¸åˆ é™¤: "</span> + remoteDir);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å…«ã€å‘HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶è¿½åŠ å†…å®¹ï¼Œç”±ç”¨æˆ·æŒ‡å®šå†…å®¹è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶çš„å¼€å¤´æˆ–ç»“å°¾"><a href="#å…«ã€å‘HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶è¿½åŠ å†…å®¹ï¼Œç”±ç”¨æˆ·æŒ‡å®šå†…å®¹è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶çš„å¼€å¤´æˆ–ç»“å°¾" class="headerlink" title="å…«ã€å‘HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶è¿½åŠ å†…å®¹ï¼Œç”±ç”¨æˆ·æŒ‡å®šå†…å®¹è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶çš„å¼€å¤´æˆ–ç»“å°¾"></a>å…«ã€å‘HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶è¿½åŠ å†…å®¹ï¼Œç”±ç”¨æˆ·æŒ‡å®šå†…å®¹è¿½åŠ åˆ°åŸæœ‰æ–‡ä»¶çš„å¼€å¤´æˆ–ç»“å°¾</h2><ul>
<li>shell</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -appendToFile local.txt text.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -get text.txt</span><br><span class="line">cat text.txt &gt;&gt; local.txt</span><br><span class="line">hdfs dfs -copyFromLocal -f text.txt text.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HDFSApi</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­è·¯å¾„æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(Configuration conf, String path)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        <span class="keyword">return</span> fs.exists(<span class="keyword">new</span> Path(path));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿½åŠ æ–‡æœ¬å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">appendContentToFile</span><span class="params">(Configuration conf, String content, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        <span class="comment">/* åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¾“å‡ºæµï¼Œè¾“å‡ºçš„å†…å®¹å°†è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ */</span></span><br><span class="line">        FSDataOutputStream out = fs.append(remotePath);</span><br><span class="line">        out.write(content.getBytes());</span><br><span class="line">        out.close();</span><br><span class="line">        fs.close();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿½åŠ æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">appendToFile</span><span class="params">(Configuration conf, String localFilePath, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        <span class="comment">/* åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¯»å…¥æµ */</span></span><br><span class="line">        FileInputStream in = <span class="keyword">new</span> FileInputStream(localFilePath);</span><br><span class="line">        <span class="comment">/* åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¾“å‡ºæµï¼Œè¾“å‡ºçš„å†…å®¹å°†è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾ */</span></span><br><span class="line">        FSDataOutputStream out = fs.append(remotePath);</span><br><span class="line">        <span class="comment">/* è¯»å†™æ–‡ä»¶å†…å®¹ */</span></span><br><span class="line">        <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> read = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ( (read = in.read(data)) &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">            out.write(data, <span class="number">0</span>, read);</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        in.close();</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»åŠ¨æ–‡ä»¶åˆ°æœ¬åœ°</span></span><br><span class="line"><span class="comment">     * ç§»åŠ¨åï¼Œåˆ é™¤æºæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">moveToLocalFile</span><span class="params">(Configuration conf, String remoteFilePath, String localFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        Path localPath = <span class="keyword">new</span> Path(localFilePath);</span><br><span class="line">        fs.moveToLocalFile(remotePath, localPath);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">touchz</span><span class="params">(Configuration conf, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        FSDataOutputStream outputStream = fs.create(remotePath);</span><br><span class="line">        outputStream.close();</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSæ–‡ä»¶</span></span><br><span class="line">        String content = <span class="string">"æ–°è¿½åŠ çš„å†…å®¹\n"</span>;</span><br><span class="line">        String choice = <span class="string">"after"</span>;        <span class="comment">//è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾</span></span><br><span class="line"><span class="comment">//      String choice = "before";    // è¿½åŠ åˆ°æ–‡ä»¶å¼€å¤´</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">/* åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ */</span></span><br><span class="line">            <span class="keyword">if</span> ( !HDFSApi.test(conf, remoteFilePath) ) &#123;</span><br><span class="line">                System.out.println(<span class="string">"æ–‡ä»¶ä¸å­˜åœ¨: "</span> + remoteFilePath);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> ( choice.equals(<span class="string">"after"</span>) ) &#123; <span class="comment">// è¿½åŠ åœ¨æ–‡ä»¶æœ«å°¾</span></span><br><span class="line">                    HDFSApi.appendContentToFile(conf, content, remoteFilePath);</span><br><span class="line">                    System.out.println(<span class="string">"å·²è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶æœ«å°¾"</span> + remoteFilePath);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( choice.equals(<span class="string">"before"</span>) )  &#123; <span class="comment">// è¿½åŠ åˆ°æ–‡ä»¶å¼€å¤´</span></span><br><span class="line">                    <span class="comment">/* æ²¡æœ‰ç›¸åº”çš„apiå¯ä»¥ç›´æ¥æ“ä½œï¼Œå› æ­¤å…ˆæŠŠæ–‡ä»¶ç§»åŠ¨åˆ°æœ¬åœ°*/</span></span><br><span class="line"><span class="comment">/*åˆ›å»ºä¸€ä¸ªæ–°çš„HDFSï¼Œå†æŒ‰é¡ºåºè¿½åŠ å†…å®¹ */</span></span><br><span class="line">                    String localTmpPath = <span class="string">"/user/hadoop/tmp.txt"</span>;</span><br><span class="line">                    <span class="comment">// ç§»åŠ¨åˆ°æœ¬åœ°</span></span><br><span class="line">HDFSApi.moveToLocalFile(conf, remoteFilePath, localTmpPath);</span><br><span class="line">   <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶</span></span><br><span class="line">                    HDFSApi.touchz(conf, remoteFilePath); </span><br><span class="line">                    <span class="comment">// å…ˆå†™å…¥æ–°å†…å®¹</span></span><br><span class="line">                    HDFSApi.appendContentToFile(conf, content, remoteFilePath);</span><br><span class="line">                    <span class="comment">// å†å†™å…¥åŸæ¥å†…å®¹</span></span><br><span class="line">                    HDFSApi.appendToFile(conf, localTmpPath, remoteFilePath); </span><br><span class="line">                    System.out.println(<span class="string">"å·²è¿½åŠ å†…å®¹åˆ°æ–‡ä»¶å¼€å¤´: "</span> + remoteFilePath);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¹ã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶"><a href="#ä¹ã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶" class="headerlink" title="ä¹ã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶"></a>ä¹ã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„æ–‡ä»¶</h2><ul>
<li>shell</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -rm text.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HDFSApi</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">rm</span><span class="params">(Configuration conf, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        <span class="keyword">boolean</span> result = fs.delete(remotePath, <span class="keyword">false</span>);</span><br><span class="line">        fs.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSæ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> ( HDFSApi.rm(conf, remoteFilePath) ) &#123;</span><br><span class="line">                System.out.println(<span class="string">"æ–‡ä»¶åˆ é™¤: "</span> + remoteFilePath);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"æ“ä½œå¤±è´¥ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨æˆ–åˆ é™¤å¤±è´¥ï¼‰"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„ç›®å½•ï¼Œç”±ç”¨æˆ·æŒ‡å®šç›®å½•ä¸­å¦‚æœå­˜åœ¨æ–‡ä»¶æ—¶æ˜¯å¦åˆ é™¤ç›®å½•"><a href="#åã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„ç›®å½•ï¼Œç”±ç”¨æˆ·æŒ‡å®šç›®å½•ä¸­å¦‚æœå­˜åœ¨æ–‡ä»¶æ—¶æ˜¯å¦åˆ é™¤ç›®å½•" class="headerlink" title="åã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„ç›®å½•ï¼Œç”±ç”¨æˆ·æŒ‡å®šç›®å½•ä¸­å¦‚æœå­˜åœ¨æ–‡ä»¶æ—¶æ˜¯å¦åˆ é™¤ç›®å½•"></a>åã€åˆ é™¤HDFSä¸­æŒ‡å®šçš„ç›®å½•ï¼Œç”±ç”¨æˆ·æŒ‡å®šç›®å½•ä¸­å¦‚æœå­˜åœ¨æ–‡ä»¶æ—¶æ˜¯å¦åˆ é™¤ç›®å½•</h2><p>è§ç¬¬7ä¸ªå®éªŒ</p>
<h2 id="åä¸€ã€åœ¨HDFSä¸­ï¼Œå°†æ–‡ä»¶ä»æºè·¯å¾„ç§»åŠ¨åˆ°ç›®çš„è·¯å¾„"><a href="#åä¸€ã€åœ¨HDFSä¸­ï¼Œå°†æ–‡ä»¶ä»æºè·¯å¾„ç§»åŠ¨åˆ°ç›®çš„è·¯å¾„" class="headerlink" title="åä¸€ã€åœ¨HDFSä¸­ï¼Œå°†æ–‡ä»¶ä»æºè·¯å¾„ç§»åŠ¨åˆ°ç›®çš„è·¯å¾„"></a>åä¸€ã€åœ¨HDFSä¸­ï¼Œå°†æ–‡ä»¶ä»æºè·¯å¾„ç§»åŠ¨åˆ°ç›®çš„è·¯å¾„</h2><ul>
<li>shell</li>
</ul>
<p>text.txt æ˜¯æºè·¯å¾„ï¼Œtext2.txtæ‰€åœ¨çš„ä½ç½®æ˜¯ç›®çš„è·¯å¾„æ‰€åœ¨çš„ä½ç½®<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mv text.txt text2.txt</span><br></pre></td></tr></table></figure></p>
<ul>
<li>java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HDFSApi</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»åŠ¨æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">mv</span><span class="params">(Configuration conf, String remoteFilePath, String remoteToFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path srcPath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        Path dstPath = <span class="keyword">new</span> Path(remoteToFilePath);</span><br><span class="line">        <span class="keyword">boolean</span> result = fs.rename(srcPath, dstPath);</span><br><span class="line">        fs.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteFilePath = <span class="string">"hdfs:///user/hadoop/text.txt"</span>;    <span class="comment">// æºæ–‡ä»¶HDFSè·¯å¾„</span></span><br><span class="line">        String remoteToFilePath = <span class="string">"hdfs:///user/hadoop/new.txt"</span>;    <span class="comment">// ç›®çš„HDFSè·¯å¾„</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> ( HDFSApi.mv(conf, remoteFilePath, remoteToFilePath) ) &#123;</span><br><span class="line">                System.out.println(<span class="string">"å°†æ–‡ä»¶ "</span> + remoteFilePath + <span class="string">" ç§»åŠ¨åˆ° "</span> + remoteToFilePath);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">"æ“ä½œå¤±è´¥(æºæ–‡ä»¶ä¸å­˜åœ¨æˆ–ç§»åŠ¨å¤±è´¥)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç¼–ç¨‹å®ç°ä¸€ä¸ªç±»â€œMyFSDataInputStreamâ€ï¼Œè¯¥ç±»ç»§æ‰¿â€œorg-apache-hadoop-fs-FSDataInputStreamâ€ï¼Œè¦æ±‚å¦‚ä¸‹ï¼šå®ç°æŒ‰è¡Œè¯»å–HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–¹æ³•â€œreadLine-â€ï¼Œå¦‚æœè¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼Œåˆ™è¿”å›ç©ºï¼Œå¦åˆ™è¿”å›æ–‡ä»¶ä¸€è¡Œçš„æ–‡æœ¬ã€‚æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava-net-URLâ€å’Œâ€œorg-apache-hadoop-fs-FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­"><a href="#ç¼–ç¨‹å®ç°ä¸€ä¸ªç±»â€œMyFSDataInputStreamâ€ï¼Œè¯¥ç±»ç»§æ‰¿â€œorg-apache-hadoop-fs-FSDataInputStreamâ€ï¼Œè¦æ±‚å¦‚ä¸‹ï¼šå®ç°æŒ‰è¡Œè¯»å–HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–¹æ³•â€œreadLine-â€ï¼Œå¦‚æœè¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼Œåˆ™è¿”å›ç©ºï¼Œå¦åˆ™è¿”å›æ–‡ä»¶ä¸€è¡Œçš„æ–‡æœ¬ã€‚æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava-net-URLâ€å’Œâ€œorg-apache-hadoop-fs-FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­" class="headerlink" title="ç¼–ç¨‹å®ç°ä¸€ä¸ªç±»â€œMyFSDataInputStreamâ€ï¼Œè¯¥ç±»ç»§æ‰¿â€œorg.apache.hadoop.fs.FSDataInputStreamâ€ï¼Œè¦æ±‚å¦‚ä¸‹ï¼šå®ç°æŒ‰è¡Œè¯»å–HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–¹æ³•â€œreadLine()â€ï¼Œå¦‚æœè¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼Œåˆ™è¿”å›ç©ºï¼Œå¦åˆ™è¿”å›æ–‡ä»¶ä¸€è¡Œçš„æ–‡æœ¬ã€‚æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava.net.URLâ€å’Œâ€œorg.apache.hadoop.fs.FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­"></a>ç¼–ç¨‹å®ç°ä¸€ä¸ªç±»â€œMyFSDataInputStreamâ€ï¼Œè¯¥ç±»ç»§æ‰¿â€œorg.apache.hadoop.fs.FSDataInputStreamâ€ï¼Œè¦æ±‚å¦‚ä¸‹ï¼šå®ç°æŒ‰è¡Œè¯»å–HDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–¹æ³•â€œreadLine()â€ï¼Œå¦‚æœè¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼Œåˆ™è¿”å›ç©ºï¼Œå¦åˆ™è¿”å›æ–‡ä»¶ä¸€è¡Œçš„æ–‡æœ¬ã€‚æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava.net.URLâ€å’Œâ€œorg.apache.hadoop.fs.FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­</h2><p>å…³äºJava APIä¸­URLç±»çš„ä½¿ç”¨ç»†èŠ‚ï¼Œå¯ä»¥è¯¦ç»†é˜…è¯»ï¼š</p>
<p><a href="http://www.javaweb.cc/help/JavaAPI1.6/java/net/URL.html#setURLStreamHandlerFactory%28java.net.URLStreamHandlerFactory%29" target="_blank" rel="noopener">java.net.URL</a></p>
<p>å…³äºHadoopä¸­FsURLStreamHandlerFactoryç±»çš„ä½¿ç”¨ç»†èŠ‚å¯ä»¥å­¦ä¹ ï¼š<br><a href="http://hadoop.apache.org/docs/r1.2.1/api/org/apache/hadoop/fs/FsUrlStreamHandlerFactory.html" target="_blank" rel="noopener">org.apache.hadoop.fs.FsURLStreamHandlerFactory</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FSDataInputStream;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFSDataInputStream</span> <span class="keyword">extends</span> <span class="title">FSDataInputStream</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyFSDataInputStream</span><span class="params">(InputStream in)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(in);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®ç°æŒ‰è¡Œè¯»å–</span></span><br><span class="line"><span class="comment">     * æ¯æ¬¡è¯»å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œé‡åˆ°"\n"ç»“æŸï¼Œè¿”å›ä¸€è¡Œå†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">readline</span><span class="params">(BufferedReader br)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">char</span>[] data = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> read = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> off = <span class="number">0</span>; </span><br><span class="line"><span class="comment">// å¾ªç¯æ‰§è¡Œæ—¶ï¼Œbr æ¯æ¬¡ä¼šä»ä¸Šä¸€æ¬¡è¯»å–ç»“æŸçš„ä½ç½®ç»§ç»­è¯»å–</span></span><br><span class="line"><span class="comment">//å› æ­¤è¯¥å‡½æ•°é‡Œï¼Œoff æ¯æ¬¡éƒ½ä»0å¼€å§‹</span></span><br><span class="line">        <span class="keyword">while</span> ( (read = br.read(data, off, <span class="number">1</span>)) != -<span class="number">1</span> ) &#123;</span><br><span class="line">            <span class="keyword">if</span> (String.valueOf(data[off]).equals(<span class="string">"\n"</span>) ) &#123;</span><br><span class="line">                off += <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            off += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (off &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> String.valueOf(data);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cat</span><span class="params">(Configuration conf, String remoteFilePath)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        FileSystem fs = FileSystem.get(conf);</span><br><span class="line">        Path remotePath = <span class="keyword">new</span> Path(remoteFilePath);</span><br><span class="line">        FSDataInputStream in = fs.open(remotePath);</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(in));</span><br><span class="line">        String line = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ( (line = MyFSDataInputStream.readline(br)) != <span class="keyword">null</span> ) &#123;</span><br><span class="line">            System.out.println(line);</span><br><span class="line">        &#125;</span><br><span class="line">        br.close();</span><br><span class="line">        in.close();</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    conf.set(<span class="string">"fs.default.name"</span>,<span class="string">"hdfs://0.0.0.0:8020"</span>);</span><br><span class="line">        String remoteFilePath = <span class="string">"/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSè·¯å¾„</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            MyFSDataInputStream.cat(conf, remoteFilePath);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava-net-URLâ€å’Œâ€œorg-apache-hadoop-fs-FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­"><a href="#æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava-net-URLâ€å’Œâ€œorg-apache-hadoop-fs-FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­" class="headerlink" title="æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava.net.URLâ€å’Œâ€œorg.apache.hadoop.fs.FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­"></a>æŸ¥çœ‹Javaå¸®åŠ©æ‰‹å†Œæˆ–å…¶å®ƒèµ„æ–™ï¼Œç”¨â€œjava.net.URLâ€å’Œâ€œorg.apache.hadoop.fs.FsURLStreamHandlerFactoryâ€ç¼–ç¨‹å®Œæˆè¾“å‡ºHDFSä¸­æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬åˆ°ç»ˆç«¯ä¸­</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IOUtils;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HDFSApi</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;  </span><br><span class="line">        URL.setURLStreamHandlerFactory(<span class="keyword">new</span> FsUrlStreamHandlerFactory());  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»å‡½æ•° </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String remoteFilePath = <span class="string">"hdfs://0.0.0.0:8020/user/hadoop/text.txt"</span>;    <span class="comment">// HDFSæ–‡ä»¶</span></span><br><span class="line">        InputStream in = <span class="keyword">null</span>; </span><br><span class="line">        <span class="keyword">try</span>&#123;  </span><br><span class="line">            <span class="comment">/* é€šè¿‡URLå¯¹è±¡æ‰“å¼€æ•°æ®æµï¼Œä»ä¸­è¯»å–æ•°æ® */</span></span><br><span class="line">            in = <span class="keyword">new</span> URL(remoteFilePath).openStream();  </span><br><span class="line">            IOUtils.copyBytes(in,System.out,<span class="number">4096</span>,<span class="keyword">false</span>);  </span><br><span class="line">        &#125; <span class="keyword">finally</span>&#123;  </span><br><span class="line">            IOUtils.closeStream(in);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/10/11/æ—å­é›¨å¤§æ•°æ®-hdfså¸¸ç”¨çš„æ“ä½œï¼ˆå®éªŒæ“ä½œè¯¦ç»†è®°å½•ä¸è®²è§£ï¼‰/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="æ—å­é›¨å¤§æ•°æ®-hdfså¸¸ç”¨çš„æ“ä½œï¼ˆå®éªŒæ“ä½œè¯¦ç»†è®°å½•ä¸è®²è§£ï¼‰">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Javaä¸­çš„Socket" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/09/Javaä¸­çš„Socket/" class="article-date">
  	<time datetime="2020-10-09T12:57:55.870Z" itemprop="datePublished">2020-10-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/09/Javaä¸­çš„Socket/">
        Javaä¸­çš„Socket
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>java.netåŒ…ä¸­æä¾›äº†ä¸¤ç§å¸¸è§çš„ç½‘ç»œåè®®çš„æ”¯æŒï¼š</p>
<ul>
<li>TCPï¼šTCPä¼ è¾“æ§åˆ¶åè®®ï¼Œä¿è¯äº†ä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´çš„å¯é ä¼ è¾“é€šä¿¡</li>
<li>UDPï¼šUDPæ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œä¸€ä¸ªæ— é“¾æ¥çš„åè®®ï¼Œæä¾›äº†åº”ç”¨ç¨‹åºä¹‹é—´è¦å‘é€çš„æ•°æ®çš„æ•°æ®åŒ…ã€‚<h2 id="Socket-çš„å®šä¹‰"><a href="#Socket-çš„å®šä¹‰" class="headerlink" title="Socket çš„å®šä¹‰"></a>Socket çš„å®šä¹‰</h2>å¥—æ¥å­—ä½¿ç”¨TCPæä¾›äº†ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡æœºåˆ¶ã€‚</li>
</ul>
<h3 id="è®¡ç®—æœºä½¿ç”¨å¥—æ¥å­—è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹"><a href="#è®¡ç®—æœºä½¿ç”¨å¥—æ¥å­—è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹" class="headerlink" title="è®¡ç®—æœºä½¿ç”¨å¥—æ¥å­—è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹"></a>è®¡ç®—æœºä½¿ç”¨å¥—æ¥å­—è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹</h3><ol>
<li>æœåŠ¡å™¨å®ä¾‹åŒ–ä¸€ä¸ªServerSocketå¯¹è±¡ï¼Œè¡¨ç¤ºé€šè¿‡æœåŠ¡å™¨ä¸Šçš„ç«¯å£é€šä¿¡</li>
<li>æœåŠ¡å™¨è°ƒç”¨ServerSocketç±»çš„accept()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨ä¸Šçš„ç»™å®šçš„ç«¯å£ã€‚</li>
<li>æœåŠ¡å™¨æ­£åœ¨ç­‰å¾…çš„æ—¶å€™ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯å®ä¾‹åŒ–ä¸€ä¸ªSocketå¯¹è±¡ï¼ŒæŒ‡å®šæœåŠ¡å™¨åç§°ä»¥åŠç«¯å£æ¥è¯·æ±‚è¿æ¥ã€‚</li>
<li>Socketç±»çš„æ„é€ å‡½æ•°è¯•å›¾å°†å®¢æˆ·ç«¯è¿æ¥åˆ°æŒ‡å®šçš„æœåŠ¡å™¨å’Œç«¯å£å·ã€‚å¦‚æœé€šä¿¡è¢«å»ºç«‹ï¼Œåˆ™åœ¨å®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªSocketå¯¹è±¡ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ã€‚</li>
<li>åœ¨æœåŠ¡å™¨ç«¯ï¼Œaccept()æ–¹æ³•è¿”å›æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªæ–°çš„socketå¼•ç”¨ï¼Œè¿™ä¸ªsocketè¿æ¥åˆ°å®¢æˆ·ç«¯çš„socketã€‚</li>
<li>è¿æ¥å»ºç«‹ä¹‹åï¼Œé€šè¿‡ä½¿ç”¨I/Oæµè¿›è¡Œé€šä¿¡ï¼Œæ¯ä¸€ä¸ªsocketéƒ½æœ‰ä¸€ä¸ªè¾“å‡ºæµå’Œä¸€ä¸ªè¾“å…¥æµã€‚å®¢æˆ·ç«¯çš„è¾“å‡ºæµè¿æ¥åˆ°æœåŠ¡å™¨çš„è¾“å…¥æµï¼Œå®¢æˆ·ç«¯çš„è¾“å…¥æµè¿æ¥åˆ°æœåŠ¡å™¨çš„è¾“å‡ºæµã€‚<br><em>TCPæ˜¯ä¸€ä¸ªåŒå‘çš„é€šä¿¡åè®®ï¼Œæ•°æ®å¯ä»¥é€šè¿‡ä¸¤ä¸ªæ•°æ®æµåœ¨åŒä¸€ä¸ªæ—¶é—´å‘é€ã€‚</em><h2 id="Socketæ–¹æ³•"><a href="#Socketæ–¹æ³•" class="headerlink" title="Socketæ–¹æ³•"></a>Socketæ–¹æ³•</h2>å‚è§è¯† java API</li>
</ol>
<h2 id="ä½¿ç”¨Socketå®ç°æ–‡ä»¶çš„ä¼ è¾“"><a href="#ä½¿ç”¨Socketå®ç°æ–‡ä»¶çš„ä¼ è¾“" class="headerlink" title="ä½¿ç”¨Socketå®ç°æ–‡ä»¶çš„ä¼ è¾“"></a>ä½¿ç”¨Socketå®ç°æ–‡ä»¶çš„ä¼ è¾“</h2><p>Server</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> ServerSocket serverSocket;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Server</span><span class="params">(<span class="keyword">int</span> port)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		serverSocket = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">		<span class="comment">//æŒ‡å®šè¶…æ—¶ ä»¥æ¯«ç§’ä¸ºå•ä½</span></span><br><span class="line">		serverSocket.setSoTimeout(<span class="number">10000000</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"waiting for client on port..."</span>+serverSocket.getLocalPort());</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="comment">//ç­‰å¾…æ–°çš„è¿æ¥</span></span><br><span class="line">				Socket server = serverSocket.accept();</span><br><span class="line">				System.out.println(<span class="string">"Just connected to "</span>+server.getRemoteSocketAddress());</span><br><span class="line">				<span class="comment">//è·å–è¾“å…¥æµ</span></span><br><span class="line">				DataInputStream in = <span class="keyword">new</span> DataInputStream(server.getInputStream());</span><br><span class="line">					File file = <span class="keyword">new</span> File(<span class="string">"/Users/gorge/Desktop"</span>+server.getRemoteSocketAddress()+<span class="string">".txt"</span>);</span><br><span class="line">					FileOutputStream outputStream =<span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">					<span class="keyword">byte</span> car [] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">					<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">while</span> ((len=in.read(car))!=-<span class="number">1</span>) &#123;</span><br><span class="line">						outputStream.write(car, <span class="number">0</span>, len);</span><br><span class="line">					&#125;</span><br><span class="line">				   outputStream.flush();</span><br><span class="line">				<span class="comment">//System.out.println("Client say"+in.readUTF());</span></span><br><span class="line">				</span><br><span class="line">				<span class="comment">//DataOutputStream out = new DataOutputStream(server.getOutputStream());</span></span><br><span class="line">				<span class="comment">//å†™å…¥æ•°æ® è¿”å›è¿™ä¸ªå¥—æ¥å­—ç»‘å®šçš„ç«¯ç‚¹çš„åœ°å€</span></span><br><span class="line">				<span class="comment">//out.writeUTF("Thanks you for a connecting to"+server.getLocalSocketAddress()+"good bye");</span></span><br><span class="line">				server.close();</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SocketException s) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				System.out.println(<span class="string">"socket timed out"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">					e.printStackTrace();</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> port = <span class="number">5000</span>;</span><br><span class="line">		Thread thread;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			thread = <span class="keyword">new</span> Server(port);</span><br><span class="line">			thread.start();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Client</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">åœ¨è¿™é‡Œ<span class="keyword">package</span> Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.DataInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.DataOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> port ;</span><br><span class="line">    String servername;</span><br><span class="line">    Socket client;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="title">Client</span><span class="params">(String servername, <span class="keyword">int</span> port)</span> </span>&#123;</span><br><span class="line">    	<span class="keyword">this</span>.servername = servername;</span><br><span class="line">    	<span class="keyword">this</span>.port = port;</span><br><span class="line">    	<span class="keyword">try</span> &#123;</span><br><span class="line">    		System.out.println(<span class="string">"Connecting to "</span>+servername+<span class="string">"on port"</span>+port);</span><br><span class="line">			client  = <span class="keyword">new</span> Socket(servername,port);</span><br><span class="line">			System.out.println(<span class="string">"Just connect to "</span>+client.getRemoteSocketAddress());</span><br><span class="line">			<span class="comment">//è¾“å‡ºæµ</span></span><br><span class="line">			OutputStream outToserver = client.getOutputStream();</span><br><span class="line">			DataOutputStream out = <span class="keyword">new</span> DataOutputStream(outToserver);</span><br><span class="line">			File file1 = <span class="keyword">new</span> File(<span class="string">"/Users/gorge/Desktop/a.txt"</span>);</span><br><span class="line">			<span class="comment">//å…ˆä»æœ¬åœ°è¯»å–ä¸€ä¸ªæ–‡ä»¶</span></span><br><span class="line">			FileInputStream inputStream  = <span class="keyword">new</span> FileInputStream(file1);</span><br><span class="line">			<span class="keyword">byte</span> [] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> len =<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(-<span class="number">1</span>!=(len=inputStream.read(b))) &#123;</span><br><span class="line">				out.write(b,<span class="number">0</span>,len);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//out.writeUTF("Hello from" +client.getLocalSocketAddress());</span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">//è¾“å…¥æµ</span></span><br><span class="line">			InputStream inFromserver = client.getInputStream();</span><br><span class="line">			DataInputStream in = <span class="keyword">new</span> DataInputStream(inFromserver);</span><br><span class="line">			<span class="comment">//System.out.println("Server says:"+in.readUTF());</span></span><br><span class="line">			client.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Client cl = <span class="keyword">new</span> Client(<span class="string">"127.0.0.1"</span>, <span class="number">5000</span>);</span><br><span class="line">	    cl.start();</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/10/09/Javaä¸­çš„Socket/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="Javaä¸­çš„Socket">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-WebMagicæ¡†æ¶å®ç°å¯¹58åŒåŸå°±ä¸šä¿¡æ¯çš„çˆ¬å–" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/10/02/WebMagicæ¡†æ¶å®ç°å¯¹58åŒåŸå°±ä¸šä¿¡æ¯çš„çˆ¬å–/" class="article-date">
  	<time datetime="2020-10-02T03:23:05.880Z" itemprop="datePublished">2020-10-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/02/WebMagicæ¡†æ¶å®ç°å¯¹58åŒåŸå°±ä¸šä¿¡æ¯çš„çˆ¬å–/">
        WebMagicæ¡†æ¶å®ç°å¯¹58åŒåŸå°±ä¸šä¿¡æ¯çš„çˆ¬å–
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><strong>æ­¤ä¿¡æ¯çš„çˆ¬å–ï¼Œçº¯å±æ˜¯ç»ƒä¹ ä½¿ç”¨ï¼Œæ²¡æœ‰ç”¨åœ¨å•†ä¸šç”¨é€”ã€‚</strong><br>WebMagicçš„è®¾è®¡å‚è€ƒäº†ä¸šç•Œæœ€ä¼˜ç§€çš„çˆ¬è™«Scrapyï¼Œè€Œå®ç°åˆ™åº”ç”¨äº†HttpClientã€Jsoupç­‰Javaä¸–ç•Œæœ€æˆç†Ÿçš„å·¥å…·ã€‚</p>
<p>WebMagicç”±å››ä¸ªç»„ä»¶(Downloaderã€PageProcessorã€Schedulerã€Pipeline)æ„æˆï¼Œæ ¸å¿ƒä»£ç éå¸¸ç®€å•ï¼Œä¸»è¦æ˜¯å°†è¿™äº›ç»„ä»¶ç»“åˆå¹¶å®Œæˆå¤šçº¿ç¨‹çš„ä»»åŠ¡ã€‚<br><img src="https://img-blog.csdnimg.cn/20201001204658382.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="å¯¼åŒ…"><a href="#å¯¼åŒ…" class="headerlink" title="å¯¼åŒ…"></a>å¯¼åŒ…</h2><p>ä½¿ç”¨webmagicéœ€è¦å¯¼å…¥çš„åŸºæœ¬åŒ…ï¼š</p>
<p><strong>webmagic-core</strong><br>webmagic-coreæ˜¯WebMagicæ ¸å¿ƒéƒ¨åˆ†ï¼ŒåªåŒ…å«çˆ¬è™«åŸºæœ¬æ¨¡å—å’ŒåŸºæœ¬æŠ½å–å™¨ã€‚WebMagic-coreçš„ç›®æ ‡æ˜¯æˆä¸ºç½‘é¡µçˆ¬è™«çš„ä¸€ä¸ªæ•™ç§‘ä¹¦èˆ¬çš„å®ç°ã€‚</p>
<p><strong>webmagic-extension</strong><br>webmagic-extensionæ˜¯WebMagicçš„ä¸»è¦æ‰©å±•æ¨¡å—ï¼Œæä¾›ä¸€äº›æ›´æ–¹ä¾¿çš„ç¼–å†™çˆ¬è™«çš„å·¥å…·ã€‚åŒ…æ‹¬æ³¨è§£æ ¼å¼å®šä¹‰çˆ¬è™«ã€JSONã€åˆ†å¸ƒå¼ç­‰æ”¯æŒã€‚</p>
<h2 id="é¡µé¢åˆ†æ"><a href="#é¡µé¢åˆ†æ" class="headerlink" title="é¡µé¢åˆ†æ"></a>é¡µé¢åˆ†æ</h2><p>å‡è®¾æˆ‘ä»¬ç°åœ¨è¦çˆ¬å–çš„æ˜¯åŸå¸‚åœ¨åŒ—äº¬çš„æ‰€æœ‰çš„å²—ä½æ‹›è˜ä¿¡æ¯ã€‚<br>58åŒåŸçš„é¡µé¢çš„è®¾è®¡å¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20201001210902543.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä»è¿™ä¸€ä¸ªç•Œé¢ä¸Šå¤§å®¶å°±å¯ä»¥å¾ˆå®¹æ˜“çš„æ‰¾åˆ°ä¸€äº›æƒ³è¦çš„åŸºæœ¬çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´å²—ä½ã€å…¬å¸æ€§è´¨ã€è–ªèµ„æƒ…å†µç­‰ä¿¡æ¯ã€‚å¦‚æœä½ éœ€è¦çš„ä¿¡æ¯è¿™äº›å°±è¶³å¤Ÿäº†ï¼Œé‚£ä¹ˆä½ åªéœ€è¦å¯¹è¿™ä¸€ä¸ªç•Œé¢è¿›è¡Œåˆ†æçˆ¬å–å°±å¥½äº†ã€‚æˆ‘è¿™é‡Œä¸ºäº†è·å–æ›´å®Œå–„çš„ä¿¡æ¯ï¼Œæ‰€ä»¥å°±è¿›è¡Œäº†è¿›ä¸€æ­¥çš„åˆ†æã€‚</p>
<p>èŒä½è¯¦ç»†ä¿¡æ¯çš„ç•Œé¢è®¾ç½®å¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/2020100121212968.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="é“¾æ¥åˆ†æ"><a href="#é“¾æ¥åˆ†æ" class="headerlink" title="é“¾æ¥åˆ†æ"></a>é“¾æ¥åˆ†æ</h2><p><strong>æ€»ä½“ç•Œé¢é“¾æ¥åˆ†æï¼š</strong><br><em>ç¬¬ä¸€é¡µçš„é“¾æ¥ï¼š</em><br><a href="https://search.51job.com/list/010000,000000,0000,00,9,99,+,2,1.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=" target="_blank" rel="noopener">https://search.51job.com/list/010000,000000,0000,00,9,99,+,2,1.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=</a><br><em>ç¬¬äºŒé¡µçš„é“¾æ¥ï¼š</em><br><a href="https://search.51job.com/list/010000,000000,0000,00,9,99,+,2,2.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=" target="_blank" rel="noopener">https://search.51job.com/list/010000,000000,0000,00,9,99,+,2,2.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=</a></p>
<p>å¤§å®¶å¯¹è¿™ä¸ªé“¾æ¥è¿›è¡Œåˆ†æï¼Œå¯ä»¥å‘ç°é“¾æ¥æ˜¯æœ‰è§„å¾‹çš„ï¼Œåœ¨åŒä¸€ä¸ªåŸå¸‚ä¸‹çš„æ±‚èŒä¿¡æ¯ï¼Œé“¾æ¥çš„å·®åˆ«ä¸»è¦åœ¨ <em>n.html</em> è¿™ä¸ªä½ç½®ï¼Œæ‰€ä»¥å¦‚æœåªæ˜¯è·å–è¿™ä¸ªé¡µé¢çš„ä¿¡æ¯ï¼Œé“¾æ¥çš„åˆ†æåˆ°æ­¤å°±å¯ä»¥ç»“æŸäº†ï¼Œç›´æ¥å¯¹é¡µé¢è¿›è¡Œè¯¦ç»†åˆ†æï¼Œå¦‚ä½•ç”¨xpath è¿›è¡ŒåŒ¹é…åˆ°ä½ æƒ³è¦è·å–çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥äº†ã€‚</p>
<p><strong>è¯¦ç»†é¡µé¢é“¾æ¥åˆ†æï¼š</strong><br>ç¬¬ä¸€ä¸ªèŒä½é“¾æ¥ï¼š<br><a href="https://jobs.51job.com/beijing-tzq/124559934.html?s=01&amp;t=0" target="_blank" rel="noopener">https://jobs.51job.com/beijing-tzq/124559934.html?s=01&amp;t=0</a><br>ç¬¬äºŒä¸ªèŒä½é“¾æ¥ï¼š<br><a href="https://jobs.51job.com/beijing-cyq/117551387.html?s=01&amp;t=0" target="_blank" rel="noopener">https://jobs.51job.com/beijing-cyq/117551387.html?s=01&amp;t=0</a></p>
<p>è¿™é‡Œæˆ‘æ²¡æœ‰çœ‹å‡ºå¾ˆå®¹æ˜“å¤„ç†çš„å…±åŒç‚¹æ¥ã€‚æ‰€æœ‰è¿™ä¸ªé“¾æ¥å°±ä¸èƒ½å¾ˆç®€å•çš„è·å–ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»æ¯ä¸€ä¸ªæ±‡æ€»é¡µçš„ä½ç½®è·å¾—ï¼Œå¤§å®¶å¯ä»¥å¤šçœ‹å‡ ä¸ªé“¾æ¥è¿›è¡Œåˆ†æï¼Œå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æï¼ˆè¿™ä¸ªæ–¹å¼ä¼¼ä¹æ›´æ–¹ä¾¿ä¸€äº›ï¼‰</p>
<h2 id="é¡µé¢HTMLåˆ†æ"><a href="#é¡µé¢HTMLåˆ†æ" class="headerlink" title="é¡µé¢HTMLåˆ†æ"></a>é¡µé¢HTMLåˆ†æ</h2><p>æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå°±ç›´æ¥åˆ†ææ€»é¡µå°±å¯ä»¥äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/20201001212707496.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¤§å®¶çœ‹åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯å·²ç»å¾ˆæ˜æ˜¾äº†ï¼Œå¯¹äºæ€»é¡µçš„æ¯ä¸€ä¸ªæ¨¡å—çš„é“¾æ¥æ˜¯éå¸¸æ˜æ˜¾çš„ï¼Œå¹¶ä¸”58åŒåŸçš„ä¿¡æ¯æ¯ä¸€ä¸ªæ¨¡å—çš„è®¾ç½®çš„æ ¼å¼æ˜¯éå¸¸æ•´æ´çš„ã€‚å¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ªdivçš„classå±æ€§æ˜¯e,ç„¶åç›´æ¥æ‰¾å­æ ‡ç­¾ä¸ºaçš„æ ‡ç­¾çš„hrefå±æ€§å°±å¯ä»¥å¾—åˆ°ä½ æƒ³è¦çš„è¿›ä¸€æ­¥çš„é¡µé¢çš„é“¾æ¥ã€‚</p>
<p>æ‰€ä»¥ï¼Œå°±è¿›è¡Œäº†ä¸¤æ­¥çˆ¬å–åˆ†æã€‚ç¬¬ä¸€æ­¥æ˜¯çˆ¬å–ç›¸å…³æ‹›è˜ä¿¡æ¯çš„ç½‘å€ï¼Œç¬¬äºŒæ­¥æ˜¯é’ˆå¯¹å½“å‰ç½‘å€çˆ¬å–æ‹›è˜å²—ä½çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<h2 id="ç¼–å†™çˆ¬è™«ï¼ˆè¿™é‡Œåªä»‹ç»ä¸€ä¸‹çˆ¬å–ç½‘å€ï¼Œè¯¦ç»†ä¿¡æ¯è¿‡ç¨‹ä¸€æ ·ï¼‰"><a href="#ç¼–å†™çˆ¬è™«ï¼ˆè¿™é‡Œåªä»‹ç»ä¸€ä¸‹çˆ¬å–ç½‘å€ï¼Œè¯¦ç»†ä¿¡æ¯è¿‡ç¨‹ä¸€æ ·ï¼‰" class="headerlink" title="ç¼–å†™çˆ¬è™«ï¼ˆè¿™é‡Œåªä»‹ç»ä¸€ä¸‹çˆ¬å–ç½‘å€ï¼Œè¯¦ç»†ä¿¡æ¯è¿‡ç¨‹ä¸€æ ·ï¼‰"></a>ç¼–å†™çˆ¬è™«ï¼ˆè¿™é‡Œåªä»‹ç»ä¸€ä¸‹çˆ¬å–ç½‘å€ï¼Œè¯¦ç»†ä¿¡æ¯è¿‡ç¨‹ä¸€æ ·ï¼‰</h2><ul>
<li>åœ¨WebMagicé‡Œé¢å¦‚æœæƒ³è¦å®ç°åŸºæœ¬çš„çˆ¬è™«ï¼Œåªéœ€è¦ç¼–å†™ä¸€ä¸ªç±»å®ç°Pa geProcessorå³å¯ï¼Œéœ€è¦é‡å†™process(Page page)æ–¹æ³•</li>
<li>çˆ¬è™«çš„é…ç½®<br>1ã€Spider<br>Spideræ˜¯çˆ¬è™«å¯åŠ¨çš„å…¥å£ã€‚åœ¨å¯åŠ¨çˆ¬è™«ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªPageProcessoråˆ›å»ºä¸€ä¸ªSpiderå¯¹è±¡ï¼Œç„¶åä½¿ç”¨run()è¿›è¡Œå¯åŠ¨ã€‚åŒæ—¶Spiderçš„å…¶ä»–ç»„ä»¶ï¼ˆDownloaderã€Schedulerã€Pipelineï¼‰éƒ½å¯ä»¥é€šè¿‡setæ–¹æ³•æ¥è¿›è¡Œè®¾ç½®ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Spider.create(<span class="keyword">new</span> URls())</span><br><span class="line">                .addUrl(<span class="string">"url"</span>)</span><br><span class="line"><span class="comment">//ä½¿ç”¨æ–‡ä»¶ä¿å­˜æŠ“å–URLï¼Œå¯ä»¥åœ¨å…³é—­ç¨‹åºå¹¶ä¸‹æ¬¡å¯åŠ¨æ—¶ï¼Œä»ä¹‹å‰æŠ“å–åˆ°çš„URLç»§ç»­æŠ“å–(å…·ä½“å†…å®¹æŸ¥çœ‹Schedulerçš„é…ç½®)</span></span><br><span class="line">                .setScheduler(<span class="keyword">new</span> FileCacheQueueScheduler(<span class="string">"./51jobUrl"</span>))</span><br><span class="line">                .thread(<span class="number">5</span>)</span><br><span class="line">                .run();</span><br></pre></td></tr></table></figure>
<p>  2ã€Site<br>å¯¹ç«™ç‚¹æœ¬èº«çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ç¼–ç ã€HTTPå¤´ã€è¶…æ—¶æ—¶é—´ã€é‡è¯•ç­–ç•¥ç­‰ã€ä»£ç†ç­‰ï¼Œéƒ½å¯ä»¥é€šè¿‡è®¾ç½®Siteå¯¹è±¡æ¥è¿›è¡Œé…ç½®ã€‚<br>private Site site = Site.me().setRetryTimes(3).setSleepTime(10000).setTimeOut(10000);</p>
<ul>
<li>æŠ½å–ä¿¡æ¯å¹¶ä¸”å°†ä¿¡æ¯ä¿ç•™ä¸‹æ¥</li>
</ul>
<p>å°†è·å–åˆ°çš„é¡µé¢è¿›è¡Œxpathè§£æï¼ŒxpathæŠ€æœ¯è¿™é‡Œå°±ä¸åœ¨èµ˜è¿°ã€‚.allï¼ˆï¼‰æ–¹æ³•æ˜¯è¿”å›æ‰€æœ‰æŠ½å–ç»“æœã€‚<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.getHtml().xpath(<span class="string">"//div[@class='el']//p[@class='t1']/span/a/@href"</span>).all()</span><br></pre></td></tr></table></figure></p>
<p>å°†è·å¾—æ•°æ®ä¿å­˜ä¸‹æ¥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.putField(<span class="string">"url"</span>,page.getHtml().xpath(<span class="string">"//div[@class='el']//p[@class='t1']/span/a/@href"</span>).all());</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘ä»¬è¿™é‡Œéœ€è¦å°†æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå› æ­¤éœ€è¦å°†æ•°æ®ä»f ieldä¸­é€šè¿‡åç§°è·å–å‡ºæ¥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String  a = page.getResultItems().get(<span class="string">"url"</span>).toString();</span><br></pre></td></tr></table></figure>
<ul>
<li>ä»é¡µé¢å‘ç°åç»­çš„åœ°å€æ¥è¿›è¡ŒæŠ“å–<br>listæ˜¯ä½ è¦è¿›è¡ŒåŒ¹é…çš„é“¾æ¥ï¼Œå¯ä»¥æ˜¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯æ‰‹åŠ¨æ·»åŠ çš„ç­‰ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.addTargetRequests(list);</span><br></pre></td></tr></table></figure>
<ul>
<li>æ•°æ®å·²ç»è·å¾—äº†ï¼Œæœ€åå°†è¿™äº›æ•°æ®æ’å…¥åˆ°æå‰å»ºè®¾å¥½çš„æ•°æ®åº“å°±å¯ä»¥äº†ã€‚</li>
<li><a href="https://github.com/CattleZ/MacLearngit/tree/master/WebMagic" target="_blank" rel="noopener">æºç </a><br><a href="https://webmagic.io/docs/zh/" target="_blank" rel="noopener">å®˜æ–¹å­¦ä¹ æ–‡æ¡£</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/10/02/WebMagicæ¡†æ¶å®ç°å¯¹58åŒåŸå°±ä¸šä¿¡æ¯çš„çˆ¬å–/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="WebMagicæ¡†æ¶å®ç°å¯¹58åŒåŸå°±ä¸šä¿¡æ¯çš„çˆ¬å–">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-æœ¬æœºMacå»ºè®¾Gitè®°å½•" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/09/19/æœ¬æœºMacå»ºè®¾Gitè®°å½•/" class="article-date">
  	<time datetime="2020-09-19T08:04:42.150Z" itemprop="datePublished">2020-09-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/09/19/æœ¬æœºMacå»ºè®¾Gitè®°å½•/">
        æœ¬æœºMacå»ºè®¾gitè®°å½•ã€Šä¸€ã€‹
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>é¦–å…ˆï¼Œæ˜¯åœ¨ç”µè„‘ä¸Šé€šè¿‡app store å®‰è£…Xcode.<br>åœ¨ Xcodeä¸­æ‰¾åˆ°locations è¿™ä¸ª é€‰é¡¹ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€ä¸ªCommand Line Tools çš„å·¥å…·ã€‚</p>
<h2 id="åˆ›å»ºæœ¬åœ°ä»“åº“"><a href="#åˆ›å»ºæœ¬åœ°ä»“åº“" class="headerlink" title="åˆ›å»ºæœ¬åœ°ä»“åº“"></a>åˆ›å»ºæœ¬åœ°ä»“åº“</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir learngit</span><br><span class="line">git init</span><br></pre></td></tr></table></figure>
<p>æˆ‘çš„è¿™ä¸ªå®‰è£…ç›®å½•æ˜¯ /Users/gorge/learngit</p>
<h2 id="æŸ¥çœ‹gitæ˜¯å¦é…ç½®æˆåŠŸ"><a href="#æŸ¥çœ‹gitæ˜¯å¦é…ç½®æˆåŠŸ" class="headerlink" title="æŸ¥çœ‹gitæ˜¯å¦é…ç½®æˆåŠŸ"></a>æŸ¥çœ‹gitæ˜¯å¦é…ç½®æˆåŠŸ</h2><p>git config â€“list</p>
<h2 id="å¯†é’¥çš„ä½ç½®"><a href="#å¯†é’¥çš„ä½ç½®" class="headerlink" title="å¯†é’¥çš„ä½ç½®"></a>å¯†é’¥çš„ä½ç½®</h2><p>åœ¨gorge ä¸‹æ‰§è¡Œls -al æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ .ssh ç›®å½•</p>
<h2 id="ä¸Šä¼ æ–¹å¼"><a href="#ä¸Šä¼ æ–¹å¼" class="headerlink" title="ä¸Šä¼ æ–¹å¼"></a>ä¸Šä¼ æ–¹å¼</h2><ul>
<li>é¦–å…ˆæˆ‘ä»¬è¦å°†æˆ‘ä»¬è¦è¿›è¡Œç®¡ç†çš„æ–‡ä»¶ ç§»åŠ¨åˆ°æœ¬åœ°å»ºç«‹çš„æ–‡ä»¶å¤¹</li>
<li>åœ¨å½“å‰ç›®å½•æ‰§è¡Œ <strong>git add [æ–‡ä»¶å]</strong> å°†æ–‡ä»¶æ·»åŠ åˆ°æœ¬åœ°ä»“åº“</li>
<li>æ‰§è¡Œæäº¤ <strong>git commit -m</strong> â€œæ–‡ä»¶æè¿°â€ å‘½ä»¤ ï¼Œå‘Šè¯‰ç³»ç»Ÿæ–‡ä»¶æäº¤åˆ°ä»“åº“</li>
<li>å°†æ–‡ä»¶ ç›´æ¥æäº¤åˆ° è¿œç¨‹ä»“åº“çš„å‘½ä»¤æ˜¯ <strong>git push origin master</strong> å‘½ä»¤è¿›è¡Œæäº¤</li>
</ul>
<p>æœ¬åœ°æ–‡ä»¶å¤¹æ˜¯<strong>å·¥ä½œåŒº</strong>ï¼Œ<em>.git</em>ç›®å½•æ˜¯<strong>ç‰ˆæœ¬åº“</strong><br>æˆ‘ä»¬æ‰§è¡Œçš„æ·»åŠ æ“ä½œå®é™…ä¸Šæ˜¯æŒ‡å°†ä¿¡æ¯æ·»åŠ åˆ°æœ¬åœ°çš„å·¥ä½œåŒºä¸­çš„ç‰ˆæœ¬åº“ä¸­ã€‚<br><em>git add æ“ä½œå°†æ•°æ®æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</em><br><em>git commit æ“ä½œæäº¤æ›´æ”¹ï¼Œå°†å†…å®¹æ·»åŠ åˆ°åˆ†æ”¯master</em></p>
<h2 id="æŸ¥çœ‹å†å²ä¿®æ”¹ç‰ˆæœ¬çš„å‘½ä»¤"><a href="#æŸ¥çœ‹å†å²ä¿®æ”¹ç‰ˆæœ¬çš„å‘½ä»¤" class="headerlink" title="æŸ¥çœ‹å†å²ä¿®æ”¹ç‰ˆæœ¬çš„å‘½ä»¤"></a>æŸ¥çœ‹å†å²ä¿®æ”¹ç‰ˆæœ¬çš„å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard  HEAD^</span><br></pre></td></tr></table></figure>
<ul>
<li>HEAD è¡¨ç¤ºå½“å‰ç‰ˆæœ¬</li>
<li>^ è¡¨ç¤ºå›é€€ä¸€ä¸ªç‰ˆæœ¬</li>
<li>^^ è¡¨ç¤ºå›é€€ä¸¤ä¸ªç‰ˆæœ¬</li>
<li>å¦‚æœæ˜¯å¤šä¸ªç‰ˆæœ¬çš„è¯å¯ä»¥æ˜¯ HEAD~n</li>
</ul>
<p>æˆ–è€…æ‰§è¡Œgit reset â€“hard  [id]</p>
<h2 id="æŸ¥çœ‹å†å²è®°å½•"><a href="#æŸ¥çœ‹å†å²è®°å½•" class="headerlink" title="æŸ¥çœ‹å†å²è®°å½•"></a>æŸ¥çœ‹å†å²è®°å½•</h2><p>git log ç”¨æ¥æŸ¥çœ‹æäº¤è®°å½•<br>git reflog  ç”¨æ¥æŸ¥çœ‹ä½ çš„æ¯ä¸€æ¬¡æ“ä½œè®°å½•</p>
<h2 id="æ’¤é”€ä¿®æ”¹"><a href="#æ’¤é”€ä¿®æ”¹" class="headerlink" title="æ’¤é”€ä¿®æ”¹"></a>æ’¤é”€ä¿®æ”¹</h2><h3 id="ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š"><a href="#ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š" class="headerlink" title="ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š"></a>ä¸»è¦åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š</h3><ol>
<li>é¦–å…ˆæ˜¯åœ¨å·¥ä½œåŒºçš„ä¿®æ”¹è¿˜æ²¡æœ‰æäº¤åˆ°æš‚å­˜åŒº</li>
</ol>
<p>ä¸‹é¢çš„å‘½ä»¤ä¼šå°†æ–‡ä»¶çš„ç‰ˆæœ¬æ¢å¤ä¸ºæˆ‘ä»¬æäº¤åˆ°åˆ†æ”¯çš„æœ€æ–°çš„ç‰ˆæœ¬ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -- readme.txt</span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>åœ¨å·¥ä½œåŒºè¿›è¡Œäº†ä¿®æ”¹å¹¶ä¸”å·²ç»æäº¤åˆ°æš‚å­˜åŒº</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD &lt;file&gt;</span><br></pre></td></tr></table></figure>
<h2 id="åˆ†æ”¯ç®¡ç†"><a href="#åˆ†æ”¯ç®¡ç†" class="headerlink" title="åˆ†æ”¯ç®¡ç†"></a>åˆ†æ”¯ç®¡ç†</h2><p>ä¸ºäº†æé«˜æ“ä½œçš„å®‰å…¨è¡Œï¼Œæˆ‘ä»¬åœ¨æ“ä½œçš„è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨<br>åˆ›å»ºæ–°çš„åˆ†æ”¯â€“æ‰§è¡Œæ“ä½œ<code></code>â€“åˆå¹¶åˆ†æ”¯ çš„è¿‡ç¨‹ã€‚<br>æˆ‘ä»¬é€šå¸¸ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªåˆ†æ”¯masteråˆ†æ”¯ã€‚ä½†æ˜¯å¯¹äºgitæ¥è¯´ï¼Œåˆ†æ”¯çš„åˆ›å»ºä¸åˆå¹¶æ˜¯éå¸¸å¿«é€Ÿçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸ºäº†æ“ä½œçš„å®‰å…¨æ€§ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯è¿›è¡Œæ“ä½œæ— ç–‘æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æ–¹æ³•ã€‚</p>
<p>æ‰§è¡Œåˆ›å»ºåˆ†æ”¯<em>dev</em>ï¼Œå¹¶ä¸”å°†å½“å‰å·¥ä½œè½¬æ¢åˆ°å½“å‰åˆ†æ”¯ä¸Šé¢ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b dev</span><br></pre></td></tr></table></figure></p>
<p>æŸ¥çœ‹å½“å‰åˆ†æ”¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure>
<p>åœ¨å½“å‰åˆ†æ”¯æ‰§è¡Œæ“ä½œå®Œæˆåï¼Œè¿›è¡Œæ·»åŠ å¹¶æäº¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add &lt;æ–‡ä»¶å&gt;</span><br><span class="line">git commit -m <span class="string">"æ–‡ä»¶æè¿°"</span></span><br></pre></td></tr></table></figure>
<p>åˆ†æ”¯çš„åˆ‡æ¢æ“ä½œ,masteræ˜¯æˆ‘ä»¬çš„é»˜è®¤åˆ†æ”¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout master</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…<br>åˆ›å»ºå¹¶ä¸”åˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git switch -c dev</span><br><span class="line">//åˆ‡æ¢åˆ°å·²æœ‰åˆ†æ”¯</span><br><span class="line">git switch master</span><br></pre></td></tr></table></figure></p>
<p>å°†devåˆ†æ”¯è¿›è¡Œåˆå¹¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge dev</span><br></pre></td></tr></table></figure>
<p>åˆå¹¶å®Œæˆä¹‹åï¼Œæ–°åˆ›å»ºçš„åˆ†æ”¯å°±å¯ä»¥åˆ é™¤äº†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d dev</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/09/19/æœ¬æœºMacå»ºè®¾Gitè®°å½•/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="æœ¬æœºMacå»ºè®¾gitè®°å½•ã€Šä¸€ã€‹">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Normalized Discounted Cumulative Gain(NDCG)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/07/12/Normalized Discounted Cumulative Gain(NDCG)/" class="article-date">
  	<time datetime="2020-07-12T08:33:05.548Z" itemprop="datePublished">2020-07-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/12/Normalized Discounted Cumulative Gain(NDCG)/">
        NDCG
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å½’ä¸€åŒ–åˆ™æŸç´¯ç§¯å¢ç›Š<br>è¿™ä¸ªæŒ‡æ ‡é€šå¸¸æ˜¯ç”¨æ¥è¡¡é‡å’Œè¯„ä»·æœç´¢ç»“æœç®—æ³•</p>
<ol>
<li>é«˜å…³è”åº¦çš„ç»“æœæ¯”ä¸€èˆ¬å…³è”åº¦çš„ç»“æœæ›´å½±å“æœ€ç»ˆçš„æŒ‡æ ‡å¾—åˆ†</li>
<li>æœ‰é«˜å…³è”åº¦çš„ç»“æœå‡ºç°åœ¨æ›´é å‰çš„ä½ç½®çš„æ—¶å€™ï¼ŒæŒ‡æ ‡ä¼šè¶Šé«˜<h2 id="ç´¯è®¡å¢ç›ŠCG"><a href="#ç´¯è®¡å¢ç›ŠCG" class="headerlink" title="ç´¯è®¡å¢ç›ŠCG"></a>ç´¯è®¡å¢ç›ŠCG</h2></li>
</ol>
<p>ä¸€ä¸ªæœç´¢ç»“æœç›¸å…³æ€§åˆ†æ•°çš„æ€»å’Œï¼Œä¸é¡ºåºæ— å…³<br>æŒ‡å®šä½ç½®Pçš„CGä¸ºï¼š<br><img src="https://img-blog.csdnimg.cn/20200709095732954.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å…¶ä¸­reli è¡¨ç¤º iè¿™ä¸ªä½ç½®ä¸Šçš„ç›¸å…³åº¦ã€‚</p>
<h2 id="æŠ˜æŸç´¯è®¡å¢ç›ŠDCG"><a href="#æŠ˜æŸç´¯è®¡å¢ç›ŠDCG" class="headerlink" title="æŠ˜æŸç´¯è®¡å¢ç›ŠDCG"></a>æŠ˜æŸç´¯è®¡å¢ç›ŠDCG</h2><p>å°±æ˜¯åœ¨æ¯ä¸€ä¸ªCGçš„ç»“æœä¸Šé™¤ä»¥ä¸€ä¸ªæŠ˜æŸå€¼ï¼ŒDCGåœ¨æ¯ä¸ªé¡¹ç›®çš„å¾—åˆ†ä¹˜ä¸Šä¸€ä¸ªæƒå€¼ï¼Œè¯¥æƒå€¼ä¸ä½ç½®æˆåå…³ç³»ï¼Œå³ä½ç½®è¶Šé å‰ï¼Œæƒå€¼è¶Šå¤§ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©æ’åè¶Šé å‰çš„ç»“æœè¶Šèƒ½å½±å“æœ€åçš„ç»“æœã€‚æ’åºè¶Šå¾€åï¼Œä»·å€¼è¶Šä½ã€‚<br><img src="https://img-blog.csdnimg.cn/20200709100512191.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ–è€…<br><img src="https://img-blog.csdnimg.cn/20200709100721635.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="å½’ä¸€åŒ–åˆ™æŸç´¯è®¡å¢ç›Š"><a href="#å½’ä¸€åŒ–åˆ™æŸç´¯è®¡å¢ç›Š" class="headerlink" title="å½’ä¸€åŒ–åˆ™æŸç´¯è®¡å¢ç›Š"></a>å½’ä¸€åŒ–åˆ™æŸç´¯è®¡å¢ç›Š</h2><p>ç”±äºæœç´¢ç»“æœéšç€æ£€ç´¢è¯çš„ä¸åŒï¼Œè¿”å›çš„æ•°é‡æ˜¯ä¸ä¸€è‡´çš„ã€‚è€ŒDCGæ˜¯ä¸€ä¸ªç´¯åŠ çš„å€¼ï¼Œæ²¡æ³•å¯¹ä¸¤ä¸ªä¸åŒçš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œä¸€ä¸ªå½’ä¸€åŒ–çš„å¤„ç†ã€‚<br><img src="https://img-blog.csdnimg.cn/20200709101206431.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>IDCG ä¸ºç†æƒ³æƒ…å†µä¸‹çš„æœ€å¤§çš„DCGå€¼<br><img src="https://img-blog.csdnimg.cn/20200709101246215.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å…¶ä¸­|REL|è¡¨ç¤ºç»“æœæŒ‰ç…§ç›¸å…³æ€§ä»å¤§åˆ°å°çš„é¡ºåºæ’åºï¼Œå–å‰Pä¸ªç»“æœç»„æˆçš„é›†åˆã€‚</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/07/12/Normalized Discounted Cumulative Gain(NDCG)/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="NDCG">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-Pearson Correlation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/07/12/Pearson Correlation/" class="article-date">
  	<time datetime="2020-07-12T08:33:05.539Z" itemprop="datePublished">2020-07-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/12/Pearson Correlation/">
        Pearson Collelation
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>çš®å°”æ£®ç›¸å…³ç³»æ•°æ˜¯è¡¡é‡çº¿æ€§å…³è”æ€§çš„ç¨‹åº¦ï¼ŒPçš„ä¸€ä¸ªå‡ ä½•è§£é‡Šæ˜¯å…¶ä»£è¡¨ä¸¤ä¸ªå˜é‡çš„å–å€¼æ ¹æ®å‡å€¼é›†ä¸­åæ„æˆçš„å‘é‡ä¹‹é—´å¤¹è§’çš„ä½™å¼¦ã€‚</p>
<ul>
<li>0 æ— ç›¸å…³</li>
<li>0-1 æ­£ç›¸å…³</li>
<li>-1 - 0è´Ÿç›¸å…³</li>
</ul>
<h2 id="ç›¸å…³ç³»æ•°"><a href="#ç›¸å…³ç³»æ•°" class="headerlink" title="ç›¸å…³ç³»æ•°"></a>ç›¸å…³ç³»æ•°</h2><ul>
<li>0.8-1.0 æå¼ºç›¸å…³</li>
<li>0.6-0.8 å¼ºç›¸å…³</li>
<li>0.4-0.6 ä¸­ç­‰ç›¸å…³</li>
<li>0.2- 0.4 å¼±ç›¸å…³</li>
<li><p>0.0- 0.2 æå¼±ç›¸å…³æˆ–è€…æ— å…³</p>
<h2 id="è®¡ç®—å…¬å¼"><a href="#è®¡ç®—å…¬å¼" class="headerlink" title="è®¡ç®—å…¬å¼"></a>è®¡ç®—å…¬å¼</h2></li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20200709092607634.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTM2NzE2,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸¤ä¸ªè¿ç»­å˜é‡ï¼ˆxï¼Œyï¼‰çš„per ç³»æ•°Pï¼ˆx,yï¼‰ç­‰äºä»–ä»¬ä¹‹é—´çš„åæ–¹å·®covï¼ˆx,yï¼‰é™¤ä»¥ä»–ä»¬å„è‡ªçš„æ ‡å‡†å·®æˆç»©ã€‚</p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line">vec1 = [0,1,2,3,4]</span><br><span class="line">vec2 = [0,1,2,3,4]</span><br><span class="line">def pearson(vec1,vec2):</span><br><span class="line">    n = len(vec1)</span><br><span class="line">    n1= len(vec2)</span><br><span class="line">    if(n==n1):</span><br><span class="line">        sum1 = sum(float(vec1[i]) for i in range(n))</span><br><span class="line">        sum2 = sum(float(vec2[i]) for i in range(n))</span><br><span class="line">        sum1_pow = sum([pow(v,2.0) for v in vec1])</span><br><span class="line">        sum2_pow = sum([pow(v,2.0) for v in vec2])</span><br><span class="line">        p_sum = sum([vec1[i]*vec2[i] for i in range(n)])</span><br><span class="line">        num = p_sum-(sum1*sum2/n)</span><br><span class="line">        fen = math.sqrt((sum1_pow-pow(sum1,2)/n)*(sum2_pow-pow(sum2,2)/n))</span><br><span class="line">        if fen ==0:</span><br><span class="line">            return 0.0;</span><br><span class="line">        return num/fen;</span><br><span class="line">    return 0.0;</span><br><span class="line">v = pearson(vec1,vec2);</span><br><span class="line">print(v)</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/07/12/Pearson Correlation/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="Pearson Collelation">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
    <article id="post-PDF &amp; CDF" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/07/12/PDF & CDF/" class="article-date">
  	<time datetime="2020-07-12T08:33:03.643Z" itemprop="datePublished">2020-07-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/12/PDF & CDF/">
        PDF &amp; CDF
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="æ¦‚ç‡å¯†åº¦å‡½æ•°-PDF"><a href="#æ¦‚ç‡å¯†åº¦å‡½æ•°-PDF" class="headerlink" title="æ¦‚ç‡å¯†åº¦å‡½æ•° PDF"></a>æ¦‚ç‡å¯†åº¦å‡½æ•° PDF</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>åœ¨æ•°å­¦ä¸­ï¼Œè¿ç»­å‹éšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆåœ¨ä¸è‡³äºæ··æ·†æ—¶å¯ä»¥ç®€ç§°ä¸ºå¯†åº¦å‡½æ•°ï¼‰æ˜¯ä¸€ä¸ªæè¿°è¿™ä¸ªéšæœºå˜é‡çš„è¾“å‡ºå€¼ï¼Œåœ¨æŸä¸ªç¡®å®šçš„å–å€¼ç‚¹é™„è¿‘çš„å¯èƒ½æ€§çš„å‡½æ•°ã€‚è€Œéšæœºå˜é‡çš„å–å€¼è½åœ¨æŸä¸ªåŒºåŸŸä¹‹å†…çš„æ¦‚ç‡åˆ™ä¸ºæ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨è¿™ä¸ªåŒºåŸŸä¸Šçš„ç§¯åˆ†ã€‚</p>
<h2 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h2><p>å¯¹äºä¸€ç»´è¿ç»­éšæœºå˜é‡<br>éšæœºæ•°æ®çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼šè¡¨ç¤ºç¬æ—¶å¹…å€¼è½åœ¨æŒ‡å®šçš„èŒƒå›´å†…çš„æ¦‚ç‡ï¼Œå› æ­¤æ˜¯å¹…å€¼çš„å‡½æ•°ã€‚å®ƒéšæ‰€å–èŒƒå›´çš„å¹…å€¼è€Œå˜åŒ–ã€‚<br>å¯†åº¦å‡½æ•°f(x) å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ol>
<li>f(x) &gt;= 0</li>
<li><img src="https://img-blog.csdnimg.cn/20200709195504798.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><ol start="3">
<li><img src="https://img-blog.csdnimg.cn/20200709195610934.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
</ol>
</li>
</ol>
<h1 id="ç´¯ç§¯åˆ†å¸ƒå‡½æ•°CDF"><a href="#ç´¯ç§¯åˆ†å¸ƒå‡½æ•°CDF" class="headerlink" title="ç´¯ç§¯åˆ†å¸ƒå‡½æ•°CDF"></a>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°CDF</h1><p>ç´¯ç§¯åˆ†å¸ƒå‡½æ•°åˆå«åˆ†å¸ƒå‡½æ•°æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç§¯åˆ†ï¼Œèƒ½å®Œæ•´çš„æè¿°ä¸€ä¸ªå®éšæœºå˜é‡Xçš„æ¦‚ç‡åˆ†å¸ƒã€‚</p>
<h2 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>å¯¹äºæ‰€æœ‰çš„å®æ•°xç´¯ç§¯åˆ†å¸ƒå‡½æ•°<br><img src="https://img-blog.csdnimg.cn/20200709191556745.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ„ä¹‰"><a href="#æ„ä¹‰" class="headerlink" title="æ„ä¹‰"></a>æ„ä¹‰</h2><p>å¯¹ç¦»æ•£å˜é‡è€Œè¨€ï¼Œæ‰€æœ‰å°äºç­‰äºaçš„å€¼å‡ºç°æ¦‚ç‡çš„å’Œ</p>
<h2 id="æ€§è´¨-1"><a href="#æ€§è´¨-1" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h2><ul>
<li>æœ‰ç•Œæ€§<br><img src="https://img-blog.csdnimg.cn/20200709191806520.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>å•è°ƒæ€§<br><img src="https://img-blog.csdnimg.cn/20200709192007587.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></li>
<li>å³è¿ç»­æ€§<br><img src="https://img-blog.csdnimg.cn/20200709192244162.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><h2 id="ä¸¤ç§åº”ç”¨"><a href="#ä¸¤ç§åº”ç”¨" class="headerlink" title="ä¸¤ç§åº”ç”¨"></a>ä¸¤ç§åº”ç”¨</h2>ä¸€ç§æ˜¯å¯¹å°äºå‚è€ƒå€¼çš„ç°è±¡å€¼çš„å‡ºç°é¢‘ç‡çš„åˆ†æçš„ç´¯ç§¯é¢‘ç‡åˆ†æ<br>å¦ä¸€ç§æ˜¯å¯¹ç´¯è®¡åˆ†å¸ƒå‡½æ•°è¿›è¡Œä¼°è®¡ï¼Œéšåå¯ä»¥æ±‚çš„ç®€å•çš„ç»Ÿè®¡å€¼æˆ–è¿›è¡Œå„ç§ç»Ÿè®¡å‡è®¾æ£€éªŒã€‚</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        
<div class="counter-tag counter">
    <span id="/2020/07/12/PDF & CDF/" class="leancloud_visitors post-title-link" style="font-size: 12px" data-flag-title="PDF &amp; CDF">
         &nbsp;
        view
    </span>
</div>

      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2021 Gorge
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>